diff --git a/src/tabs/instructions/DocumentsV3.tsx b/src/tabs/instructions/DocumentsV3.tsx
index e9be1d487ddb44bb893ea2626dfe330069d43fd2..d888076809c127f9f603ad6687a7bc6c8500e6da 100644
--- a/src/tabs/instructions/DocumentsV3.tsx
+++ b/src/tabs/instructions/DocumentsV3.tsx
@@ -1,222 +1,222 @@
 import React, { useState, useEffect } from 'react';
 import { Stack, TextField, Toggle, Dropdown, MessageBar, MessageBarType } from '@fluentui/react';
 import { Panel } from '@fluentui/react/lib/Panel';
 import { InstructionData } from '../../app/functionality/types';
 import { useTheme } from '../../app/functionality/ThemeContext';
 import QuickActionsCard from '../home/QuickActionsCard';
 import { colours } from '../../app/styles/colours';
 import { Icon } from '@fluentui/react/lib/Icon';
 import localUserData from '../../localData/localUserData.json';
 
 const DEFAULT_CCL_TEMPLATE = `Dear {{insert_clients_name}}
 
 {{insert_heading_eg_matter_description}}
 
 Thank you for your instructions to act on your behalf in connection with {{matter}}. This Engagement Letter and the attached Terms of Business explain the basis on which we will be acting for you—together they form the contract between us.
 
 Please contact me if you have any difficulty understanding this Engagement Letter or other information we may provide, eg if anything in this letter is unclear or you require information to be provided in larger text, another format or a different language.
 
-Contact details and supervision
+1 Contact details and supervision
 
 The person dealing with your matter is {{name_of_person_handling_matter}}, who is a {{status}}. Their contact details are:
 
 Telephone number: {{fee_earner_phone}}
 Email address: {{fee_earner_email}}
 Postal address: {{fee_earner_postal_address}}
 
 The best way to contact {{name_of_handler}} is {{email}}.
 
 If {{handler}} is not available, the following members of staff may be able to deal with any queries you have:
 
 {{names_and_contact_details_of_other_members_of_staff_who_can_help_with_queries}}
 
 The person with overall responsibility for supervising your matter is {{name}}, who is a Partner.
 
-Scope of services
+2 Scope of services
 
 {{insert_current_position_and_scope_of_retainer}} ("Initial Scope")
 
 We will provide legal advice and services to you with reasonable care and skill. However, the nature of many types of legal work means that it is not possible to guarantee a particular outcome.
 
 Our Terms of Business sets out general limitations on the scope of our services. Your matter may involve issues for which you need tax advice. We cannot and do not give advice on taxation and you should seek the advice of a suitably qualified tax expert. Where your case needs expert evidence then you will need to identify, with us, a suitably qualified expert to give an opinion. Any expert fees will be your responsibility.
 
-Next steps
+3 Next steps
 
 The next steps in your matter are {{next_steps}}.
 
 We expect this will take {{realistic_timescale}}. This is an estimate only. We will tell you if it is necessary to revise this timescale.
 
-Legal costs
+4 Legal costs
 
 There are three main elements to the legal costs of any matter:
 
 —our charges (see section 4.1 below);
 
 —expenses we must pay on your behalf—sometimes called disbursements (see section 4.2 below);
 
 —costs that you may have to pay another party (see section 4.3 below).
 
-Our charges
+4.1 Our charges
 
 Our fees are calculated on the basis of an hourly rate. My rate is £395 per hour. Other Partners/senior solicitors are charged at £395, Associate solicitors at £325, Solicitors at £285 and trainees and paralegals are charged at £195. All hourly rates will be subject to the addition of VAT.
 
 Short incoming and outgoing letters, messages, emails and routine phone calls are charged at 1/10 of an hour. All other work is timed in six minute units and charged at the relevant hourly rate. Please note that lots of small emails or telephone calls may unnecessarily increase the costs to you.
 
 I estimate the cost of the Initial Scope with be £xxx plus VAT.
 
 or
 
 {{we_cannot_give_an_estimate_of_our_overall_charges_in_this_matter_because_reason_why_estimate_is_not_possible}}. The next stage in your matter is {{next_stage}} and we estimate that our charges up to the completion of that stage will be in the region of £{{figure_or_range}}.
 
 We reserve the right to increase the hourly rates if the work done is particularly complex or urgent, or the nature of your instructions require us to work outside normal office hours. If this happens, we will notify you in advance and agree an appropriate rate.
 
 We will review our hourly rates on a periodic basis. This is usually done annually each January. We will give you advance notice of any change to our hourly rates.
 
-Disbursements (expenses)
+4.2 Disbursements (expenses)
 
 Disbursements are expenses we must pay on your behalf.
 
 Based on the information you have provided, we expect to incur the following disbursements:
 
 Description | Amount | VAT chargeable
 [Describe disbursement] | £[Insert estimated amount] | [Yes OR No]
 [Describe disbursement] | £[Insert estimated amount] | [Yes OR No]
 
 OR
 
 We cannot give an exact figure for your disbursements, but this is likely to be in the region of £{{estimate}} {{in_total_including_vat_or_for_the_next_steps_in_your_matter}} including {{give_examples_of_what_your_estimate_includes_eg_accountants_report_and_court_fees}}.
 
-Costs you may have to pay another party
+4.3 Costs you may have to pay another party
 
 We do not expect that you will have to pay another party's costs. This only tends to arise in litigation and is therefore not relevant to your matter.
 
 OR
 
 There is a risk that you may have to pay {{identify_the_other_party_eg_your_opponents}} costs in this matter. This is explained in section 5, Funding and billing below.
 
-Funding and billing
+5 Funding and billing
 
 You are responsible for the legal costs set out in this Engagement Letter.
 
 Unless agreed otherwise, our interim bills are detailed bills and are final in respect of the period to which they relate, save that disbursements may be billed separately and later than the interim bill for our charges in respect of the same period. We will send you a final bill at the end of your matter which will cover our charges from the date of the last interim bill and any unbilled disbursements. You have the right to challenge any interim bill or the final bill by applying to the court to assess the bill under the Solicitors Act 1974. The usual time limit for applying to the court for an assessment is one month from the date of delivery of the interim or final bill. Please be aware that the time limit runs from the date of each individual bill.
 
 Invoices are due forthwith with interest payable from 14 days after the date of the invoice.
 
-Payment on account of costs
+6 Payment on account of costs
 
 Please provide us with £{{figure}} on account of costs. Our account is:
 
 Helix Law General Client Account, Barclays Bank, Eastbourne, 20-27-91 93472434
 
 Please use the reference << Matter.Number >>
 
 We work with money on account at all times, unless otherwise agreed in writing. This means that you should pay any invoice in full immediately, even if we hold money on account. If you fail pay an invoice when due, fail to maintain a reasonable sum on account of costs and/or disbursements we may, at our discretion, suspend work. We may terminate the retainer if the invoice is more than 14 days overdue. We may also terminate the retainer if you refuse, neglect or are unable to pay a reasonable sum on account of costs and/or disbursements within a reasonable time of it being requested. For urgent matters or necessary steps that require immediate action that reasonable time may be measured in hours.
 
-Costs updates
+7 Costs updates
 
 We have agreed to provide you with an update on the amount of costs when appropriate as the matter progresses{{and_or_intervals_eg_every_three_months}}.
 
-Risk analysis
+8 Risk analysis
 
 We have discussed whether the potential outcome of your matter justifies the expense and risk involved. Our preliminary assessment is that it does.
 
-Limitation
+9 Limitation
 
 Each cause of action has a strict time limit after which you cannot bring a claim. Contract claims could be 6 years from the date the sums claimed/damages fell due/accrued.
 
 If there is some fact that I have not been given or you disagree with my view on the limitation period then please let me know at once.
 
-Data protection
+10 Data protection
 
 We take your privacy very seriously. Our Privacy policy contains important information on how and why we collect, process and store your personal data. It also explains your rights in relation to your personal data. The Privacy policy is available on our website at Helix Law Privacy Policy, but please contact us if you would like us to send a copy to you or if you would prefer us to explain our Privacy policy verbally.
 
 We use outside counsel, experts, software providers and an external file auditors so your confidential information will be shared with them. Each will be bound to confidentiality by the particular contract with us and/or their professional obligations to you and to us.
 
-Marketing
+11 Marketing
 
 We may use your personal data to send you updates (by email, text, telephone or post) about legal developments that might be of interest to you and/or information about our services, including exclusive offers, promotions or new services. You have the right to opt out of receiving promotional communications at any time, by:
 
 —contacting us at {{contact_details_for_marketing_opt_out}};
 
 —using the 'unsubscribe' link in emails or 'STOP' number in texts;
 
 —updating your marketing preferences on our {{link_to_preference_centre}}.
 
-Prevention of money laundering, terrorist financing and proliferation financing
+12 Prevention of money laundering, terrorist financing and proliferation financing
 
 We are required by law to obtain satisfactory evidence of the identity of our clients and also sometimes people related to them. This includes where monies are received from third parties on your behalf. This is because solicitors deal with money and property on behalf of clients and criminals can at times therefore attempt to use our services and accounts in an attempt to launder money. We therefore need to obtain and retain evidence of your identity. Most Solicitor firms request that their clients provide evidence of their identity themselves. However, we recognise that this can be time consuming and we therefore obtain confirmation of your identity using a search service, at our cost. Please note that if you do not wish us to verify your identity electronically you must bring this to our immediate attention. The electronic search process does leave an electronic 'footprint' each time a search is conducted. Footprints detail the date, time and reason for a search and certain types of search footprints are used in credit scoring systems and may have a detrimental impact on a consumer's ability to obtain credit.
 
 Unfortunately if the report is unsuccessful i.e. if you have only recently moved address, we may need to ask you to send in certain documents for our records, such as a recent utility bill confirming your address, and photographic identity documents such as a passport or driving licence. If this is necessary the identity documents should be provided by you, as our client or, where our client is a limited company, by a Director of the company. If you wish to provide us with authority to discuss your matter with any third party we must have your authority confirmed in writing. Please contact me if you have any queries regarding this.
 
-Duties to the court
+13 Duties to the court
 
 Your matter {{may_will}} involve court proceedings. All solicitors have a professional duty to uphold the rule of law and the proper administration of justice. We must comply with our duties to the court, even where this conflicts with our obligations to you. This means that we must not:
 
 • attempt to deceive or knowingly or recklessly mislead the court
 
 • be complicit in another person deceiving or misleading the court
 
 • place ourselves in contempt of court
 
 • make or offer payments to witnesses who depend on their evidence or the outcome of the case
 
 We must also comply with court orders that put obligations on us and ensure that evidence relating to sensitive issues is not misused.
 
 The court gives orders and there are strict times for complying with those orders. If the orders aren't followed in time then it may result in your case being struck out and an order for costs being made against you. It is your responsibility to reply quickly to any request for information, documents and instructions we may make of you. If you leave it to the last minute we cannot guarantee that you will be able to complete our work in time as we may have other matters and court proceedings that prevent us meeting your deadline.
 
 In all litigation and disputes all parties have a duty to preserve evidence that is relevant to the dispute, including physical and electronic records and documents which either help your case and also includes those which are against you. This duty is important not least as if documents are deleted or destroyed that are relevant to the dispute our advice to you may be compromised. Further if documents are destroyed the court will be entitled to assume the absolute worst in terms of their content. This is likely to be extremely unhelpful to your case. Please contact me if you have any queries regarding this.
 
-Complaints
+14 Complaints
 
 We want to give you the best possible service. However, if at any point you become unhappy or concerned about the service we have provided you should inform us immediately so we can do our best to resolve the problem.
 
 In the first instance it may be helpful to contact the person who is working on your case to discuss your concerns and we will do our best to resolve any issues. If you would like to make a formal complaint, you can read our full complaints procedure here. Making a complaint will not affect how we handle your matter.
 
 You may have a right to complain to the Legal Ombudsman. The time frame for doing so and full details of how to contact the Legal Ombudsman are in our Terms of Business.
 
-Limit on liability
+15 Limit on liability
 
 Our maximum liability to you (or any other party we have agreed may rely on our services) in relation to any single matter or any group of connected matters which may be aggregated by our insurers will be £3,000,000, including interest and costs. This limit overrides any limit stated in our Terms of Business.
 
 If you wish to discuss a variation of this limit, please contact the person dealing with your matter. Agreeing a higher limit on our liability may result in us seeking an increase in our charges for handling your matter.
 
 Please see our Terms of Business for an explanation of other limits on our liability to you.
 
-Referral and fee sharing arrangement
+16 Referral and fee sharing arrangement
 
 {{explain_the_nature_of_your_arrangement_with_any_introducer_for_link_to_sample_wording_see_drafting_note_referral_and_fee_sharing_arrangement}}
 
-Right to cancel
+17 Right to cancel
 
 You have the right to cancel this contract within 14 days without giving any reason. We will not start work during the cancellation period unless you expressly ask us to. The 'Instructions for Cancellation' notice at {{instructions_link}} explains:
 
 —how to cancel and the effect of cancellation;
 
 —what you will be liable for if you ask us to start work during the cancellation period.
 
-Action points
+18 Action points
 
 The action list below explains what you need to do next.
 
 Action required by you | Additional information
 ☐ Sign and return one copy of the Terms of Business below | If you don't sign but continue to give us instructions you will be deemed to have accepted the terms in this letter and the Terms of Business
 ☐ [Insert next step you would like client to take] | [State why this step is important]
 ☐ Provide a payment on account of costs and disbursements of £[state amount] | If we do not receive a payment on account of costs and disbursements, there may be a delay in starting work on your behalf
 ☐ If you would like us to start work during the 14-day cancellation period, sign and return the attached 'Request to start work during the cancellation period' form | This form is attached to this Engagement Letter
 ☐ Alternatively, if wish to cancel your contract with us, tell us within 14 days | You can simply inform us of your decision to cancel by letter, telephone or e-mail
 ☐ Provide the following documents [and information] to allow me to take the next steps in your matter: | Without these documents there may be a delay in your matter.
 
 [describe first document or information you need from your client]
 [describe second document or information you need from your client]
 [describe third document or information you need from your client]
 
 Please contact me if you have any queries or concerns about your matter, this Engagement Letter or the attached Terms of Business. 
 
 {{insert_current_position_and_scope_of_retainer}} ("Initial Scope") 
 
 We will provide legal advice and services to you with reasonable care and skill. However, the nature of many types of legal work means that it is not possible to guarantee a particular outcome. 
 
 Our Terms of Business sets out general limitations on the scope of our services. Your matter may involve issues for which you need tax advice. We cannot and do not give advice on taxation and you should seek the advice of a suitably qualified tax expert. Where your case needs expert evidence then you will need to identify, with us, a suitably qualified expert to give an opinion. Any expert fees will be your responsibility. 
 
 Next steps 
 
diff --git a/src/tabs/instructions/DocumentsV3.tsx b/src/tabs/instructions/DocumentsV3.tsx
index e9be1d487ddb44bb893ea2626dfe330069d43fd2..d888076809c127f9f603ad6687a7bc6c8500e6da 100644
--- a/src/tabs/instructions/DocumentsV3.tsx
+++ b/src/tabs/instructions/DocumentsV3.tsx
@@ -581,65 +581,62 @@ const DocumentsV3: React.FC<DocumentsV3Props> = ({
     
     // Function to render content with highlighted template variables
     // Helper function to measure text width
     const measureTextWidth = (text: string, fontSize: number = 14, fontFamily: string = 'Raleway, sans-serif'): number => {
         const canvas = document.createElement('canvas');
         const context = canvas.getContext('2d');
         if (context) {
             context.font = `${fontSize}px ${fontFamily}`;
             return context.measureText(text).width;
         }
         return text.length * 8; // Fallback
     };
 
     const renderTemplateContentWithHighlights = (content: string) => {
         if (!content) return 'No content to preview...';
         
         // Find all template variables in the content
         const templateVariableRegex = /\{\{([^}]+)\}\}/g;
         const parts = [];
         let lastIndex = 0;
         let match: RegExpExecArray | null;
         
         while ((match = templateVariableRegex.exec(content)) !== null) {
             // Add editable text before the variable
             if (match.index > lastIndex) {
-                const textSegment = content.substring(lastIndex, match.index);
+                const segmentStart = lastIndex;
+                const segmentEnd = match.index;
+                const textSegment = content.substring(segmentStart, segmentEnd);
                 parts.push(
                     <span
-                        key={`text-${lastIndex}`}
+                        key={`text-${segmentStart}`}
                         contentEditable
                         suppressContentEditableWarning={true}
                         onBlur={(e) => {
                             const newText = e.target.textContent || '';
-                            const beforeText = content.substring(0, lastIndex);
-                            // Find the next placeholder after this text segment
-                            const remainingContent = content.substring(lastIndex);
-                            const nextPlaceholderMatch = /\{\{([^}]+)\}\}/.exec(remainingContent);
-                            const nextPlaceholderIndex = nextPlaceholderMatch ? lastIndex + nextPlaceholderMatch.index : content.length;
-                            
-                            const afterText = content.substring(nextPlaceholderIndex);
+                            const beforeText = content.substring(0, segmentStart);
+                            const afterText = content.substring(segmentEnd);
                             const newContent = beforeText + newText + afterText;
                             setDocumentContent(newContent);
                         }}
                         style={{
                             outline: 'none',
                             minHeight: '1em',
                             display: 'inline',
                             whiteSpace: 'pre-wrap',
                             cursor: 'text',
                             padding: '2px',
                             borderRadius: '2px',
                             transition: 'background-color 0.2s ease'
                         }}
                         onMouseEnter={(e) => {
                             (e.target as HTMLElement).style.backgroundColor = '#f0f0f0';
                         }}
                         onMouseLeave={(e) => {
                             (e.target as HTMLElement).style.backgroundColor = 'transparent';
                         }}
                         onFocus={(e) => {
                             (e.target as HTMLElement).style.backgroundColor = '#e8f4f8';
                         }}
                     >
                         {textSegment}
                     </span>
diff --git a/src/tabs/instructions/DocumentsV3.tsx b/src/tabs/instructions/DocumentsV3.tsx
index e9be1d487ddb44bb893ea2626dfe330069d43fd2..d888076809c127f9f603ad6687a7bc6c8500e6da 100644
--- a/src/tabs/instructions/DocumentsV3.tsx
+++ b/src/tabs/instructions/DocumentsV3.tsx
@@ -743,60 +740,63 @@ const DocumentsV3: React.FC<DocumentsV3Props> = ({
                         }}
                         onBlur={(e) => {
                             e.target.style.backgroundColor = '#fff3cd';
                             e.target.style.borderStyle = 'dashed';
                             e.target.style.transform = 'scale(1)';
                             e.target.style.fontStyle = 'italic';
                         }}
                         onInput={(e) => {
                             // Dynamic width adjustment as user types
                             const target = e.target as HTMLInputElement;
                             const textWidth = target.value.length > 0 
                                 ? measureTextWidth(target.value, 14)
                                 : measureTextWidth(placeholderText, 14);
                             const newWidth = Math.max(textWidth + 20, 80);
                             target.style.width = newWidth + 'px';
                         }}
                     />
                 );
             }
             
             lastIndex = match.index + match[0].length;
         }
         
         // Add any remaining editable text
         if (lastIndex < content.length) {
-            const textSegment = content.substring(lastIndex);
+            const segmentStart = lastIndex;
+            const segmentEnd = content.length;
+            const textSegment = content.substring(segmentStart);
             parts.push(
                 <span
-                    key={`text-${lastIndex}`}
+                    key={`text-${segmentStart}`}
                     contentEditable
                     suppressContentEditableWarning={true}
                     onBlur={(e) => {
                         const newText = e.target.textContent || '';
-                        const beforeText = content.substring(0, lastIndex);
-                        const newContent = beforeText + newText;
+                        const beforeText = content.substring(0, segmentStart);
+                        const afterText = content.substring(segmentEnd);
+                        const newContent = beforeText + newText + afterText;
                         setDocumentContent(newContent);
                     }}
                     style={{
                         outline: 'none',
                         minHeight: '1em',
                         display: 'inline',
                         whiteSpace: 'pre-wrap',
                         cursor: 'text',
                         padding: '2px',
                         borderRadius: '2px',
                         transition: 'background-color 0.2s ease'
                     }}
                     onMouseEnter={(e) => {
                         (e.target as HTMLElement).style.backgroundColor = '#f0f0f0';
                     }}
                     onMouseLeave={(e) => {
                         (e.target as HTMLElement).style.backgroundColor = 'transparent';
                     }}
                     onFocus={(e) => {
                         (e.target as HTMLElement).style.backgroundColor = '#e8f4f8';
                     }}
                 >
                     {textSegment}
                 </span>
             );
