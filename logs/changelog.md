2026-02-18 / Redesign AwayInsight v3 — branded visual with avatars / Complete rewrite of AwayInsight component from basic text strip to branded card-based layout. Person chips with initials badges (28×28, borderRadius:2, tinted bg + branded border), first names, return dates ("Back Mon", "Back Thu 3 Jul"), and FaUmbrellaBeach leave icons. Section hierarchy with coloured accent bars (CTA red for away today, accent/highlight for later this week, subtleGrey for next week). Each person appears only in their most urgent bucket (dedup across sections). Clickable chips open Request Annual Leave panel via new onManageLeave prop. "Manage Leave →" header link wired to handleActionClick. Loading skeleton matches chip dimensions. Hover effects with lift + shadow transitions. Tooltips with full leave details. (~ src/tabs/home/AwayInsight.tsx, ~ src/tabs/home/Home.tsx)
2026-02-18 / Add CFA checkout mode across pipeline / Implemented proper CFA (Conditional Fee Agreement) support as a first-class checkout mode. Backend: added CFA to CHECKOUT_MODES in instructionDb.js, deriveCheckoutMode now recognises CFA status, server.js handles cfa-complete stage with deal close and email notifications. Frontend: HomePage.tsx and StripeContext.tsx recognise CFA mode — skips Stripe, hides payment step, sends cfa-complete on identity completion. PitchBuilder: CFA scenario now auto-sets Amount=0, bypasses positive-amount validation, sends checkoutMode='CFA' to deal capture API. dealCapture.js accepts checkoutMode param and writes Status='CFA' on deals. Updated Bizcap deal 1170 to CFA status. (~ submodules/instruct-pitch/apps/pitch/backend/instructionDb.js, ~ submodules/instruct-pitch/apps/pitch/backend/server.js, ~ submodules/instruct-pitch/apps/pitch/client/src/structure/HomePage.tsx, ~ submodules/instruct-pitch/apps/pitch/client/src/context/StripeContext.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx, ~ server/routes/dealCapture.js)
2026-02-18 / Replace attendance with away/leave insight / Swapped full EnhancedAttendance section on Home for a lightweight AwayInsight component showing who's away today, later this week, and next week. Uses existing annualLeaveRecords + futureLeaveRecords (approved/booked only). Compact avatar rows with initials, first name, and date range. Grouped by "Away today" / "Later this week" / "Next week" with section labels and counts. Empty state shows "No one away" message. Full attendance tracking remains available via Quick Actions but no longer occupies the homepage. (+ src/tabs/home/AwayInsight.tsx, ~ src/tabs/home/Home.tsx)
2026-02-18 / Sequence greeting → icon animation in QuickActionsBar / Greeting and utility icons now occupy the same right-side zone and are mutually exclusive: time-of-day greeting ("Good morning/afternoon/evening, Name") slides in on mount, fades out after 4s, then pipe separator + notes/theme icons drop in with staggered spring animation. Greeting styled on-brand (Raleway 500, accent/highlight colour, 12px). Restored vertical pipe separator between chip area and control icons. Removed old absolute-positioned greeting that overlapped icons. Forced previous-period always-on (removed toggle state entirely, `const showPreviousPeriod = true`). Compact icon-only notes + theme buttons (28x28, no labels). (~ src/tabs/home/QuickActionsBar.tsx, ~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-18 / Add Pipeline Migration tool to UserBubble / Built LegacyMigrationTool v1 modal with multi-phase flow: search client → discover across all systems (Clio, Core Data, Instructions DB) → review findings → intake missing fields → confirm → execute. Reworked Admin and Local sections in UserBubble to be always visible in production (collapsed by default) with disabled visual treatment (opacity 0.35, grayscale, pointer-events none) for non-eligible users — power flex showing locked capabilities. Added chevron expand/collapse with smooth max-height transition. Pipeline Migration tool appears as last item in Local section. (+ src/components/LegacyMigrationTool.tsx, ~ src/components/UserBubble.tsx)
2026-02-18 / Migrate Bizcap Limited into new pipeline / Legacy migration of Bizcap Ltd (3 debt recovery matters opened directly in Clio by AC) into full Instructions DB pipeline. Created enquiry, deal, instruction, 3 matters, and IdVerification records. Pipeline verified with zero warnings. Documented process in LEGACY_MIGRATION_TOOL.md for replication. (+ docs/LEGACY_MIGRATION_TOOL.md, + scripts/temp-migrate-bizcap.mjs)
2026-02-18 / Show previous period by default / Changed previous-period comparison from hold-to-peek to always-visible toggle (defaults on). Converted button from mousedown/mouseup hold interaction to simple click toggle. Removed window-level mouseup/touchend/blur auto-release. Both Time and Conversion tiles now show trend deltas on load. (~ src/components/modern/TimeMetricsV2.tsx)
2026-02-18 / Distinguish metric tiles from section panels / Applied UserBubble-inspired gradient wash, whisper border, inset highlight + drop shadow, and hover lift (translateY -1px) to all metric tiles in both Time and Conversion grids. Replaced flat transparent tiles and border-right dividers with individually styled tiles with 4px gap. Dark mode uses diagonal blue gradient over deeper surface; light mode uses white-based variant. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-18 / Section-first dashboard layout / Consolidated Time and Conversion metrics from split first-row/second-row grids into single unified section grids. Each section now has a compact "Time" or "Conversion" label inside its rail, with all metrics in one `repeat(3, 1fr)` grid (index >= 3 get compact treatment). Removed ~200 lines of duplicated second-row JSX. Removed redundant Conversion divider from TimeMetricsV2 since EnquiryMetricsV2 now carries its own section label. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-18 / Restore progress bar colour contrast / Fixed low-contrast progress fills after compact pass. Time and Conversion progress bars now use stronger brand gradients (highlight→accent in dark mode, highlight→highlightBlue in light mode) with adjusted glow so bars remain clearly visible against dark tracks. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-18 / Compress metrics to Clio-like dashboard density / Tightened Time + Conversion metric layout for faster scan: reduced rail/background weight, reduced block padding, reduced grid gaps (4→3), reduced label/value typography, and slimmed progress bars/skeleton geometry for a denser motherboard dashboard feel. Header and previous-period control also compressed for calmer, less dominant chrome. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-18 / Soften previous-period control tone and reveal motion / Renamed header control copy to "Show previous period" (from hold-style phrasing), reduced visual intensity (sentence case, lighter weight, lower contrast) and removed shouty all-caps feel. Previous-period rows now reveal/hide with smooth opacity + height + translate transition instead of abrupt mount/unmount in both Time and Conversion cards. Also softened metric label typography from uppercase micro-labels to calmer semibold sentence-style labels for a cleaner Helix dashboard tone. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-18 / Add hold-to-peek previous period mode / Added a press-and-hold control in Time Metrics header (`Hold: Previous`) that reveals previous-period figures only while held, keeping default cards clean. Wired this state through to Conversion metrics so previous comparison rows are hidden by default and appear only during hold. Stabilised card labels during hold (no title swapping) and upgraded metric labels to faster dashboard style (uppercase, tighter tracking, stronger weight) for clearer scan hierarchy. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-18 / Restore dashboard hierarchy and loading parity / Reintroduced clear metric hierarchy with section rails and structured metric blocks (title → value → comparison → progress) so Time and Conversion areas are visually resolvable again. Added subtle rail containers and block surfaces with left accent edge in both TimeMetricsV2 and EnquiryMetricsV2 to avoid the undivided "sea" effect while keeping a compact dashboard density. Rebuilt Conversion skeletons to mirror loaded layout (same block hierarchy, spacing, and progress geometry) so loading/loaded states no longer feel like different UIs. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-18 / Strip card chrome for dashboard layout / Dissolved card backgrounds, borders, shadows, and hover lift — metric cells are now transparent on the container surface. Removed icon header row and Details chip from all metric cells (both Time and Conversion, first and second rows). Container background changed from darkBlue to websiteBlue so it matches the page canvas with no visible panel. Hover shows subtle background tint only. Fixed second-row Conversion Details chip not hiding in view-as-prod mode. Removed minHeight:100vh from Home.tsx to eliminate bottom gap. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx, ~ src/tabs/home/Home.tsx)
2026-02-18 / Replace period toggle with inline faded comparison / Removed Current/Previous toggle from metrics dashboard — previous period values now show as faded secondary text (60% opacity) below each metric's main value, with trend arrow and % change. Applied consistently across both TimeMetricsV2 and EnquiryMetricsV2, both first-row and second-row cards. Removed PeriodToggle JSX, simplified getDisplayTitle, hardcoded showPreviousPeriod=false. Tightened card density toward dashboard/CRM feel: card padding 12→10px, first-row values 22→18px, second-row values 20→16px, title font 12→11px, icon sizes 13→11/14→12, header margins 6→4px, content padding 8/12→6/10, progress bars 8→6px height. Removed bottom separator div from Home.tsx that caused unnecessary page scroll. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx, ~ src/tabs/home/Home.tsx)
2025-07-20 / Unify metrics into single motherboard dashboard / Merged Time Metrics and Conversion Metrics into one unified container. Removed toggle between views — both metric sets always visible. Added `embedded` prop to EnquiryMetricsV2 so it renders card grids only (no container/header) when inside TimeMetricsV2. Flattened entire visual language: containers use flat darkBlue (no gradient, no shadow), cards use flat websiteBlue (no gradient, no shadow), icon plates transparent, header backgrounds transparent. Grid gaps tightened to 4px for tetris fit. Added "Conversion" section divider between time and enquiry cards. Removed pointless wrapper div in Home.tsx. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx, ~ src/tabs/home/Home.tsx)
2026-02-18 / Darken Time Metrics to websiteBlue base / Container background switched from darkBlue to websiteBlue so the section flows seamlessly from the page canvas. Metric cards now use a subtle gradient from darkBlue→transparent (flat, not layered) with brand-tinted shadows (0,3,25). Borders lowered to rgba(54,144,206,0.06) whisper level. Hover uses translateY(-1px) with deepened shadow instead of -2px. Icon plates at helixBlue 35% for visibility on deeper base. Progress bar track uses helixBlue 30%. Accent top-line softened to 0.06/0.08 opacity. All dark-mode card/container shadows now use rgba(0,3,25,...) consistently. (~ src/components/modern/TimeMetricsV2.tsx)
2026-02-18 / Apply UserBubble calm to Home page stack / Re-darkened surfaces from grey (dark.border+hex) to navy-derived rgba (darkBlue/helixBlue/websiteBlue). Borders now use UserBubble whisper pattern rgba(54,144,206,0.08). Accent lines switched to subtle highlight gradient. Shadows use brand-tinted rgba(0,3,25,...). Eliminated all teal/accent from dark-mode Attendance — replaced colours.accent with colours.highlight in PersonalAttendanceConfirm submit, today border, hover states; replaced sky-blue rgba(125,211,252) with whisper-highlight across WeeklyAttendanceView, EnhancedAttendanceNew, AttendanceCompact; replaced Tailwind grey (#1F2937, rgba(31,41,55)) with brand sectionBackground/darkBlue. Toggle buttons use highlight-blue instead of teal gradient. (~ src/tabs/home/SectionCard.tsx, ~ src/components/modern/TimeMetricsV2.tsx, ~ src/tabs/home/WeeklyAttendanceView.tsx, ~ src/tabs/home/PersonalAttendanceConfirm.tsx, ~ src/tabs/home/EnhancedAttendanceNew.tsx, ~ src/tabs/home/AttendanceCompact.tsx)
2026-02-17 / Strengthen Home page visual presence / Replaced glass/blur with solid brand surfaces across SectionCard, ImmediateActionChip, and Home canvas. SectionCard now uses dark.sectionBackground with a Helix accent gradient top-line and stronger shadows. ImmediateActionChips use dark.cardBackground/cardHover with removed blur for clearer presence on websiteBlue navigator. Home canvas switched to brand token dark.background with deeper radial gradients and stronger watermark. Fixed all off-brand Tailwind colours in ImmediateActionsBar sub-components (EmptyState, Spinner, SuccessCheck, CollapseChevron) to brand tokens: colours.green, colours.highlight, colours.accent, colours.subtleGrey, colours.greyText. Urgent chip colours fixed to CTA (#D65541) instead of Tailwind red. (~ src/tabs/home/Home.tsx, ~ src/tabs/home/SectionCard.tsx, ~ src/tabs/home/ImmediateActionChip.tsx, ~ src/tabs/home/ImmediateActionsBar.tsx)
2026-02-17 / Soften banner separators and remove double-border tension / Standardised top-stack bars to a single subtle bottom rule only: removed top borders from Quick Actions and FilterBanner, removed CustomTabs shadow, and aligned dark-mode separator tone to `dark.border66` for a lighter, consistent rhythm between banner layers. (~ src/app/styles/CustomTabs.tsx, ~ src/tabs/home/QuickActionsBar.tsx, ~ src/components/filter/FilterBanner.tsx)
2026-02-17 / Force darkBlue filter bars on Prospects Clients Matters / Removed `seamless` mode from list-view FilterBanner call sites in Enquiries (Prospects), Instructions (Clients), and Matters so bars render their own darkBlue surface instead of transparent websiteBlue bleed-through. Keeps clean separator line and UserBubble hierarchy consistency. (~ src/tabs/enquiries/Enquiries.tsx, ~ src/tabs/instructions/Instructions.tsx, ~ src/tabs/matters/Matters.tsx)
2026-02-17 / Simplify UserBubble palette naming for users / Updated Helix Palette swatches in UserBubble to user-facing names (Dark Blue, Blue, Light Blue, Highlight Blue, Accent, Red) and added Helix Grey. Removed highlightBlue token swatch (#d6e8ff) from the main displayed palette to reduce confusion; copy-to-clipboard behaviour remains unchanged. (~ src/components/UserBubble.tsx)
2026-02-17 / Align navigator and Quick Actions to UserBubble hierarchy / Removed glass overlay from navigator wrapper and set dark mode base to websiteBlue for clean handoff from tabs. Updated QuickActionsBar to flat darkBlue section surface with dark.border separators (top, bottom, right-cluster divider), removed blur treatment, and removed navigator stack gaps so bars flow continuously with a single clean line separation. (~ src/components/Navigator.tsx, ~ src/app/styles/Navigator.css, ~ src/tabs/home/QuickActionsBar.tsx)
2026-02-18 / Fix demo CCL generation failing silently / Demo CCL used matterId '3311402' but the matters endpoint only shortcutted 'DEMO-3311402' — real Clio API was called and failed. Expanded demo guard to also catch raw '3311402'. Added top-level ok/displayNumber fields to match what mergeMatterFields expects. Hardcoded instructionRef to 'HELIX01-01' so ccl-ai/fill can find the seeded instruction record. (~ server/routes/matters.js, ~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx)
2026-02-18 / Restyle FilterBanner with Helix design system / Background: colours.darkBlue (matching UserBubble bgSecondary). Separator: borderTop uses colours.dark.border for clean line from websiteBlue tabs. Removed gradient bg, backdropFilter blur, sky-blue border, heavy box-shadow. Replaced off-brand hex with brand tokens. borderRadius 0 on all buttons. (~ src/components/filter/FilterBanner.tsx)
2026-02-18 / Fix CCL_date lost on VNet merge / VNet (Instructions DB) matters overwrote legacy (Core Data DB) matters without preserving fields the VNet source lacked — CCL_date was silently dropped. mergeMattersFromSources now shallow-merges, keeping legacy field values where VNet is falsy. Fixes "Prepare Client Care Letter" showing on matters that already have a CCL date. (~ src/utils/matterNormalization.ts)
2026-02-17 / Rewrite CustomTabs with Helix design system / Full rework — removed Fluent Pivot/PivotItem/IPivotStyles, replaced with native tab buttons using inline brand tokens. Stripped gradient background (raw rgba) for flat darkBlue/white. Removed off-brand colours (#7dd3fc, #f8fafc). Active tabs use accent (dark) / blue (light) with 2px underline. CSS reduced from 356→120 lines — removed all .ms-Pivot-link overrides and !important spam. Kept responsive icon-only collapse, home icon fill swap, notification dot, enquiry sub-tabs. (~ src/app/styles/CustomTabs.tsx, ~ src/app/styles/CustomTabs.css, ~ src/app/App.tsx)
2026-02-17 / Gate Dev Dashboard to local dev only / Added isLocalDev guard to both the Dev Dashboard button and modal render so it never appears in production — button and component only mount when running locally. (~ src/components/UserBubble.tsx)
2026-02-17 / Rewrite AdminDashboard with Helix design system / Full rewrite — replaced Fluent UI Nav sidebar, mergeStyles, Icon, Text, IconButton, Stack, Separator with inline React.CSSProperties and horizontal tab strip. Swapped off-brand colours (#ef4444, #4ade80, #fbbf24, #15803d, #b45309) for brand tokens (colours.cta, colours.green, colours.orange). borderRadius: 0 everywhere. websiteBlue header strip. All 7 sections preserved (overview, inspector, ops, files, dataflow, health, diagnostics). 1678 → ~480 lines. (~ src/components/AdminDashboard.tsx)
2026-02-17 / Establish UserBubble as canonical design reference / Rewrote COMPONENT_STYLE_GUIDE.md with AoW visual system (canonical colours, icons, getAreaColor pattern), accent/highlight usage guide, readiness dot pattern, and known brand violations table (15 files catalogued). Updated copilot-instructions.md to define \"Helix look and feel\" as UserBubble-driven standard with AoW colour table and expanded design rules (accent pairing, highlightBlue surfaces, modal rules, off-brand hex blacklist). Added accent/highlight cues to UserBubble: section title accent colouring, AoW colour dots in session filters with left-border indicator, accent-tinted rate stat in dark mode. (~ src/components/UserBubble.tsx, ~ docs/COMPONENT_STYLE_GUIDE.md, ~ .github/copilot-instructions.md)
2026-02-17 / Expand UserBubble command centre with navigation and awareness / Added environment ribbon (colour-coded env badge, hostname, session elapsed timer), active state warnings (amber strip when demo mode, production view, or user-switch active), and Quick Navigate grid (4 cards jumping to Enquiries, Instructions, Matters, Reporting via CustomEvent dispatch). All new sections follow house-style patterns (rowBaseBackground gradients, applyRowHover/resetRowHover, toast feedback). Updated COMPONENT_STYLE_GUIDE.md with Command Centre Anatomy section documenting layout order. (~ src/components/UserBubble.tsx, ~ docs/COMPONENT_STYLE_GUIDE.md)
2026-02-17 / Strengthen Data Hub header hierarchy and remove duplicate lane control / Removed `Choose lane` button so lane switching is handled only by the segmented Collected/WIP toggle. Updated page header so `Data Hub` and active lane are visually distinct (lane pill as header extension), and increased Refresh/Exit action prominence with stronger contrast and weight. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Remove coverage filters and enforce complete lane ledger / Removed status/source filter controls from Coverage and switched to an always-on lane-scoped ledger model so month windows show complete attributed events without filter inversion confusion. Fallback month sync entries remain when no attributed ops-log row exists, and expanded windows now render all available events (no truncation), preserving a “nothing missing” audit trail per lane. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Fix status filtering and improve per-window audit readability / Normalised ops log statuses into stable filter buckets (`completed/error/started`) so status chips behave consistently (including `progress` and message-derived states). Replaced current-week exclusion lightning marker with an info icon, and strengthened expanded window readability with explicit audit-event counts, stronger event cards, clearer status labels, and higher-contrast message text. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Make coverage filters effective and promote lane control hierarchy / Fixed status/source filter behaviour by preventing fallback month audit rows when filters are active (so chip selections now materially change visible audit entries). Reworked lane controls to make the Collected/WIP segmented toggle the primary visual anchor, replaced arrow-heavy wording with calmer labels (`Choose lane`, `Open lane`), and tightened filter bar labels for alignment (`Status:`, `Source:`). (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Simplify Data Hub top bar and filter labels for orientation clarity / Removed duplicate top descriptors and condensed the header to one clear location title (`Data Hub · <lane>`). Replaced verbose lane controls and filter prose with compact labels (`Lanes`, `Scheduler on/off`, `Status`, `Source`) so users can immediately understand where they are without scanning stacked text blocks. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Expand coverage into window sections with clear audit stamps and hub navigation / Refactored coverage from compact row list into expandable month windows (recent→oldest) with separated action cluster, clearer SYSTEM vs USER audit stamps, timestamp/details moved into expanded content, and per-window SQL preview action. Added show-more guard for compute/UI load and strengthened month attribution/filter parsing (supports entry start/end dates, broader date-range patterns, and source detection via triggeredBy/invokedBy). Clarified Data Hub navigation with breadcrumb context and explicit exit/back labels. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Amalgamate coverage and ops audit into one lane view / Removed duplicate top audit timeline and merged operation logging directly into each coverage month row, attributing events to month windows (with fallback to month lastSync when range parsing is unavailable). Added Clio-style Coverage Audit header with status/source filters (`all/completed/error/started`, `all/auto/user`) scoped to the active lane so unrelated operations are filtered out. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Reframe Data Centre as early Data Hub lanes / Updated Reporting Data Centre to present as an Early Data Hub with two explicit lanes (Collected and WIP), clearer lane purpose copy, lane-switch controls in drilled view, and stronger lane-first navigation language while preserving coverage + custom sync flow. Also fixed legacy compile break by replacing invalid `colours.dark.cta` references in RiskAssessment.old button styles. (~ src/tabs/Reporting/DataCentre.tsx, ~ src/components/RiskAssessment.old.tsx)
2026-02-17 / Split OperationValidator: activity log top, validation in custom sync / Added `mode` prop to OperationValidator — `timeline` renders a simplified two-column audit trail + live feed (always visible at top), `full` renders the confidence strip, metrics, action buttons, and explain panel (now inside the Custom Sync accordion). Timeline mode skips validation fetch, uses compact dot+status layout, capped at 8 entries. (~ src/tabs/Reporting/components/OperationValidator.tsx, ~ src/tabs/Reporting/DataCentre.tsx, ~ .github/instructions/ARCHITECTURE_DATA_FLOW.md)
2026-02-17 / Add UserBubble house-style interactions and toasts / Introduced a cohesive interaction layer for UserBubble: shared row hover motion (lift + shadow), subtle gradient row surfaces, and app-native toast feedback for key actions (copy, theme toggle, demo mode, production view, release notes, tracker/debug opens, replay, user switch). Modal now renders animated tone-based toasts (info/success/warning) and rows use unified hover/reset helpers for consistent behaviour. (~ src/components/UserBubble.tsx, ~ src/app/styles/UserBubble.css)
2026-02-17 / Wire demo CCL to real endpoints / Demo matter opening success path now calls real CCL AI Fill + Draft CCL Generation endpoints against form data, producing an actual .docx. "Preview CCL" button appears on the success card when the CCL URL is available, linking directly to the generated document. Non-blocking — if server is down, demo still completes with a warning in logs. (~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx)
2026-02-17 / Auto-fire CCL at end of matter opening pipeline / Removed manual CCL pill and tab from Prospects pipeline — CCL now fires invisibly as two final steps in processingActions (AI Fill + Draft generation). Reduced pipeline noise by hiding disabled stages from prospect pills and replaced off-brand Tailwind colours (#22c55e, #ef4444, sky-blue) with brand tokens (colours.green, colours.cta, colours.highlight). (~ src/tabs/instructions/MatterOpening/processingActions.ts, ~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-17 / Bring CCL into Prospects pipeline / Added CCL as a 9th stage pill in the Prospects Overview pipeline and a new tab in InlineWorkbench. CCL editor (CCLEditor.tsx) now launches inline from the workbench via a portalled modal — no more bouncing to the legacy Instructions tab. Stage shows disabled until matter opened, then pending/complete based on CCLSubmitted/CCL_date. Builds NormalizedMatter from raw instruction/matter data with normalizeMatterData fallback shim. (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-17 / Restructure Data Centre hierarchy: integrity → coverage → custom sync / Moved coverage month grid directly below OperationValidator (integrity) as primary compliance view. Demoted custom sync accordion to bottom with subtler styling (borderless, smaller text, fainter colour). Removed Team + 12m toolbar buttons. Fixed two orphan closing div tags from previous refactor. Removed duplicate coverage block. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Align Profile rows with control-box styling / Updated Profile section rows to use `controlRowBg` (darkBlue in dark mode) instead of sectionBg, with helixBlue hover and proper reset on mouse leave. This matches Dark Mode / View as Production / Replay / Todo row behaviour. (~ src/components/UserBubble.tsx)
2026-02-17 / Deepen UserBubble control boxes to darkBlue / Unified control-row resting surfaces to darkBlue (#061733) via shared `controlRowBg`, including Dark Mode, View as Production, Replay Animations, Todo List, and Select User. Updated all row mouse-leave resets to return to darkBlue, preserving helixBlue hover only as interaction state. (~ src/components/UserBubble.tsx)
2026-02-17 / Remove final green-tint surfaces in UserBubble / Replaced remaining dark hover and avatar surfaces that still read as washed green-blue: `bgHover` now uses helixBlue (#0D2F60) instead of dark.cardHover (#0c2440), and avatar tiles now use darkBlue (#061733) instead of dark.cardBackground (#081c30). This affects Release Notes, Demo mode, Select User, Rate Change Tracker, and other toggle rows through shared styles. (~ src/components/UserBubble.tsx)
2026-02-17 / UserBubble structural cleanup and depth alignment / Removed Asana integration section (masked secrets, no user value). Replaced raw Profile Fields dump with curated darkBlue container matching admin/local pattern. Collapsed separate Actions section into inline footer buttons. Removed 12 unused tokens (bgCard, shadowLg, primaryBtn, borderFocus, textSubtle, accentLight, successLight, warningLight, warning, legacy aliases). Fixed all toggle row and action button backgrounds from cardBg (#081c30) to sectionBg (#051525) — eliminating the off-brand greeny-blue. Quick Stats upgraded to darkBlue containers with accent-coloured rate value. Copy buttons now minimal icon-only. (~ src/components/UserBubble.tsx)
2026-02-17 / UserBubble to centered command-center modal / Converted from floating anchor-positioned popover to viewport-centered modal with backdrop blur. Removed drag-to-position, added close button, wider layout (600px max), entrance animation (scale + fade). App-native control-panel feel. (~ src/components/UserBubble.tsx, ~ src/app/styles/UserBubble.css)
2026-02-17 / UserBubble swatch chips + admin/local containers to brand depth / Swatch palette chips evenly spaced (flex: 1), hex codes shown as labels, click-to-copy. Admin and local section containers now darkBlue (#061733) bg matching AoW pattern — replaced rgba-tinted backgrounds with solid brand navy. (~ src/components/UserBubble.tsx)
2026-02-17 / Areas of Work filters to brand navy stack / Container darkBlue (#061733) on websiteBlue canvas for clear lift. Checked area items now helixBlue (#0D2F60) — the proper mid-navy — with blue-tinted borders. Unchecked items transparent, checked items pop with purpose. (~ src/components/UserBubble.tsx)
2026-02-17 / UserBubble dark depth hierarchy from websiteBlue / Remapped dark-mode depth ladder: popover shell now websiteBlue (#000319) as absolute base, header darkBlue (#061733) for clear lift, cards sectionBg/cardBg for visible separation. Replaced Tailwind slate swatch borders (rgba 226,232,240) with brand-derived borderColor tokens. Swatch container uses darkBlue to stand distinct from the websiteBlue canvas. Five clear depth stops instead of three indistinguishable ones. (~ src/components/UserBubble.tsx)
2026-02-17 / Align UserBubble palette to brand strip / Purged all off-brand hex values: Material amber (#FFB74D, #E65100, rgba 255,183,77/255,152,0) → brand orange (colours.orange #FF8C00); Tailwind blue (#1d4ed8) → colours.helixBlue; invented hover blues (#2a7ab8) and CTA hover (#B04535) → CSS brightness(0.85) filter derived from base palette colour; slate-grey swatch bg (rgba 241,245,249) → colours.grey. Every colour in the component now traces back to colours.ts. (~ src/components/UserBubble.tsx)
2026-02-17 / Drive Matter Opening CCL flag from backend completion event / Added server-emitted `cclQueuedAt` timestamp on matter-request patch completion and wired Matter Opening wizard status flag to this backend signal (instead of local inferred completion), making the visual completion state easier and safer to test. (~ server/routes/matterRequests.js, ~ src/tabs/instructions/MatterOpening/processingActions.ts, ~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx)
2026-02-17 / Add IDVerification and Payment schema guards in demo seed / Hardened Part A seeding to handle required `IDVerifications.ClientEmail` and `Payments.id` variants, and wrapped both inserts in TRY/CATCH so output clearly reports real failures instead of false success prints. (~ tools/db/seed-demo-matter.sql)
2026-02-17 / Harden Instructions seed for required Deals and PitchContent fields / Updated Part A demo seed to populate `Deals.AreaOfWork` variants and to include `PitchContent.DealId` when required (resolved dynamically from Deals). Added explicit failure prints so insert messages only indicate success when writes actually complete. (~ tools/db/seed-demo-matter.sql)
2026-02-17 / Fix Core Data demo enquiry datetime seed / Updated Part B of demo seed script to populate required `enquiries.datetime` / `DateTime` values for all legacy enquiry inserts, preventing NULL constraint failures during Core Data seeding. (~ tools/db/seed-demo-matter.sql)
2026-02-17 / Surface backend CCL status in Matter Opening wizard / Added a lightweight Matter Opening banner flag that reflects backend CCL automation state from instruction data (`CCL generated`, `CCL queued`, `CCL pending`) so users can see status without entering the CCL builder. (~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx)
2026-02-17 / Soften ops log and rebrand OperationValidator / Replaced terminal-style monospace live log with clean activity feed (brand-token dots, no pulsing animation, HH:MM timestamps). Swapped all off-brand Tailwind colours (#22c55e, #ef4444, #3b82f6, #f59e0b) with brand tokens (colours.green, colours.cta, colours.blue, colours.orange). Simplified Reconciliation summary entries — removed redundant status text, reduced dot size, toned down label weight. (~ src/tabs/Reporting/components/OperationValidator.tsx, ~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Simplify CCL modes to Preview vs Edit only / Replaced the three-state toolbar behaviour (`Preview` + `Review` + separate `Edit` button) with a single two-mode toggle (`Preview` / `Edit`). `Preview` is the clean final-view alternative; `Edit` opens editing workflows and sidebar. Removed redundant standalone Edit button. (~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-17 / Remove editable section header chrome in CCL review / Replaced collapsible/editable blue section header bars (chevrons + inline edit icon) on the A4 document surface with plain heading text rows so Review stays clean and document-like. (~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-17 / Add true Preview vs Review mode in CCL / Introduced toolbar toggle (`Preview` / `Review`) in CCL preview. `Preview` now locks the document to final-output view (no inline editing, sidebar closed), while `Review` enables click-to-edit and field navigation/editor flows. Edit button now auto-switches to Review. (~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-17 / Remove inline markup chrome from CCL preview / Changed CCL preview field rendering to plain final-document text (no provenance borders/background highlights/placeholder labels), while keeping click-to-edit behaviour. Preview now reads like the finished letter output. (~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-17 / Unify Origin and CCL spaces to Helix blue palette / Removed remaining hardcoded green and purple accents from Origin/InlineWorkbench and CCL Preview surfaces, mapping success/provenance/ops-toggle/chip states to Helix blue tokens (`colours.highlight`, `colours.blue`, `colours.missedBlue`) for consistent dark-mode branding across Matter Overview + CCL flows. (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-17 / Separate Origin section and remove border seam overlap / Replaced the top separator above Origin with clean spacing so it no longer touches the card, and removed InlineWorkbench seam hacks (`marginTop: -1`, `translateY(-1px)`, inner top border overlap) to stop nested border collisions inside the Origin box. (~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-17 / Rebrand MatterOverview to UserBubble depth palette / Fixed card hierarchy: metricCardStyle and sectionCardStyle now use cardBackground (#081c30) instead of sectionBackground, giving visible lift against both left column (dark.background) and right sidebar (sectionBackground). Removed data source badge gradient (replaced with flat cardBackground). Fixed Clio button to use brand cardBackground/border/text tokens. Fixed doc count pill and Next Steps border to brand tokens. Eliminated all remaining Tailwind greens, sky-blues, slates, and gradients across both .tsx and styles file. (~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/matters/styles/matterOverview.styles.ts)
2026-02-17 / Fix Data Centre JSX regression / Removed orphaned Coverage Audit Trail JSX fragment that caused cascading TSX parse errors in DataCentre. Type-check now passes. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Promote reconciliation and simplify coverage UI / Removed duplicate Coverage Audit Trail panel, elevated Reconciliation (formerly Integrity Checks) as top signal with concise live operation entries, and simplified coverage rows into checkbox-style compliance items with reduced log clutter. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Extend smart auto-sync to archive months / Coverage auto-sync now includes older/archive windows at a slower cadence (120-day threshold) while prioritising recent months first; removed explicit archive/locked freshness labels to keep this low-noise in UI. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Add smart month auto-sync for coverage / Data Centre coverage now auto-syncs only actionable month windows (recent unsynced or stale months), caps automatic runs to avoid overkill, and treats older windows as locked/archive instead of repeatedly refreshing immutable history. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Rebalance Reporting Home visual hierarchy / Refined dark-mode Reporting Home surfaces to reduce playful contrast and improve critical-data readability: calmer stroke/border system, reduced saturated blue fills on report cards and feed chips, unified panel backgrounds via reportingFoundation tokens, and smoother card/status transitions while keeping sharp geometry. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Correct Reporting dark canvas to Website Blue / Updated Reporting page-level dark backgrounds from `colours.dark.background` to `colours.websiteBlue` so the hero (`#061733`) renders with proper brand contrast and no longer appears washed/light in context. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Align colour tokens with brand palette / Added `helixBlue` (#0D2F60) as canonical brand name in colours.ts. `missedBlue` retained as legacy alias. Updated brand palette in copilot-instructions.md with official 6-colour brand hierarchy (Website Blue → Helix Dark Blue → Helix Blue → Helix Highlight → Helix CTA → Helix Grey) with RGB values. Hero box background now uses `colours.darkBlue`. (~ src/app/styles/colours.ts, ~ .github/copilot-instructions.md, ~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Rebrand MatterOverview to Helix palette / Replaced all Tailwind green (#22c55e, #86efac, #15803d, #16a34a, #10B981), sky-blue (rgba(125,211,252), rgba(56,189,248)), and slate (#94a3b8, #64748b) colours with brand tokens (colours.highlight, colours.cta, colours.missedBlue, colours.subtleGrey, colours.greyText). Pipeline pills, status badges, progress bar, copy chip feedback, rating colours, audit dots, team dots, data source badge all now use colours.ts exclusively. (~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/matters/styles/matterOverview.styles.ts)
2026-02-17 / Remove Quick Thoughts box from Reporting Home / Deleted the dev-only Notes & Suggestions section and its NotesAndSuggestionsBox component entirely. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Fix Activity Monitor for production / Rewrote LogMonitor with SSE-first strategy and automatic polling fallback. Tries SSE 3 times (8s timeout each), then falls back to polling /api/logs/recent every 2.5s. Fixes stale closure on isPaused, adds mounted guard, deduplicates entries, and shows connection mode (Live/Polling/Offline) in header badge. Also added /api/logs/stream to setupProxy SSE routes for dev. (~ src/tabs/Reporting/LogMonitor.tsx, ~ src/setupProxy.js)
2026-02-17 / Match CCL page to ops panel navy / Replaced washed-out gradient backgrounds with solid #061733 navy (matching CCL Ops Panel) for paper area, toolbar, and sidebar. Paper itself uses #0a1e3a for depth contrast. Light mode tightened to branded steel-blue tones. Section heading and outline opacity strengthened. (~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-17 / Fix user bubble to use actual brand tokens / Replaced all invented hex blues (#bfdbfe, #7da8d4, #4a7fb5, #0b2444) with actual colours.ts values: dark.background, dark.sectionBackground, dark.cardBackground, dark.cardHover, dark.border, dark.borderColor, dark.text, dark.subText, subtleGrey, greyText. No more made-up colours. (~ src/components/UserBubble.tsx)
2026-02-17 / Rebrand user bubble to Helix blue hierarchy / Replaced all purply slate-based dark-mode tokens (backgrounds, borders, shadows, text) with Helix blue stack (websiteBlue base, darkBlue surfaces, blue accents). Moved colour swatch from header name line to a dedicated lightweight section with labelled chips and hover magnify. Popover shell, overlay, avatar, local/admin badges all now use brand-consistent values. (~ src/components/UserBubble.tsx)
2026-02-17 / Add lightweight Helix swatch to user bubble / Added a compact five-colour swatch strip (websiteBlue, darkBlue, blue, accent, cta) beside user initials in the user bubble header so brand palette tuning can be visualised quickly in-context. (~ src/components/UserBubble.tsx)
2026-02-17 / Remove explicit AOW legend treatment in Reporting Home / Removed the area-of-work colour chip legend from the Reporting Home hero to avoid over-explicit key styling while keeping the broader Helix brand colour direction in place. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Remove purple-leaning dark tint from Reporting Home / Corrected Reporting Home dark-mode palette to follow Helix blue hierarchy (website blue base, dark blue lifts, Helix blue signal) by replacing cyan/slate accents and residual slate overlays with brand-blue values across cards, callouts, controls, navigator chips, and feedback panel states. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Start Helix brand colour pass in Reporting Home / Re-themed Reporting Home toward Helix CRM language: true dark base with blue-lifted panels, mode-aware signal colour usage (accent in dark, highlight in light), CTA red on primary actions, and added area-of-work colour legend chips (Commercial/Property/Construction/Employment) in the hero for brand-consistent context. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Soften Reporting Home shadows for CRM flatness / Reduced heavy depth effects in Reporting Home by softening global surface shadow and removing card/panel/button hover shadows, with lighter callout elevation only where needed for focus. Preserves hierarchy and interactions while matching flatter Helix CRM visual language. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Remove Reporting Home gradients for CRM clarity / Flattened Reporting Home visual treatment by removing gradient backgrounds from shell, hero, report cards, data-window callout, progress bar accent, and feedback panel, replacing them with clean CRM-style flat surfaces and existing reporting panel tokens. This keeps hierarchy and functionality unchanged while reducing visual noise. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Standardize SEO and PPC report context headers / Aligned SEO and PPC internal report headers to the shared reporting shell style with compact context chips (range + sync freshness), reducing top-of-report noise while keeping existing controls and report-specific data source details intact. (~ src/tabs/Reporting/SeoReport.tsx, ~ src/tabs/Reporting/PpcReport.tsx)
2026-02-17 / Deepen CCL A4 and section brand contrast / Updated the main CCL preview surface to feel less washed out and more aligned with the dark operations modal: strengthened paper-shell backgrounds for light/dark modes, upgraded dark-mode paper to a richer navy gradient, increased branded outline contrast, and applied Helix-blue section header containers (background, border, left accent) for clearer structure on the A4 document area. (~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-17 / Align main CCL palette with ops modal dark brand / Removed green-leaning status/completion accents across the core CCL flow and shifted them to Helix blue for consistency with the CCL Operations modal. Updated AI provenance styling, AI complete status chip, Clio availability dot, questionnaire completion accents, and editor-ready badge to use the same blue family. (~ src/tabs/matters/ccl/PreviewStep.tsx, ~ src/tabs/matters/ccl/QuestionnaireStep.tsx, ~ src/tabs/matters/ccl/CCLEditor.tsx)
2026-02-17 / Clarify CCL version audit blocks + preview errors / Simplified expanded history cards by removing duplicated Situation/meta blocks and consolidating around Delivery Audit + Letter Snapshot for clearer CRM-style readout. Delivery Audit now includes client/handler/ref/expiry in one place, and Letter Snapshot uses broader field fallbacks (including long-form captured text) to avoid empty snapshots. Also hardened one-click reconstruct client handling to surface real server/status errors instead of generic "Network error" when preview fails. (~ src/tabs/matters/ccl/CclOpsPanel.tsx, ~ src/tabs/matters/ccl/cclAiService.ts)
2026-02-17 / Rebrand CCL Fed Data and strengthen audit readability / Replaced purple Fed Data styling with Helix blue, made the feed explicitly hideable with Show/Hide + Refresh controls, and made key context snippets (`initialCallNotes`, `enquiryNotes`, `instructionNotes`) always render with clear fallback text when absent. Reduced top-strip badge noise and upgraded version detail cards with explicit Delivery Audit fields (status, who, when, to, where, doc refs) plus a concise Letter Snapshot excerpt for CRM-style reconstruction clarity. (~ src/tabs/matters/ccl/CclOpsPanel.tsx)
2026-02-17 / Surface CCL situation state clearly / Improved CCL Ops readability by adding explicit situation flags in the header (client missing, no AI trace, not assessed), always showing tab counts including zero, and adding a per-version "Situation" block with core state (client/handler/area/trace) plus a concrete next action. This makes sparse records understandable at a glance instead of metadata-heavy. (~ src/tabs/matters/ccl/CclOpsPanel.tsx)
2026-02-17 / Align CCL ops header with tab intent / Reduced top-level CCL Ops noise by replacing the duplicated summary metrics strip (latest version / last AI run / coverage chips) with a single contextual line that reflects the active tab, while keeping only essential global identity signals (latest status and client). This removes overlap between header metrics and History/Traces/Assessments tabs and makes panel hierarchy coherent. (~ src/tabs/matters/ccl/CclOpsPanel.tsx)
2026-02-17 / Enforce true CCL operator attribution / Fixed CCL audit identity so saved versions and AI traces resolve `CreatedBy` from authenticated/requested operator context (req.user initials, payload/header initials, then trusted email) instead of weak header fallback. Frontend CCL generate/save/AI-fill requests now send `initials`, middleware now enriches `req.user` from headers too, and architecture instructions now codify attribution precedence to prevent regressions. (+ server/utils/requestActor.js, ~ server/routes/ccl.js, ~ server/routes/ccl-ai.js, ~ server/middleware/userContext.js, ~ src/tabs/matters/ccl/CCLEditor.tsx, ~ src/tabs/matters/ccl/PreviewStep.tsx, ~ src/tabs/matters/ccl/cclAiService.ts, ~ .github/instructions/ARCHITECTURE_DATA_FLOW.md)
2026-02-17 / Simplify CCL history card signal and fix hooks order / Moved HistoryTab hook state declarations above early return to satisfy React hook ordering, normalized unknown creators to "AI Pipeline", and reduced versioning noise by removing collapsed trace/source/field-count chips and the dense trail strip in expanded cards while retaining key sent/expiry confirmation. (~ src/tabs/matters/ccl/CclOpsPanel.tsx)
2026-02-17 / Add one-click CCL sent-letter reconstruction / Added ops workflow to reconstruct any saved CCL version into a previewable .docx from the exact snapshot payload, with sent confirmation metadata (finalised/uploaded IDs) and expiry status (explicit field date or inferred 30-day window). Also expanded version-history payload to include full snapshot fields so history cards can reliably show client/provenance and support one-click preview. (~ server/routes/ccl-ops.js, ~ server/utils/cclPersistence.js, ~ src/tabs/matters/ccl/cclAiService.ts, ~ src/tabs/matters/ccl/CclOpsPanel.tsx)
2026-02-17 / Fix CCL quick-edit jump-to-document flow / Reworked PreviewStep quick-field navigation so the jump icon now reliably takes users to editable letter content: expands relevant collapsed document sections first, resolves field aliases for clause placeholders, enters inline edit mode on target fields, and falls back to section scroll + field focus when exact placeholders are absent. Also replaced dynamic sidebar/input IDs with data attributes to avoid duplicate-ID diagnostics. (~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-17 / Remove EID fields from Instructions seed / Dropped `EIDStatus` and `EIDOverallResult` from `Instructions` inserts in seed-demo-matter.sql to avoid invalid-column failures on environments where EID state lives only in `IDVerifications`. Keeps EID pipeline coverage intact via dedicated IDVerifications seed rows. (~ tools/db/seed-demo-matter.sql)
2026-02-17 / Improve CCL high-level panel context / Refined CclOpsPanel high-level UX for sparse records: added top snapshot client chip (derived from latest content fields/trace context), switched version-card fallbacks to loose key matching across CCL field variants (including insert_clients_name and handler keys), and now resolves client/handler/practice from trace ContextFieldsJson when content columns are null. Reduces "Client not captured" false negatives and preserves trail readability. (~ src/tabs/matters/ccl/CclOpsPanel.tsx)
2026-02-16 / Remove compile-time seed column traps / Reworked seed-demo-matter.sql to avoid SQL parser failures on optional columns: Instructions inserts no longer hard-reference ProspectId, Deals inserts now dynamically include ProspectId/prospect_id only when present, and Core Data enquiries inserts are now fully dynamic for name/email/date/notes variants. This prevents Invalid column name aborts during initial parse. (~ tools/db/seed-demo-matter.sql)
2026-02-16 / Strengthen CCL version trail visibility / Upgraded CCL history cards to avoid "Unknown" dead-ends: derive client, fee earner, and practice area fallbacks from saved FieldsJson; normalize creator initials so UNKNOWN/System values render as concise badges; and surface per-version provenance chips (trace id, model, status, duration, source count, instruction ref) so trail context remains visible even when top-level columns are sparse. (~ src/tabs/matters/ccl/CclOpsPanel.tsx)
2026-02-16 / Harden demo seed for schema variants / Updated seed-demo-matter.sql to tolerate environment column drift: Instructions inserts now handle missing ProspectId, Payments insert resolves instruction/payment/date/status column variants dynamically, and instructions dbo.enquiries inserts now use adaptive column detection (acid/notes/date/email) instead of hard-coded first_name/last_name fields. Prevents seed aborts on mismatched SQL schemas. (~ tools/db/seed-demo-matter.sql)
2026-02-16 / Tighten CCL ops nav and modal brand / Removed summary-strip duplication of tab categories by switching chips to operational metrics (latest version, last AI run, assessment coverage). Upgraded assessment modal chrome with stronger brand shell, metadata subheader, section cards, and refined footer actions for closer alignment with CCL panel styling. (~ src/tabs/matters/ccl/CclOpsPanel.tsx)
2026-02-17 / Reports shell standardization pass 1 / Added consistent report context headers (title, purpose, back action) across report views and unified the active-report shell background to the shared reporting foundation. Keeps report separation while improving orientation and reducing visual gradient noise in both light/dark modes. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Establish reporting visual foundation baseline / Added shared reporting surface tokens (shell/panel background, border, shadow) and applied first pass to Data Hub + Reporting Home strip to reduce washed-out look and align with Helix CRM simplicity standards. This sets the style baseline for consistent rollout across all report views. (+ src/tabs/Reporting/styles/reportingFoundation.ts, ~ src/tabs/Reporting/DataCentre.tsx, ~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Simplify reports Data Hub strip hover styling / Removed imperative hover tint handlers from the Reporting Home Data Hub status strip and switched to a neutral, low-noise border/background treatment aligned with the simplified Home look and feel. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Promote integrity checks above custom sync / Reordered drilled-in execution hierarchy so Integrity Checks sits as a separate top block above Custom Sync, reducing confusion with Coverage Audit Trail and making validation-first flow clearer. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Coverage checklist freshness cues + reduced internal scrolling / Updated Data Hub coverage to behave like a checklist with dynamic freshness badges (Needs sync/Monitor/Overdue/Stale/Archive) based on month recency and last sync cadence, including clearer secondary context (who synced, when, row/value stats). Removed most internal fixed-height scroll containers in coverage/audit sections so panels expand naturally by default. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-16 / Align coverage audit hierarchy + WIP week warning / Moved live DB/server audit streams into Coverage as a dedicated “Coverage Audit Trail” so month status and its operational evidence live together. Reframed sync area as “Custom Sync” with guidance to use coverage month rows for preset/monthly refresh. Added explicit WIP confirmation requirement when selected range touches current week, warning that Mon→today will not be written to SQL. Updated WIP row labels to state dashboards stitch current-week data from Clio API. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-16 / Reintroduce unified live ops console / Added a real-time Execution Console inside the same sync/integrity surface (DB Sync + Server Ops streams) so processing preview remains visible without duplicating coverage content. Kept hierarchy clean: coverage as source of month state, execution panel as active run telemetry. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-16 / Unify Data Hub execution hierarchy / Reworked drilled-in Data Hub layout to reduce noise: moved integrity checks into the same execution surface as sync controls (collapsible), removed the separate narrow integrity column, and removed the duplicate Activity log block under coverage so coverage remains the single source of month-level status. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-16 / Enforce WIP current-week SQL exclusion at source / Added server-side guard in syncWip to cap any overlapping range at last Sunday and skip current-week-only windows, so scheduler and manual syncs cannot write current-week WIP into SQL. Prevents API+SQL double-counting and keeps current week API-only until the following week. (~ server/routes/dataOperations.js)
2026-02-17 / Comprehensive demo pipeline seed / Rewrote seed-demo-matter.sql to cover ALL pipeline tables across both databases and all 3 demo cases. Part A (Instructions DB): Instructions ×3, Deals ×3, PitchContent ×2, IDVerifications ×2, RiskAssessment ×1, Payments ×1, Documents ×4, Matters ×1, dbo.enquiries ×3. Part B (Core Data DB): legacy enquiries ×3 with IDENTITY_INSERT for IDs 90001/90002/99999. Each case has rich initial_call_notes text for CCL AI context gathering. IF NOT EXISTS guards on all rows. (~ tools/db/seed-demo-matter.sql)
2026-02-17 / Data Hub CRM clarity redesign / Restored high-level entry view: two clean summary cards (row count, latest date, staleness) that give position at a glance before drilling into an operation. Replaced tab strip with breadcrumb navigation when drilled in. Stripped visual noise throughout: removed CSS animations (ops-pulse, hover transforms, box-shadow effects), removed glowing status dots, removed uppercase/letter-spacing from micro-labels, bumped minimum font sizes from 6-7px to 9px. Simplified section header (removed collapse chevron, database icon, syncing badge, "Clio → SQL" label). Status banner now hidden when healthy. Sync card headers flattened to single-row stats. Coverage month rows collapsed from 3-row to single-row layout with inline stats. Activity log fonts bumped. Feeds section simplified. Removed dead state variables (opsCollapsed, opsChevronHovered, toggleOpsCollapse, bannerIcon). (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / CCL ops panel visual redesign / Complete visual overhaul of CclOpsPanel to match matter opening brand quality. Dark navy (#061733) header with shield icon and Raleway font. Monospace data values throughout (Consolas). Left-border accent cards coloured by status/score across all tabs. Square 2px border-radius replacing old rounded corners. Avatar component showing user initials. Status chips with icons (Edit/CheckMark/CloudUpload). Content preview with line-clamp in history cards. Proportional field accuracy bar in assessments (green/amber/red/grey). Assessment form modal with dark navy header, branded score buttons, styled issue toggles. FieldGrid now accepts accent prop for coloured keys with arrow separators. Added ContextSection shared component. Stat chip summary strip with monospace counts. Active tab fills navy with white text. (~ src/tabs/matters/ccl/CclOpsPanel.tsx)
2026-02-16 / Data Hub coverage-first redesign / Restructured Data Hub layout: replaced two big operation selector buttons with a slim tab strip (Collected | Recorded, inline row counts + staleness + scheduler dot). Coverage checklist promoted from 300px side panel to primary left column (flex: 2). Sync controls (range presets, date pickers, confirm, sync button) collapsed into a "Custom Sync" accordion on the right. OperationValidator stays in the right column below the accordion. Removed: operation selector screen, Back button, coverage toggle buttons, coverage close button, compact log summary. Auto-loads ops data on mount (no more "Load" prompt). (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-16 / Guard AI fill behind manual invoke / AI fill no longer auto-fires on CCL preview mount — prevents accidental trace/DB clutter. "Generate AI Draft" button added to toolbar when status is idle. New "Show Fed Data" button in ops panel calls context-preview endpoint to dry-run the data gathering pipeline (shows resolved data sources, context fields, snippets, prompt lengths) without calling AI or saving a trace. New POST /api/ccl-ai/context-preview endpoint reuses gatherFullContext/buildUserPrompt/buildDebugContext. (~ src/tabs/matters/ccl/CCLEditor.tsx, ~ src/tabs/matters/ccl/PreviewStep.tsx, ~ src/tabs/matters/ccl/CclOpsPanel.tsx, ~ server/routes/ccl-ai.js, ~ src/tabs/matters/ccl/cclAiService.ts)
2026-02-16 / Seed demo matter for CCL pipeline / Created seed SQL to insert Instructions, Deals, and PitchContent rows for HELIX01-01 demo matter. Provides rich context (commercial retainer notes, pitch email, deal data) so the AI fill pipeline gathers real data sources and generates full traces visible in the ops panel. Enables end-to-end testing of the assessment system. (+ tools/db/seed-demo-matter.sql)
2026-02-16 / Drop CclFeedback table / Removed CclFeedback table entirely — superseded by CclAssessment. Stripped saveCclFeedback/getCclFeedback from persistence, admin API, ccl-ai feedback persist, ccl-ops dual-write, frontend types, and instant-lookup queries. getCclStats no longer returns feedback stats. Original migration commented out. Drop migration created. (+ tools/db/drop-ccl-feedback.sql, ~ server/utils/cclPersistence.js, ~ server/routes/ccl-admin.js, ~ server/routes/ccl-ai.js, ~ server/routes/ccl-ops.js, ~ src/tabs/matters/ccl/cclAiService.ts, ~ tools/instant-lookup.mjs, ~ tools/db/migrate-ccl-persistence.sql, ~ .github/instructions/DATABASE_SCHEMA_REFERENCE.md)
2026-02-17 / CCL assessment system / Built structured quality assessment system for CCL outputs. New CclAssessment table (25+ columns: scores, field accuracy, issue categories, prompt suggestions, applied-to-prompt tracking). Assessment UI in ops panel: 1-5 scoring with colour-coded labels, field accuracy inputs (correct/edited/replaced/empty), 8 issue category toggle chips, free-text notes, prompt suggestion textarea with applied badge. Gated to LZ and AC only. 5 new persistence functions (save, list, corpus query with JOINs, accuracy summary, mark-applied). 5 new admin API endpoints. Assessment corpus endpoint provides filterable prompt engineering context (JOINs to CclContent + CclAiTrace). Dual-write from bug reporter to CclFeedback. Ops panel fully rebuilt: history tab shows "Assess this version" button + checkmark on assessed versions, new Assessments tab replaces Feedback tab with aggregate summary strip. (+ tools/db/migrate-ccl-assessment.sql, ~ server/utils/cclPersistence.js, ~ server/routes/ccl-admin.js, ~ server/routes/ccl-ops.js, ~ src/tabs/matters/ccl/CclOpsPanel.tsx, ~ src/tabs/matters/ccl/cclAiService.ts, ~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-17 / Coverage panel checklist redesign / Coverage panel now auto-opens and syncs to the active operation card (collected or WIP). Month rows redesigned as a human-readable checklist: coloured left border (green/amber/red/grey), status badge (✓ synced / ✗ error / not synced), who synced it, when, and row count. Collected months now show SQL row count + £ value. Added collected stats to month-audit endpoint. Updated ARCHITECTURE_DATA_FLOW.md with current-week boundary rules and coverage panel behaviour. (~ src/tabs/Reporting/DataCentre.tsx, ~ server/routes/dataOperations.js, ~ .github/instructions/ARCHITECTURE_DATA_FLOW.md)
2026-02-17 / WIP sync current-week guard + billable visibility / WIP month coverage sync now caps the current month at last Sunday to prevent overlap with Clio-sourced current-week data (used by Management Dashboard). Coverage panel shows per-month billable/non-billable row counts with warning when all entries are billable. Current month shows ⚡ indicator for excluded current-week dates. (~ src/tabs/Reporting/DataCentre.tsx, ~ server/routes/dataOperations.js)
2026-02-17 / CCL instant-lookup + Key Vault connectivity / Added `ccl` type to instant-lookup.mjs with full query support: stats overview, matterId lookup (versions + AI traces + feedback), InstructionRef lookup, status filter, and name/text search. Updated cclPersistence.js to resolve DB credentials via Key Vault (same pattern as instant-lookup) — works locally and in production. Future-proofed migration tables: added DocumentType, TemplateVersion, SentToClient/SentAt/SentMethod, AiTraceId FK, token usage (PromptTokens/CompletionTokens/TotalTokens), RetryCount, ResolvedBy/ResolvedAt for feedback. (~ tools/instant-lookup.mjs, ~ server/utils/cclPersistence.js, ~ tools/db/migrate-ccl-persistence.sql)
2026-02-17 / CCL telemetry parity / Added full App Insights instrumentation to ccl.js: Generate.Started/Completed/Failed, Save.Started/Completed/Failed, Load events + Duration and FieldCount metrics. Added FieldCount and ContextSources metrics to ccl-ai.js. Added 5 aggregate admin endpoints: by-practice-area, by-fee-earner, timeline, ai-timeline, ops-log (unified event stream). CCL now at operational observability parity with DataOps/reports tab. (~ server/routes/ccl.js, ~ server/routes/ccl-ai.js, ~ server/routes/ccl-admin.js, ~ server/utils/cclPersistence.js)
2026-02-17 / CCL persistence + ops layer / Built full CCL persistence: CclContent (versioned content snapshots), CclAiTrace (full AI audit trail with prompts/outputs/context), CclFeedback (persisted ratings) tables. Server persistence utility auto-saves on every generate/save/AI-fill. Admin-only Ops panel in PreviewStep shows content history, AI traces with expandable prompts/context/output, and feedback timeline. New ccl-admin API route for management queries. (+ tools/db/migrate-ccl-persistence.sql, + tools/db/run-ccl-migration.mjs, + server/utils/cclPersistence.js, + server/routes/ccl-admin.js, + src/tabs/matters/ccl/CclOpsPanel.tsx, ~ server/routes/ccl.js, ~ server/routes/ccl-ai.js, ~ server/index.js, ~ server/server.js, ~ src/tabs/matters/ccl/PreviewStep.tsx, ~ src/tabs/matters/ccl/cclAiService.ts)
2026-02-16 / Release notes modal redesign / Rebuilt modal with category auto-detection (New/Improved/Fixed/Under the hood), month grouping with version labels, filter chips with counts, and collapsible month sections. Removed Pivot tabs (Ideas tab dropped). (~ src/components/ReleaseNotesModal.tsx)
2026-02-16 / QuickActionsBar release notes chip / Added release notes button with unread dot (per-session) to the quick actions bar; tightened bar spacing and styling. (~ src/tabs/home/QuickActionsBar.tsx)
2026-02-16 / CCL Clio upload pipeline / Built 3-step presigned URL upload to Clio matters: generate .docx from live fields → POST /documents → PUT binary to S3 → PATCH confirm. Includes upload menu in PreviewStep sidebar, confirmation dialog, and demo-matter support. (~ server/routes/ccl-ops.js, ~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-16 / CCL word template overhaul / Replaced template with full-preamble professional CCL .docx; word generator now defaults all 40+ template fields to prevent ReferenceError; added preamble paragraphs for regulatory and complaints info. (~ templates/cclTemplate.docx, ~ server/utils/wordGenerator.js, ~ src/tabs/matters/ccl/cclSections.ts)
2026-02-16 / Home tab CSS cleanup / Removed ~1400 lines of unused EnhancedHome.css rules; stripped orphan Home.css and empty HomeAnimations.css. (~ src/tabs/home/EnhancedHome.css, ~ src/tabs/home/Home.css, ~ src/tabs/home/HomeAnimations.css)
2026-02-16 / TimeMetricsV2 responsive layout / Added mobile-responsive CSS grid breakpoints and simplified component styling. (~ src/components/modern/TimeMetricsV2.tsx)
2026-02-16 / Demo matter synthetic data / CCL preview and matter routes return synthetic data for DEMO-3311402 so demo mode doesn't hit Clio. (~ server/routes/matters.js, ~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-16 / Resources-core Clio auth consolidation / Replaced inline Key Vault Clio token logic with shared clioAuth utility, removing ~30 lines of duplicated refresh token handling. (~ server/routes/resources-core.js)
2026-02-16 / Risk assessment minor fix / Minor risk assessment component fix. (~ src/components/RiskAssessment.tsx)
2026-02-16 / AML review 12-month runbook / Added operations runbook for periodic AML review follow-up process. (+ docs/AML_REVIEW_12_MONTH_REPORT_RUNBOOK.md)
2026-02-16 / Strengthen changelog logging instruction / Expanded one-line logging rule to a CRITICAL section with format, rules, and examples so agents stop skipping it. (~ .github/copilot-instructions.md)
2026-02-14 / Unified entry gate / Replaced separate PasscodeDialog + UserSelectionDialog with single EntryGate component handling passcode entry, user selection, and offline/error states. (+ src/components/EntryGate.tsx, - src/components/PasscodeDialog.tsx, - src/components/UserSelectionDialog.tsx, ~ src/index.tsx)
2026-02-14 / Form health check / Added FormHealthCheck component + server endpoint to validate form submissions with structured error reporting and retry guidance. (+ src/CustomForms/shared/FormHealthCheck.tsx, + server/routes/formHealthCheck.js, ~ server/index.js)
2026-02-14 / CCL operations route / Added CCL ops route for document lifecycle management (list, status, regenerate). (+ server/routes/ccl-ops.js, ~ server/index.js)
2026-02-14 / Forms cleanup / Removed unused imports across custom form components. (~ src/CustomForms/CounselDirectory.tsx, ~ src/CustomForms/CounselRecommendationForm.tsx, ~ src/CustomForms/ExpertDirectory.tsx, ~ src/CustomForms/ExpertRecommendationForm.tsx, ~ src/CustomForms/TechIdeaForm.tsx, ~ src/CustomForms/TechProblemForm.tsx, ~ src/tabs/forms/Forms.tsx)
2026-02-12 / CCL AI token-mode auto-retry / Added resilient token parameter negotiation in Azure OpenAI client: attempts preferred mode then retries automatically on unsupported-parameter 400s (`max_tokens` ↔ `max_completion_tokens`). This fixes CCL AI failures when deployment names are custom and model-family detection is ambiguous. (~ server/utils/aiClient.js)
2026-02-12 / CCL GPT-5.2 compatibility + autosave stability / Updated AI client default deployment to `gpt-5.2` and added model-aware token parameter mapping (`max_completion_tokens` for GPT-5, `max_tokens` otherwise) to resolve 400 errors on CCL AI calls. Also stopped CCL autosave PATCH from regenerating/writing documents in `public/ccls` (which could trigger app reload-like behaviour during editing); PATCH now saves DB draft + non-public file fallback under `logs/ccl-drafts`. (~ server/utils/aiClient.js, ~ server/routes/ccl.js)
2026-02-12 / CCL Foundry parity hardening / Aligned CCL AI defaults with enquiry-processing-v2 Foundry setup (`AZURE_OPENAI_DEPLOYMENT` default now `gpt-5.1`, supports `AZURE_OPENAI_KEY_SECRET_NAME` alias), hardened Instructions lookup to tolerate missing `ProspectId` by dynamically using available ID columns (`ProspectId`/`id`/`acid`), and added one-time `CclDrafts` table existence detection to suppress repeated SQL warnings and fall back cleanly to file drafts when table is absent. (~ server/utils/aiClient.js, ~ server/routes/ccl-ai.js, ~ server/routes/ccl.js)
2026-02-12 / CCL AI transparency + resilience / Hardened CCL AI context loading against schema drift by removing hard dependency on `CreatedAt` (runtime column detection for ordering), added structured AI trace payloads (trackingId, deployment, options, source snippets, prompt length, fallback reason), surfaced full prompt/context trace in CCL preview sidebar, and stabilised MatterOverview mount by removing forced `key` remount to prevent CCL editor state resets that looked like spontaneous refreshes. (~ server/routes/ccl-ai.js, ~ src/tabs/matters/ccl/cclAiService.ts, ~ src/tabs/matters/ccl/CCLEditor.tsx, ~ src/tabs/matters/ccl/PreviewStep.tsx, ~ src/tabs/matters/Matters.tsx)
2026-02-12 / Prospects realtime EID + risk convergence / Fixed prospects overview/workbench state lag where EID/risk cues could stay stale until full refresh. Added optimistic local overrides for EID trigger results and risk save payloads, merged riskAssessments from local instruction overrides into effective instruction data, and wired/awaited risk-save + refresh callbacks through Enquiry line/timeline workbench wrappers so stage cues settle immediately. (~ src/tabs/enquiries/Enquiries.tsx, ~ src/tabs/enquiries/EnquiryLineItem.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-12 / Matter opening traceability hardening / Expanded App Insights coverage for prospects → overview → workbench matter-opening pipeline by instrumenting sync-instruction-client endpoints (started/completed/failed + duration metrics), adding start/config/duration signals to opponents and matter-request patch routes, and propagating a per-run `x-matter-trace-id` from processing actions for end-to-end correlation across API steps. (~ server/routes/sync-instruction-client.js, ~ server/routes/opponents.js, ~ server/routes/matterRequests.js, ~ src/tabs/instructions/MatterOpening/processingActions.ts, ~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx)
2026-02-12 / Matter opening one-off tool / Added reusable one-off replay command to run the matter-opening endpoint chain from an instruction reference without ad-hoc script hunting. New script hydrates minimal payload from Instructions DB and executes: opponents → matter-requests → clio-contacts → clio-matters → instruction link → matter-request patch, with `--dry-run` support. Documented in copilot instructions for future agents. (+ tools/run-matter-oneoff.mjs, ~ .github/copilot-instructions.md)
2026-02-12 / Matter opening pre-validation fallback / Fixed one-off blocker where matter opening failed at pre-validation when requester profile data was missing. `simulateProcessing` now resolves processing initials from assigned fee earner/originating solicitor when `userInitials` is empty, builds richer fallback `workingUserData` from `teamData` (Asana client/secret/refresh + Entra ID), and runs processing actions with resolved initials so Clio/Asana steps can proceed. (~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx)
2026-02-12 / Workbench source mismatch fix / Fixed pipeline source rendering showing synthetic "originalForward" instead of real source values. Changes: (1) stop injecting `originalForward` fallback during enquiry normalization and combined legacy mapping; (2) InlineWorkbench now treats `originalForward` as placeholder and falls back to matter/deal source (e.g. `organic search`); (3) enquiries-unified prospectId matching corrected to use Instructions DB `id` OR `acid` and include `source` in instructions select, preventing cross-space ID collisions from pulling wrong legacy enquiry context. (~ src/utils/normalizeEnquiry.ts, ~ server/routes/enquiries-combined.js, ~ server/routes/enquiries-unified.js, ~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-10 / CCL AI-powered intake fill / Built full AI pipeline for Client Care Letters: user opens CCL → lands on A4 preview → AI generates all 26 intake fields (scope, costs, action points, timescales) from matter context via Azure OpenAI. Includes: (1) server/utils/aiClient.js — Azure OpenAI singleton with Key Vault auth, chatCompletion helper with App Insights telemetry. (2) server/routes/ccl-ai.js — POST /api/ccl-ai/fill endpoint with system prompt for UK solicitor CCL generation, context gathering from Core Data + Instructions SQL databases, practice area defaults fallback (5 areas). (3) src/tabs/matters/ccl/cclAiService.ts — client-side fetch wrapper. (4) CCLEditor.tsx — defaults to preview step, fires AI fill on mount, merges AI fields with auto-filled handler/client fields. (5) PreviewStep.tsx — AI status banner in sidebar (loading/complete/partial/fallback/error), unfilled fields summary badge. Fallback chain: AI → partial + defaults → practice area defaults → commercial defaults. (+ server/utils/aiClient.js, + server/routes/ccl-ai.js, + src/tabs/matters/ccl/cclAiService.ts, ~ src/tabs/matters/ccl/CCLEditor.tsx, ~ src/tabs/matters/ccl/PreviewStep.tsx, ~ server/index.js, ~ .github/instructions/CCL_ROADMAP.md)
2026-02-09 / Prospects render performance (5 quick wins) / 1) Day separator counts pre-computed in useMemo Map — eliminates O(n²) filter inside .map(). 2) Date-range useEffect replaced with single-pass for-loop + shallow equality guard on setDateRange. 3) Person-initials filter uses existing claimerMap O(1) lookup instead of teamData.find() per enquiry. 4) POC dropdown options extracted to useMemo (pocOptionsMemo) — removes O(n²) findIndex dedup from every render. 5) userAOW + currentUserEmail hoisted before displayedItems.map() — identical values no longer recomputed per card. Zero behaviour change; tsc --noEmit passes. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-08 / Lazy-load reporting datasets / Removed auto-trigger refresh that streamed all 13 datasets on Reporting tab entry. Reports now load data on-demand: clicking a report card lazy-loads only its required datasets via handleReportCardClick. "Refresh all" no longer force-navigates to Data Centre. Dashboard CTA always clickable, delegates to handleOpenDashboard which lazy-loads if stale. Subtitle shows "Click a report or refresh to load data" when idle. Data Hub also defers its ops-status/log/month-audit fetches behind a Load button. (~ src/tabs/Reporting/ReportingHome.tsx, ~ src/tabs/Reporting/DataCentre.tsx)
2026-02-09 / Prospects loading optimisation / Mine+Claimed no longer blocks on a full team-wide fetch (5000-row dual-DB query). Uses prop data immediately; team-wide data loads lazily 3s later in background. Loading overlay suppressed during background prefetch when user already has visible data. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-09 / Pipeline filter cycle fix / Filter buttons now loop: none → has (green) → missing (red) → clear. Previously stuck on red with no reset. Added coloured dot indicators and descriptive tooltips showing current state + next action. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-09 / Prospects Phase 1a+1b: normalizeEnquiry extraction / Extracted normalizeEnquiry() and detectSourceType() to src/utils/normalizeEnquiry.ts; replaced all inline Enquiry & { __sourceType } patterns with NormalizedEnquiry type alias; fixed missing source field mapping in fetchAllEnquiries path; removed inline detectSourceType from component body; changed loading text to "Loading prospects…". (+ src/utils/normalizeEnquiry.ts, ~ src/tabs/enquiries/Enquiries.tsx, ~ .github/instructions/ROADMAP.md, ~ .github/instructions/WORKSPACE_OPTIMIZATION.md)
2026-02-07 / Matter opening workflow redesign / Replaced checkbox toggle pattern with modern clickable expandable sections (chevron indicators); added section header with guiding copy matching ConflictConfirmationCard design language; removed dead Checkbox imports + checkboxChipStyles; improved "skipped state" message with reassuring copy + checkmark icon; simplified "Who is the opponent?" heading. ClientInfoStep: added section header, role descriptions for each solicitor role, distinct icons (ContactInfo/AddFriend/AuthenticatorApp), auto-pre-select Responsible Solicitor from requestingUser. FlatMatterOpening: added footer hint below Continue button. (~ src/tabs/instructions/MatterOpening/OpponentDetailsStep.tsx, ~ src/tabs/instructions/MatterOpening/ClientInfoStep.tsx, ~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx, ~ .github/instructions/ROADMAP.md)
2026-02-06 / Matter opening email + data fixes / Email now sends to fee earner (primary) with LZ + CB in CC instead of hardcoded LZ-only test mode; added getTeamEmail to teamLookup; description pre-populated from instruction ServiceDescription; fee_earner_email added to team_assignments payload; instructionRecords enriched with eid/risk/documents/payments for instruction_summary in email template. (~ server/routes/clioMatters.js, ~ server/utils/teamLookup.js, ~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-06 / Matter opening inline in prospects / Portal-wrapped FlatMatterOpening as overlay; Open Matter button wired to local modal; matter pill shows processing state; onMatterSuccess calls onRefreshData + toast; onOpenMatter navigation dispatch removed (no-op). (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/Enquiries.tsx, ~ .github/instructions/ROADMAP.md)
2026-02-06 / ID review inline in prospects / Portal-wrapped EID action picker, approve modal, request docs modal; approve calls onRefreshData + toast; onOpenIdReview navigation dispatch removed. (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/Enquiries.tsx)
2026-02-06 / Demo mode enriched / Added DEMO-ENQ-0002 at proof-of-id with EID Refer + PEP Review for testing; added DEMO-ENQ-0003 fully complete; enriched EID records with realistic fields and isDemo flag. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-06 / Risk assessment inline in prospects / Portal-wrapped risk modal (clipping fix), auto-refresh via onRefreshData on save, processing pill state while modal open, parent toast on save, navigation dispatch removed. (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/Enquiries.tsx)
2026-02-05 / Fix dataOpsLog SQL persistence / Cache resolved connection string, align INSERT with full table schema (jobId, changedRows, triggeredBy, invokedBy), add clear error logging when pool unavailable. (~ server/routes/dataOperations.js)
2026-02-05 / Instant lookup ops range / Add ops mode with natural-language ranges (e.g. "operations this week") to query dataOpsLog. (~ tools/instant-lookup.mjs)
2026-02-04 / Matter metrics processing cue / Show one dot per metric action and surface active action in the toast body. (~ src/tabs/matters/Matters.tsx, ~ src/components/feedback/ToastProvider.tsx)
2026-02-04 / Enquiry timeline initials source / Remove guessed initials expansion; use actual data and prospect full name for inbound emails. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline entry behaviour / Don't auto-select first item on entry; clarify pitch origin label to "Sent by email" / "Sent as link". (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline type category styling / Add category-based icon containers (circle=communication, square=resource, filled=milestone) for visual distinction across filters, table and timeline. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline case chevron cue / Replace "Open ›" with a subtle rotating chevron that glows when active. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline top banner tone / Apply sharper, more serious styling to the hero banner and contact pills. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline POC initials fix / Preserve existing initials (e.g., LZ) and handle email/local-part cases. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline case badge cue fix / Replace chevron icon with text glyph to avoid runtime errors. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline case badge cue / Add a subtle Open cue to show case badges are selectable. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline POC initials / Derive full POC initials for new and legacy data without guessing. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline case badge date/time / Show time for new-space enquiries and drop year unless different. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline case badge meta / Show date only and claimed initials only in case badges. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline case badges quiet / Simplify case badges further while retaining area colour cue. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline case badges simplification / Reduce visual noise for a more serious, minimal case selector. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline case badges / Apply sharper, more serious case badge styling with clearer hover feedback. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline day separators hover / Table day separators now toggle compact/full labels on hover. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline table striping / Add subtle alternating row backgrounds for readability. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline table sorting / Enable header sorting for Date, Type, Description, and By with shared table header colours. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline table headers / Strengthen table header styling for clearer scanability. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline day separators / Soften table day headers so they sit behind the filter banner. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline filter label / Simplify Filter Activity label to just Filter. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline filter hover highlight / Hovering filter chips now subtly highlights matching timeline entries. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline Type column width / Widen the Type column in table view to avoid wrapping labels. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline By column width / Widen the By column in table view to reduce early wrapping. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline table time-only + forward action / Show time only in grouped table rows and restyle forward action as a subtle inline button. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry table day breakdown / Always show table view day groupings without the collapse toggle. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Prospect case cues simplification / Replace heavy case cards with cleaner CRM-style chips. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline filter clarity / Change “View mode” to “View” and enhance filter bar hierarchy/visual grouping. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline table view / Rename Ledger to Table, default to table view, group rows by day, and emphasise the By column. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Matters table headers + legacy fields / Rename headers and enrich legacy worktype + contact details in the table. (~ src/tabs/matters/MatterTableView.tsx, ~ src/tabs/matters/Matters.tsx)
2026-02-04 / Toast loading indicator / Add a subtle pulsing status dot to loading toasts and simplify the metrics loading message. (~ src/components/feedback/ToastProvider.tsx, ~ src/tabs/matters/Matters.tsx)
2026-02-04 / Outstanding balance cache refresh / Version global cache key and force fresh fetch when falling back to global balances. (~ server/routes/outstandingBalances.js, ~ src/tabs/matters/Matters.tsx)
2026-02-04 / Outstanding balance fallback / Include associated_matter_ids globally and fall back when user-scoped balances are empty. (~ server/routes/outstandingBalances.js, ~ src/tabs/matters/Matters.tsx)
2026-02-04 / Outstanding balance 401 retry / Refresh cached Clio token on user-matters 401 to restore outstanding balances. (~ server/routes/outstandingBalances.js)
2026-02-04 / Matters outstanding balance lookup / Harden Entra ID resolution and fallback to team data to avoid "undefined" user lookups. (~ src/tabs/matters/Matters.tsx)
2026-02-04 / Matters data source cue copy / Expand the v1/v2 tooltip text with reassurance and clearer meaning. (~ src/tabs/matters/MatterOverview.tsx)
2026-02-04 / Matters data source cue placement / Move the v1/v2 origin cue into the Data source badge line. (~ src/tabs/matters/MatterOverview.tsx)
2026-02-04 / Matters legacy client hydration / Add Clio client fetch for legacy matters with auto-load and refresh button. (~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/matters/Matters.tsx)
2026-02-04 / Matters all-scope access / Allow All scope to show everyone even for non-admins. (~ src/utils/matterNormalization.ts)
2026-02-04 / Matters client resolution + all scope / Allow All scope for fee earners and resolve missing client names in Matters using instruction/workbench data. (~ src/tabs/matters/Matters.tsx)
2026-02-04 / Matters tab open access / Removed the Matters early-access chip and rollout gating so Matters is visible to everyone. (~ src/app/App.tsx, ~ src/app/styles/CustomTabs.tsx, ~ src/app/admin.ts)
2026-02-04 / Payment receipt + link gating / Integrated receipt action into Transaction Details header and hid Create payment link outside localhost. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-04 / Payment ref copy chip / Moved payment ID under description, added standalone Ref column with copy chip + toast feedback. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-04 / Payment bar columns / Split currency and payment ID into dedicated payment bar columns alongside date. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-04 / Payment row compact meta / Moved currency/payment ID into the date column and removed the product box for a tighter payment detail layout. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-04 / Payment workbench hierarchy alignment / Restructured payment expanded details into consistent cards and spacing; aligned bank confirmation card styling. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-04 / Data ops two-card redesign / Replaced monolithic single-panel with two-card layout (Collected Time + WIP), each self-contained with stats, pill-style range presets, inline validation, and single primary action. Collapsible logs section. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-04 / Instruction context comprehensive data / Expand instruction chip content with instruction-only fields (client ID/type, consent, internal status, ID type, contact, DOB, nationality, notes) and remove pitch-derived data. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-04 / Instruction context rich layout / Redesign instruction chip content panel with header badges (status, ref, passcode, matter), key info strip (client, area, fee earner, stage, amount, matter), and service description section. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-04 / Data ops unified range + auto validation / Default data operations to custom ranges with presets, auto-run validation on operation selection, and add custom-range WIP sync support. (~ src/tabs/Reporting/DataCentre.tsx, ~ server/routes/dataOperations.js)
2026-02-04 / Enquiry timeline active pill colours / Keep status colours for text/icon/tick when a stage pill is selected. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline active pill ticks / Keep completion and issue icons visible when a stage pill is selected. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline connector lighting / Only light connectors when both adjacent stages are complete. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline instruction pill idle style / Match inactive pill styling when no instruction activity exists. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline instruction pill label / Show “Instruction” until there is actual instruction activity. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline instructed pill gating / Prevent pitched-only deals from showing Instructed as current unless an instruction exists. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-03 / Timeline icon palette standardised / Shift filter chips and timeline/ledger type icons to a refined monochrome palette. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-03 / Case selector card redesign / Promote case chips into prominent header sub-cards with stronger emphasis and active state treatment. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-03 / Timeline stage entries split / Split pitch into a stage summary entry plus separate outbound email activity, hide inline workbench blocks in timeline cards, strip any embedded workbench markup from email HTML, and ensure stage items render even when dates are missing. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-03 / Workbench lookup fallback / Resolve workbench pipeline data by enquiry ACID or fallback ProspectId/ID when ACID missing. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-03 / Stage entry enrichment / Expand stage metadata and render comprehensive data bars for enquiry, pitch, instruction, ID, payment, risk, and matter entries. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-03 / dataOpsLog schema design / Design persistent SQL table for data operations audit log with support for multi-source sync, bidirectional operations, and job correlation. Add migration script and lean documentation. (+ tools/db/create-dataopslog-table.mjs, ~ .github/instructions/DATABASE_SCHEMA_REFERENCE.md)
2026-02-03 / Data Hub custom sync controls / Add custom sync action selection (delete/insert), abort support, no-data handling, and tighter date picker styling. (~ server/routes/dataOperations.js, ~ server/utils/sqlHelpers.js, ~ server/index.js, ~ src/tabs/Reporting/DataCentre.tsx)
2026-02-03 / SQL VNET fallback / Prefer SQL_CONNECTION_STRING_VNET when core connection is missing or redacted. (~ server/index.js)
2026-02-03 / Data ops manual gating / Disable data operations scheduler unless explicitly enabled, plus refined date picker styling. (~ server/utils/dataOperationsScheduler.js, ~ src/tabs/Reporting/DataCentre.tsx)
2026-02-03 / Data Hub rebranding / Rename "Data Centre" to "Data Hub" and move entry point to primary action area for better visibility. (~ src/tabs/Reporting/ReportingHome.tsx, ~ src/tabs/Reporting/DataCentre.tsx)
2026-02-03 / Data operations scheduler offset / Offset scheduler by 3 minutes (xx:03) to avoid race conditions with existing 30-minute infrastructure. (~ server/utils/dataOperationsScheduler.js)
2026-02-03 / Data operations scheduling / Add server-side collected-time schedules (30m daily + 23:00 rolling), live processing log, and richer progress logging for App Insights. (~ server/utils/dataOperationsScheduler.js, ~ server/routes/dataOperations.js, ~ src/tabs/Reporting/DataCentre.tsx, ~ server/index.js)
2026-02-03 / Data centre streamlining / Remove redundant All feeds section now that grouped feeds cover the same data. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-03 / Data centre data previews / Add per-dataset data preview buttons (incl. core + instructions tables), clarify collected/recorded fills, and expand preview endpoint table coverage. (~ src/tabs/Reporting/DataCentre.tsx, ~ server/routes/dataOperations.js)
2026-02-03 / Prospects pitch data fetch / InlineWorkbench now fetches pitch content from /api/pitches when pitch context is activated, showing loading and empty states. Uses effectivePitch to merge item data with fetched content. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-03 / Prospects pitch chip redesign / Pitch context in InlineWorkbench now shows rich enquiry-style layout with header (Pitched badge + time + passcode), key info strip (Area, Pitched By, Amount, Service, Client), and pitch content preview. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-03 / Data centre expansion / Promote Data centre chip, route refresh to it, and add live inspection view with dataset status and manual refresh actions. (~ src/tabs/Reporting/ReportingHome.tsx, + src/tabs/Reporting/DataCentre.tsx)
2026-02-03 / Collected compare tool / Add Clio vs Hub collected comparison helper with SQL-only option. (+ tools/db/compare-collected.mjs)
2026-02-03 / WIP non-chargeable flag / Add dashboard note that WIP includes non-chargeable time. (~ src/tabs/Reporting/ManagementDashboard.tsx)
2026-02-03 / DB table lookup range mode / Add date-range lookups to the Core Data table tool. (~ tools/db/table-lookup.mjs)
2026-02-03 / DB table lookup tool / Add generic Core Data lookup script for schema and record inspection. (+ tools/db/table-lookup.mjs)
2026-02-02 / Teams link widget alignment / Align Teams widget deep link build with server-style encoding and open links via Teams when available. (~ src/components/TeamsLinkWidget.tsx)
2026-02-02 / Enrichment retry cooldown / Allow visible enquiries with empty enrichment to retry after a short cooldown instead of staying permanently empty after a failure. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-02 / Pipeline chips status alignment / Pipeline chips now derive status from inline workbench logic (EID, payments, risk, matter, docs) with processing/neutral support. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-02 / Pipeline chips restyled / Connected pill pipeline chips with workbench-aligned status colours. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-02 / Timeline view toggle clarity / Switched to a segmented Cards/Ledger control to match filter banner style. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-02 / Timeline default collapsed / Timeline now starts collapsed by day on initial load. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-02 / Timeline header filters clarified / Merged activity filters into the timeline header (second row) with clearer labels and counts. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-02 / Timeline density toggle removal / Removed compact view toggle; timeline uses comfortable spacing only. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-02 / Timeline filter banner relocation / Moved the timeline activity filter banner to be the timeline header in main content. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-02 / Timeline filter banner consolidation / Moved jump/navigation + density controls into the timeline filter header and removed the old filter banner. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-31 / Unified command bar workbench integration / Moved workbench from separate card into the unified command bar as TIER 5 (Integrated Workbench). Collapsible section with status pills when collapsed (instruction status, risk level, matter status). Eliminates duplication between pipeline bar and workbench. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-31 / Timeline filter UX simplification / Changed pitch chip click behavior: now scrolls directly to the first pitch item in timeline instead of showing a separate "Filtered View" section. Filters now only show the Quick Access section when user manually toggles them. Timeline card mode now also respects activeFilters. Removes duplication between workbench and filtered view. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-31 / Enquiry pipeline + hover UX / Extended pipeline bar to full 7 stages (Enq→Pitch→Inst→ID→Pay→Risk→Matter) with status-aware styling. Added comprehensive Apple/MS-style hover effects: pipeline stages scale+glow, action buttons lift+shadow, timeline cards slide, icon buttons scale+press, activity filters highlight. Smooth cubic-bezier transitions throughout. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-31 / NetDocuments search + metadata display / Enhance search results and folder contents UI with extension, modified date, modified by. Increase results limit to 20 with richer layout. (~ src/components/ResourcesModal.tsx)
2026-01-31 / NetDocuments v1/v2 API routes / Add workspace-contents and folder-contents routes using v1 Workspace + v2 container sub endpoints with proper metadata. (~ server/routes/resources-core.js, ~ src/components/ResourcesModal.tsx)
2026-01-31 / NetDocuments browser rework / Replace scattered NetDocuments cards with unified hierarchical browser: workspace lookup → breadcrumb folder navigation → scoped search. Remove broken sub-containers call. (~ src/components/ResourcesModal.tsx)
2026-01-31 / Home metrics count-up stabilisation / Stop TimeMetricsV2 cards remounting on refresh to prevent repeat count-up animations. (~ src/components/modern/TimeMetricsV2.tsx)
2026-01-31 / Metrics animation storage fallback / Disable count-up when sessionStorage is unavailable to avoid repeated animations. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-01-31 / Enquiry comparison ranges / Align previous week/month comparisons to same elapsed days and avoid local recalculation in production. (~ server/routes/home-enquiries.js, ~ src/tabs/home/Home.tsx)
2026-01-31 / Enquiry metric diagnostics / Expand conversion/enquiry details modal with underlying values and comparison windows; add user switch recalculation cue. (~ src/components/modern/EnquiryMetricsV2.tsx, ~ src/tabs/home/Home.tsx, ~ src/app/App.tsx)
2026-01-31 / Enquiry records inspection / Add home-enquiries details endpoint and surface raw records in the metrics details modal. (~ server/routes/home-enquiries.js, ~ src/components/modern/EnquiryMetricsV2.tsx, ~ src/components/modern/TimeMetricsV2.tsx, ~ src/tabs/home/Home.tsx)
2026-01-31 / Enquiry details simplification / Show only underlying records in the metrics details modal for validation. (~ src/components/modern/EnquiryMetricsV2.tsx)
2026-01-31 / Enquiry metrics scope / Remove team inbox from user-scoped home enquiry metrics and records. (~ server/routes/home-enquiries.js)
2026-01-31 / Home enquiries LZ override / Route LZ home enquiry metrics to AC to match demo expectation. (~ server/routes/home-enquiries.js)
2026-01-31 / Metrics skeleton refinement / Keep cards visible while only animating data placeholders during loading. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-01-31 / Resources NetDocuments workbench / Expand NetDocuments operations (user, containers, sub-containers, documents, search) with carry-over inputs. (~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-31 / Resource workbench dark mode / Apply on-brand dark button styling in resource workbench. (~ src/components/ResourcesModal.tsx)
2026-01-31 / Resources chip workbench panel / Open resource chips in a dedicated BespokePanel page instead of inline sections. (~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-31 / Resources workbench overlay z-index / Ensure resource panel opens above the resources modal layer. (~ src/app/functionality/BespokePanel.tsx, ~ src/components/ResourcesModal.tsx)
2026-01-31 / Enquiry case windows / Add enquiry case index and scope timeline/quick access to the active enquiry window. (~ src/tabs/enquiries/EnquiryTimeline.tsx, ~ src/tabs/enquiries/Enquiries.tsx)
2026-01-31 / Demo prospect cases / Demo mode now seeds multiple enquiries for the same prospect so case windows are visible. (~ src/components/UserBubble.tsx, ~ src/tabs/enquiries/Enquiries.tsx)
2026-01-31 / Demo timeline items / Inject demo emails, calls, pitches and documents for demo enquiries in timeline view. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-31 / Demo mode overlay + workbench / Replace demo toast with in-context overlay and seed tabbed workbench data for demo enquiries. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-31 / Prod view hides demo actions / Suppress Resources & Actions when View as Production is enabled. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-31 / Resources NetDocuments lookup / Add NetDocuments workspace lookup operation (Key Vault-backed) in Resources panel. (~ server/routes/resources-core.js, ~ src/tabs/resources/Resources.tsx)
2026-01-31 / NetDocuments auth alignment / Use nd-authurl + Basic auth + scope when fetching NetDocuments access tokens. (~ server/routes/resources-core.js)
2026-01-31 / NetDocuments auth client_id / Build OAuth client_id with repository suffix and default scope full. (~ server/routes/resources-core.js)
2026-01-31 / Resource ops cue / Add subtle ops badge on resource chips with operations. (~ src/tabs/resources/ResourceCard.tsx, ~ src/components/ResourcesModal.tsx)
2026-01-30 / Enquiry timeline workbench context chips / Re-enable enquiry/pitch context chips in timeline + quick access inline workbench for pitch cards. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-30 / Enquiry timeline pitch lookup fix / Fetch pitch content by prospect/acid so timeline shows pitch email instead of checkout-link fallback. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-30 / Resources Asana task lookup / Add Asana task lookup by ID under the Asana resource panel, with a server route to fetch task details. (~ server/routes/resources-core.js, ~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx, ~ logs/changelog.md)
2026-01-30 / Resources Asana lookup identity / Fall back to cached user data for Asana credentials when Teams context is unavailable. (~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-30 / Resources Asana lookup initials / Allow manual initials entry for Asana task lookup when identity is missing. (~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-30 / Resources Asana lookup user data / Use current app user data to resolve Asana credentials (no manual initials required). (~ src/app/App.tsx, ~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx, ~ src/components/ResourcesSidebar.tsx)
2026-01-30 / Resources Asana structure lookups / Add Asana team, user, project, and section lookup operations with dependent selection. (~ server/routes/resources-core.js, ~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-30 / Resources Asana silos UI / Redesign the Asana operations panel and load section tasks for the selected project. (~ server/routes/resources-core.js, ~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-30 / Resources Asana ops selector / Add operation picker, full team user list, gated project selection, and board-style task columns. (~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-30 / Azure box get-user action / Route “Get user” through /api/resources/analytics/graph-user using Key Vault client credentials. (~ server/routes/resources-analytics.js, ~ server/index.js, ~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-30 / Resources Clio lookups / Add Clio contact + matter lookup tools under the Clio resource panel. (~ server/routes/resources-core.js, ~ server/index.js, ~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-30 / Resources modal action panel / Show an on-brand in-app action panel when selecting a resource, instead of navigating to a blank page. (~ src/components/ResourcesModal.tsx)
2026-01-30 / Resources Teams link open / Use Teams `app.openLink` for resource opens to avoid blank pages in Teams webview. (~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-30 / Resources open-link fallback / Add pop-up blocked fallback (navigate current tab) for resource opens, fixing Azure clicks in Teams. (~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-30 / Resources local operations panel / Clicking a resource now reveals an inline operations section (open/copy/pin) within the Resources tab. (~ src/tabs/resources/Resources.tsx)
2026-01-30 / Matters user switching cue / Show an in-context “Switching user…” overlay in Matters while data reloads (prevents void feeling on slow switches). (~ src/index.tsx, ~ src/tabs/matters/Matters.tsx)
2026-01-30 / Immediate actions empty-state collapse / Auto-collapse the “All caught up” card shortly after it appears with a smooth transition. (~ src/tabs/home/ImmediateActionsBar.tsx)
2026-01-30 / Teams tab scrolling / Added a dedicated scroll region so tab content can scroll inside Teams without locking the app shell. (~ src/app/App.tsx, ~ src/app/styles/index.css)
2026-01-30 / Instant lookup person name matching / Fix single-token surname searches (e.g. “Bedwell”) to match against last name too; prefer exact full-name matches without dropping near matches. (~ tools/instant-lookup.mjs)
2026-01-30 / Agent lookup guidance / Clarify that pipeline requests must use `instant-lookup pipeline` (not `person`) to reliably resolve legacy-space enquiries. (~ .github/copilot-instructions.md)
2026-01-30 / Lookup flow: drop default --plan / Make `--plan` optional (only when requested) so lookups can be chat-confirmed then executed directly. (~ .github/copilot-instructions.md)
2026-01-29 / AML review report (12 months) / Added scripts/amlReview12Months.mjs to produce a pasteable summary of non-UK ties (POID) and PEP warning counts (IDVerifications + periodic-compliance), with Key Vault-backed SQL connection fallback. (+ scripts/amlReview12Months.mjs)
2026-01-29 / Annual leave auto-book for AC/JW / For Alex (AC) and Jonathan (JW), new annual leave requests now skip approval/booking and are inserted as booked; booked entries create Clio+Outlook calendar events immediately, and approval updates coerce to booked. (~ server/routes/attendance.js, ~ src/CustomForms/AnnualLeaveForm.tsx)
2026-01-29 / Matters tab production rollout / Enabled Matters tab in production for Luke/Alex/Cass only, with a subtle in-tab Production indicator for those users. (~ src/app/admin.ts, ~ src/app/App.tsx, ~ src/tabs/matters/Matters.tsx)
2026-01-29 / AML report runbook / Added a runbook documenting how the AML 12-month report is produced, including data sources, windowing, PEP classification, and coverage gaps. (+ docs/AML_REVIEW_12_MONTH_REPORT_RUNBOOK.md)
2026-01-29 / Non-billable time report / Added scripts/reportNonBillableTime.mjs to report month-to-date non-billable hours per active fee earner using the same Clio activity flags as matter metrics. (+ scripts/reportNonBillableTime.mjs)
2026-01-29 / Non-billable report runbook / Added a runbook documenting how the Clio non-billable report is produced, including prerequisites, logic, and troubleshooting. (+ docs/NON_BILLABLE_CLIO_REPORT_RUNBOOK.md)
2026-01-28 / Instant lookup pipeline lookup / Added pipeline mode to return full pipeline data from any key (enquiry/pitch/instruction/matter). (~ tools/instant-lookup.mjs, ~ .github/copilot-instructions.md)
2026-01-28 / Instant lookup pipeline legacy fix / Removed invalid Matter_Ref selection from legacy enquiries to restore name lookups. (~ tools/instant-lookup.mjs)
2026-01-28 / Instant lookup legacy columns / Remove invalid Area_of_Work selection from legacy enquiries for pipeline name lookups. (~ tools/instant-lookup.mjs)
2026-01-28 / Instant lookup legacy payloads / Switch legacy pipeline lookups to SELECT * for full enquiry payloads. (~ tools/instant-lookup.mjs)
2026-01-28 / Instant lookup flexible legacy search / Build schema-aware name/email/phone/ID filters for legacy/new enquiries in pipeline lookups. (~ tools/instant-lookup.mjs)
2026-01-28 / Instant lookup full-name matching / Add full-name column and first+last concatenation matching for pipeline lookups. (~ tools/instant-lookup.mjs)
2026-01-28 / Instant lookup person schema guard / Use schema-aware filters for person lookups to avoid missing-column errors. (~ tools/instant-lookup.mjs)
2026-01-28 / Instant lookup new enquiries guard / Use schema-aware ID/email columns for new-space enquiries in pipeline lookups. (~ tools/instant-lookup.mjs)
2026-01-29 / Instant lookup column normalisation / Resolve column names case/format-insensitively to prevent invalid-column errors in name matching. (~ tools/instant-lookup.mjs)
2026-01-29 / Instant lookup instruction email guard / Use schema-aware email columns for Instructions lookup to avoid invalid ClientEmail errors. (~ tools/instant-lookup.mjs)
2026-01-29 / Instant lookup full-name filter / When a full name is provided, filter legacy/new enquiries to exact full-name matches before building pipeline keys. (~ tools/instant-lookup.mjs)
2026-01-29 / Instant lookup strict full-name / Use strict full-name matching (first+last AND/concat) for person/pipeline name lookups. (~ tools/instant-lookup.mjs)
2026-01-28 / Instant lookup plan mode / Added --plan to preview operations without executing; documented chat-first confirmation. (~ tools/instant-lookup.mjs, ~ .github/copilot-instructions.md)
2026-01-28 / Instant lookup confirm-first mode / Added --confirm to show the intended operation and require explicit yes before running. (~ tools/instant-lookup.mjs, ~ .github/copilot-instructions.md)
2026-01-28 / Instant lookup person simplification / Person lookups now return enquiries only (legacy + new) and skip deals/instructions joins. (~ tools/instant-lookup.mjs)
2026-01-28 / Instant lookup Key Vault resilience / Auto-resolve SQL connection strings via Key Vault with a fast timeout for instant lookups; document behaviour. (~ tools/instant-lookup.mjs, ~ .github/copilot-instructions.md)
2026-01-28 / Root cleanup: remove dead placeholders / Deleted empty placeholders and orphaned JSON files. (- server/utils/connectionManager.js, - api/update-enquiry.js, - api/deploy.sh, - api/.funcignore, - server/routes/aiden.json, - server/routes/x.json)
2026-01-28 / Root cleanup: remove build artefacts / Removed ignored build outputs from root and appPackage to keep repo clean. (- build/, - appPackage/build/)
2026-01-28 / Root cleanup: remove unused CRA override / Removed legacy CRA override file now unused after the CRACO switch. (- config-overrides.js)
2026-01-28 / Key Vault SQL fallback / Resolve SQL connection strings from Key Vault when env values are missing or redacted, before warming SQL pools. (~ server/index.js)
2026-01-28 / Fluent UI webpack resolution fix / Route CRA builds through CRACO and allow extensionless ESM imports to fix @fluentui/react module resolution errors. (+ craco.config.js, ~ package.json)
2026-01-28 / Database folder cleanup / Removed redundant attendance schema snapshot and rate update note; migrations removed by request (use live schema + changelog). (~ database/attendance-schema.sql, ~ database/migrations/010_2025_rate_update.md, ~ database/migrations/*, ~ .github/instructions/TEAM_DATA_REFERENCE.md)
2026-01-28 / Docs consolidation references / Added consolidated docs (PLATFORM_OPERATIONS, INSTRUCTIONS_REFERENCE, ENQUIRIES_REFERENCE, DOCUMENTS_REFERENCE, EMAIL_REFERENCE, INTEGRATIONS_REFERENCE, AZURE_OPERATIONS) and updated instructions/README links; added product guardrails + roadmap item. (~ docs/*.md, ~ .github/copilot-instructions.md, ~ .github/instructions/ROADMAP.md, ~ .github/instructions/ARCHITECTURE_DATA_FLOW.md, ~ .github/instructions/ENQUIRIES_TABLE_DESIGN_PATTERN.md, ~ README.md, ~ server/utils/logger.js, ~ server/routes/logs-stream.js)
2026-01-28 / Docs consolidation deletions / Removed consolidated legacy docs now covered by new reference files. (~ docs/*.md)
2026-01-28 / Remove one-off lookup scripts / Deleted temporary SQL/Clio lookup scripts and documented no-commit guidance. (~ scripts/dry-run-delete-test-matters.mjs, ~ scripts/dry-run-delete-specific-matters.mjs, ~ scripts/delete-specific-matters.mjs, ~ scripts/find-clio-contacts-for-matters.mjs, ~ .github/instructions/DATABASE_SCHEMA_REFERENCE.md)
2026-01-28 / Remove hardcoded credential scripts / Deleted ad-hoc scripts containing hardcoded SQL credentials. (~ scripts/queryEnquiry.mjs, ~ scripts/check-join.mjs, ~ scripts/cleanup-teresa-test.mjs, ~ scripts/check_prod_scenarios.py)
2026-01-28 / Secret redaction sweep / Removed hardcoded credentials and client-specific scripts; redacted passwords from env/docs; converted analysis scripts to use SQL_CONNECTION_STRING. (~ scripts/queryEnquiry.mjs, ~ scripts/check-join.mjs, ~ scripts/check-matter-refs.mjs, ~ scripts/fix-teresa-deal.mjs, ~ scripts/fix-teresa-prospectid.mjs, ~ scripts/verify-teresa-deal.mjs, ~ scripts/dry-run-delete-test-matters.mjs, ~ scripts/dry-run-delete-specific-matters.mjs, ~ scripts/delete-specific-matters.mjs, ~ scripts/find-clio-contacts-for-matters.mjs, ~ scripts/feeAnalysisDetailed.mjs, ~ scripts/rollingAvgFeePerMatter.mjs, ~ scripts/truePerMatterAvg.mjs, ~ .env, ~ env/.env.dev, ~ prod-settings.txt, ~ docs/SECURITY_FIX_CHECKLIST.md, ~ docs/INSTRUCT_PITCH_PENDING_CHANGES.md)
2026-01-28 / Tools migration + scripts exclusion / Moved reusable ops scripts to tools/ and excluded scripts/ from git; updated agent instructions and lookup guidance. (~ tools/sync-context.mjs, ~ tools/session-start.mjs, ~ tools/update-submodules.mjs, ~ tools/validate-instructions.mjs, ~ tools/instant-lookup.mjs, ~ .github/copilot-instructions.md, ~ .github/instructions/DATABASE_SCHEMA_REFERENCE.md, ~ .gitignore)
2026-01-28 / Docs cleanup / Removed one-off analyses, fix summaries, and non-doc artefacts; moved Key Vault setup script to tools. (~ docs/*, ~ tools/setup-keyvault-secrets.ps1, ~ docs/SECURITY_FIX_CHECKLIST.md)
2026-01-28 / Docs audit continuation / Consolidated Azure/email references and removed legacy UI/design docs to reduce noise. (~ docs/AZURE_CONFIG_REFERENCE.md, ~ docs/EMAIL_SYSTEM_QUICK_REFERENCE.md, ~ docs/MAINTENANCE_GUIDELINES.md, ~ docs/*)
2026-01-28 / Matter pipeline typing fix / Resolve circular memo typing errors after adding enquiry matching fallbacks. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-28 / Matter pipeline enquiry matching / Add instruction-ref + email/name fallbacks so Origin & Pipeline notes resolve when prospect IDs don’t align. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-28 / Matter pipeline ID parsing / Broaden instruction ref parsing so non-HLX refs still resolve prospect IDs for enquiry notes. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-28 / Matter enquiry notes sync / Inject enquiry data into pipeline workbench so notes/value appear for new vs legacy enquiries. (~ src/app/App.tsx, ~ src/tabs/matters/Matters.tsx, ~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-28 / Matter pipeline prospect ID source / Prefer deal ProspectId over instructionRef parsing when matching enquiries for workbench notes. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-28 / Matter enquiry match normalisation / Normalise enquiry keys (including ProspectId) for more reliable workbench note linking. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-28 / Matter enquiry match schema alignment / Match workbench enquiries by legacy ID or new acid only. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-28 / Matters enquiry dataset reuse / Reuse unified team-wide enquiries from Prospects (All) instead of re-fetching for Matters. (~ src/app/App.tsx, ~ src/tabs/enquiries/Enquiries.tsx)
2026-01-28 / Matters targeted enquiry fetch / Fetch single enquiry by prospectId when opening workbench to avoid full dataset load. (~ src/tabs/matters/MatterOverview.tsx, ~ server/routes/enquiries-unified.js)
2026-01-28 / Test matter cleanup dry run / Added dry-run script to preview SQL+Clio deletions for TEST/BENNE matters. (~ scripts/dry-run-delete-test-matters.mjs)
2026-01-28 / Agent DB query guidance / Documented ESM-safe mssql import for terminal scripts. (~ .github/copilot-instructions.md, ~ .github/instructions/DATABASE_SCHEMA_REFERENCE.md)
2026-01-28 / Enquiries linkage clarity / Documented legacy vs new enquiries and ProspectId→acid linkage order. (~ .github/instructions/DATABASE_SCHEMA_REFERENCE.md)
2026-01-28 / Workbench enquiry detail focus / Remove the unified origin summary strip and expand enquiry detail fallbacks/notes visibility. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-28 / Matter detail tabs gating / Disable Activities, Documents, Comms, and Billing tabs in production with a hover hint. (~ src/tabs/matters/Matters.tsx)
2026-01-28 / Matter quick info tone / Soften Quick Info value text to match the email/phone tone. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-28 / Matter client detail tone / Soften client detail value text to match the email/phone tone in the client box. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-28 / Matter WIP alignment / Exclude billed/on-bill activities so WIP matches Clio, while keeping total hours across all activities. (~ server/routes/matter-metrics.js)
2026-01-27 / Inline workbench clarity pass / Add summary strip, increase padding, and space sections for a clearer, more purposeful inline workbench. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-27 / Toast label clipping fix / Increase toast title/message line-height and padding to prevent cropped labels. (~ src/components/feedback/ToastProvider.tsx)
2026-01-27 / Clio token retry hardening / Retry Clio calls on 401 and fall back when open_date fields are rejected during matter audit. (~ server/routes/matter-metrics.js, ~ server/routes/matter-audit.js)
2026-01-26 / Matters metrics pending handling / Resolve Clio IDs via instructions DB and return pending status when matters are not yet created, avoiding hard errors for placeholders. (~ server/routes/matter-metrics.js, ~ src/tabs/matters/Matters.tsx, ~ src/tabs/matters/MatterOverview.tsx)
2026-01-27 / Matters client details linkage / Normalise InstructionRef variants and canonicalise missing HLX prefix so pipeline client details reliably show. (~ src/utils/matterNormalization.ts, ~ src/tabs/matters/MatterOverview.tsx)
2026-01-27 / Matters request clarity / Add placeholder hint and label Request ID when the record is a MatterRequest without an Instruction link. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-27 / Matter request patching / Store matter request id, capture Clio display number, and patch placeholder matter rows after instruction sync completes. (~ server/routes/matterRequests.js, ~ src/tabs/instructions/MatterOpening/processingActions.ts)
2026-01-27 / Matter sync audit mode / Add Clio sync audit endpoint and UI toggle for new matters, showing mismatch cues for key fields. (+ server/routes/matter-audit.js, ~ server/index.js, ~ server/server.js, ~ src/tabs/matters/Matters.tsx, ~ src/tabs/matters/MatterOverview.tsx)
2026-01-27 / Matter id backfill script / Add one-off backfill script to repair new-space placeholder MatterRequest IDs using Instructions.MatterId and optional Clio display numbers. (+ scripts/backfill-new-matter-ids.js)
2026-01-27 / Matter header alignment / Prefer workbench display number + client name in the header and show real matter id with separate request id when present. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-27 / Matter opening modal labels / Add line-height and padding to prevent confirmation modal titles clipping. (~ src/tabs/instructions/MatterOpening/IdentityConfirmationCard.tsx, ~ src/tabs/instructions/MatterOpening/ConflictConfirmationCard.tsx)
2026-01-26 / Matters metrics loading / Add per-matter metrics routes (WIP + client funds), parallel client fetches with toasts, and per-card loading skeletons. (~ server/routes/matter-metrics.js, ~ server/index.js, ~ src/tabs/matters/Matters.tsx, ~ src/tabs/matters/MatterOverview.tsx)
2026-01-26 / Matters details expansion / Add instruction, source/referrer, value, opponent solicitor, method, rating, and original status fields to Matter Details. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-26 / Matters client copy chips / Remove client avatar and add copy chips for email/phone in the client sidebar. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-26 / Matters details + team merge / Merge Team into Matter Details and switch detail rows to a two-column grid layout. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-26 / Matters client sidebar enrichment / Clean up contact layout, add personal + company details from pipeline data, and switch avatar for company clients. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-26 / Matters data source chip / Add legacy/all/new-only toggle state so admins can isolate new matters. (~ src/tabs/matters/Matters.tsx)
2026-01-26 / Matters detail tabs in banner / Move matter detail Pivot tabs into the sticky banner row alongside Back (Enquiries-style). (~ src/tabs/matters/Matters.tsx, ~ src/tabs/matters/MatterOverview.tsx)
2026-01-26 / Matters detail skeleton + entry / Add a quick skeleton placeholder and subtle entry animation on matter click-through to avoid blank/void loading states. (~ src/tabs/matters/Matters.tsx, ~ src/tabs/matters/MatterOverview.tsx)
2026-01-26 / Matters actions column / Add call+email buttons to table rows (no unlock/edit/delete yet). (~ src/tabs/matters/MatterTableView.tsx)
2026-01-26 / Rate change admin gating / Make Clio->SQL sync and CCL Date write operations admin-only (UI + server-side initials gate). (~ src/tabs/home/RateChangeModal.tsx, ~ server/routes/rate-changes.js, ~ server/routes/ccl-date.js)
2026-01-26 / Matters detail brand pass / Flatten Matter detail surfaces (smaller radii, calmer hover), sharpen skeletons, and add localhost-only wiring hint for backend metrics. (~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/matters/Matters.tsx)
2026-01-26 / Matters pipeline groundwork / Add an Origin & Pipeline section in matter detail with instruction/prospect linkage and placeholder pipeline status chips. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-26 / Matters workbench mirror / Embed read-only InlineWorkbench in matter detail with derived pipeline payload (pending real pipeline feed). (~ src/tabs/matters/MatterOverview.tsx)
2026-01-26 / Matters pipeline consolidation / Remove separate Origin & Pipeline panel and rename workbench section to Origin & Pipeline. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-25 / Matters table timeline alignment / Add timeline header icon and shift row icon to respect the timeline gutter. (~ src/tabs/matters/MatterTableView.tsx)
2026-01-23 / Enquiries pipeline resize / Re-measure pipeline columns on tab focus/visibility to fix Teams embedded view. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-23 / Pitch costs wording / Restore original costs paragraph with explicit role rates in pitch scenario. (~ src/tabs/enquiries/pitch-builder/scenarios.ts)
2026-01-23 / Pitch amount sync guard / Limit auto-sync to estimate/budget phrasing so rates are not overwritten. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-23 / VAT toggle emphasis / Strengthen No VAT (international) styling with an info-blue emphasis. (~ src/tabs/enquiries/pitch-builder/DealCapture.tsx)
2026-01-23 / Prospect notes header actions / Align notes actions with the Notes label in the section header. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-23 / Prospect notes whiteboard / Remove duplicate notes header and add a resizable temporary whiteboard panel with session-only copy. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-23 / Enquiries table name copy feedback / Swap name copy icons to success ticks with animated feedback in main + child rows. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-23 / Prospect header contact copy feedback / Swap email/phone copy icons to animated ticks with success styling when copied. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-23 / Pitch builder header actions / Fix copy fallback and refine copy/preview button states with press/hover feedback. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-23 / Pitch builder header actions / Move copy/preview into the email body title bar and redesign button states. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-23 / Pitch builder preview toggle / Move preview toggle into the email body title bar to avoid overlaying content. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-23 / Pitch builder focus border / Restore focus border on the email body container around the header/tools. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-23 / Pitch builder editor shell / Remove inner editor box styling for the email body text area. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-23 / Pitch builder body shell / Remove the outer pitch-step-card shell around the email body area. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-22 / Pitch builder scenario neutrality / Flatten scenario card corners and soften selection emphasis. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-22 / Prospect header animation guard / Prevent repeated entry animations in the Prospect & Enquiry header. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-22 / Pitch builder scenario tone / Inline pitch history text in step 1 and neutralise scenario card base styling. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-22 / Prospect header entry cascade / Add subtle content-reveal cascade on the Prospect & Enquiry header for smoother entry. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-22 / Pitch builder step 1 header / Show template step header on entry and move pitch history banner into step 1. (~ src/tabs/enquiries/PitchBuilder.tsx, ~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx, ~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx)
2026-01-22 / Prospect header skeletons / Add shimmer + cascade loading skeletons to the Prospect & Enquiry header sections. (~ src/tabs/enquiries/components/ProspectHeader.tsx, ~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx)
2026-01-22 / Custom tabs active style / Remove selected tab pane background so active state is underline-only. (~ src/app/styles/CustomTabs.css)
2026-01-22 / Pitch builder header banner / Flatten Prospect & Enquiry header into a banner with side breathing room and top/bottom separation. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-22 / Pitch builder quality polish / Sharpen step/card corners and add smoother transitions for the pitch builder flow. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-22 / Pitch builder steps containment / Contain wizard steps in compact cards for clearer, more professional grouping. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-22 / Pitch context banner tone / Switch Pitch Builder context banner to an informational blue style (less warning). (~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx)
2026-01-22 / Custom tabs active colour / Force highlight blue for active navigation tabs in light mode. (~ src/app/styles/CustomTabs.css)
2026-01-22 / Enquiries sub-tab accent colour / Force highlight blue for Overview/Pitch Builder tab accents in dark mode as well. (~ src/app/styles/CustomTabs.css)
2026-01-22 / Enquiries table open pitch builder / Table-view row click now opens the Pitch builder instead of landing on the overview/timeline by default. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-22 / Pitch builder sync feedback / Add single-flight amount sync with origin token and deduped toast feedback. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx)
2026-01-22 / Pitch builder amount live-sync / Simplified amount sync into a deterministic effect, added sync helper + tests to update the email body on every amount change. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx, ~ src/tabs/enquiries/pitch-builder/__tests__/syncAmountIntoBody.test.ts)
2026-01-22 / Dev dashboard health checks upgrade / Replace 3 hardcoded checks with a route registry + observed GET routes from Ops; add reachability semantics, last-checked timestamps, and optional auto-ping interval. (~ src/components/AdminDashboard.tsx)
2026-01-22 / Changelog modal readability / Rename “Release Notes” UI to “Changelog”, group entries by date, include descriptions, add search + collapsible days, and flag that curated Release Notes are planned. (~ src/components/ReleaseNotesModal.tsx, ~ src/components/UserBubble.tsx)
2026-01-22 / Ideas tab simplified / Removed over-detailed “requirements scaffolds”; keep ideas as lightweight flags with tags + short notes. (~ src/components/ReleaseNotesModal.tsx)
2026-01-22 / Financial forms: show submission errors / Financial form submit now surfaces API/network errors (and missing initials) in the UI instead of failing silently; button label shows “Submitting…”. (~ src/tabs/forms/FormDetails.tsx, ~ src/CustomForms/BespokeForms.tsx, ~ server/routes/financialTask.js)
2026-01-22 / Financial forms: Asana refresh resilience / Improve Asana token refresh to use form-encoded body, return structured errors with safe upstream details, and retry transient 5xx/429 so intermittent failures don’t look like “nothing happened”. (~ server/routes/financialTask.js)
2026-01-22 / Dev dashboard redesign / Rework Dev Dashboard into a purpose-built dev tooling portal: integrated Inspector section (embedded, no nested modal), real endpoint health checks, and upgraded Overview/Diagnostics. (~ src/components/AdminDashboard.tsx, ~ src/components/DataInspector.tsx)
2026-01-22 / Asana chip icon / Use Asana SVG icon for the Asana Integration chip in the user bubble. (~ src/components/UserBubble.tsx)
2026-01-22 / Dev dashboard consolidation / Rename Admin Dashboard to Dev Dashboard; remove separate Application Inspector menu entry and expose it from within the Dev Dashboard; drop prompt-based gating that could block opening in Teams. (~ src/components/UserBubble.tsx, ~ src/components/AdminDashboard.tsx)
2026-01-22 / Release notes modal / Add admin-only Release Notes modal (Release notes + Ideas tabs) opened from user bubble; serve changelog via backend endpoint instead of CRA dev proxy; remove dev-only session changes UI. (~ src/components/ReleaseNotesModal.tsx, ~ src/components/UserBubble.tsx, ~ src/app/styles/CustomTabs.tsx, ~ server/routes/release-notes.js, ~ server/index.js, ~ src/tabs/home/Home.tsx, ~ src/tabs/home/QuickActionsBar.tsx, ~ src/setupProxy.js)
2026-01-22 / Top files CSV export / Add script to export top 20 Commercial/Property matters (last 12 months) by opening value and by invoiced (net, Service-only by default; optional includeDisbursements) into 4 CSV files. (~ scripts/exportTopValueFiles.mjs, ~ package.json)
2026-01-21 / Enquiries instruction chip dates / Expand instruction date/time field fallbacks so claimed/all views show date+time instead of Inst. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-20 / Enquiries header/row alignment + carousel / Unify table header+row grid spacing and enforce minimum pipeline chip widths so the carousel triggers (no squishing); reset header carousel offset on tab/view switch. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-20 / Fix enquiries POC chip squish / Adjusted POC and claim chip min widths and centering styles in [src/tabs/enquiries/Enquiries.tsx](src/tabs/enquiries/Enquiries.tsx)
2026-01-20 / POC column alignment / Add box styling to Unclaimed POC header; center POC cell content (claim prompt, initials stack, legacy placeholder) under header without breaking internal 3-element alignment. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-20 / Unclaimed claim button fix / Treat team@helix-law.com and other inbox values as unclaimed; show subtle claim prompt instead of "Team" text; use isUnclaimedPoc helper consistently. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Unclaimed area filtering removed / Claimable (Unclaimed) tab now shows all enquiries regardless of user's profile Area of Work - users can still optionally filter by area using toggles. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Matter detail Clio-style redesign / Complete rewrite of MatterOverview with dark mode support, tabbed navigation, metric cards, team display, and client sidebar matching Clio Manage layout. (~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/matters/Matters.tsx)
2026-01-19 / Matters scope filters / Skip role filter for admin All scope so Mine/All counts diverge correctly. (~ src/tabs/matters/Matters.tsx)
2026-01-19 / Matters scope counts / Align Mine/All counts with admin detection so scope badges update correctly. (~ src/tabs/matters/Matters.tsx)
2026-01-19 / Matters table default / Make table view the only Matters view and default on entry. (~ src/tabs/matters/Matters.tsx)
2026-01-19 / Clients column sizing / Match Clients column widths to the Enquiries grid for consistent spacing. (~ src/tabs/instructions/InstructionTableView.tsx)
2026-01-19 / Clients column order / Reorder Clients table columns to match Enquiries (date, name, ID/value, AOW, pipeline). (~ src/tabs/instructions/InstructionTableView.tsx)
2026-01-19 / Clients actions gating / Hide the edit action until Actions is enabled. (~ src/tabs/instructions/InstructionTableView.tsx)
2026-01-19 / Clients day separators / Replace banner-style day headers with subtle separator lines to match Enquiries. (~ src/tabs/instructions/InstructionTableView.tsx)
2026-01-19 / Clients header hover layout / Shift client name on hover and reveal email in group headers to match Enquiries spacing. (~ src/tabs/instructions/InstructionTableView.tsx)
2026-01-19 / Clients pipeline connector alignment / Tighten instruction pipeline connectors so lines touch chip borders cleanly. (~ src/tabs/instructions/InstructionTableView.tsx)
2026-01-19 / Clients table hover details / Align Clients table detail reveal with Enquiries by showing email/value on row hover. (~ src/tabs/instructions/InstructionTableView.tsx)
2026-01-19 / Instructions search debounce / Debounce Clients/Instructions search input in the FilterBanner to keep typing responsive in large tabs. (~ src/components/filter/FilterBanner.tsx, ~ src/tabs/instructions/Instructions.tsx)
2026-01-19 / Enquiries unclaimed visibility / Treat null/empty/unassigned POC values as unclaimed in UI filtering/suppression. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Enquiries unclaimed visibility / Include null/empty POC values in Team Inbox filtering so new unclaimed records surface. (~ server/routes/enquiries-unified.js)
2026-01-19 / Enquiries pulse refresh / Add lightweight pulse endpoint + client polling to detect new enquiries from both sources. (~ server/routes/enquiries-unified.js, ~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Enquiries pipeline carousel fix / Prevent post-pitch chips from wrapping into a second row when the carousel is active. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Enquiries pipeline icons only / Remove status dots so pipeline chips rely on icons and colour. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Enquiries hover shift / Shift ID/name upward on hover and reveal stacked details without changing row height. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Matters timeline line offset / Shift accent line to avoid overlapping the matter icon column. (~ src/tabs/matters/MatterTableView.tsx)
2026-01-19 / Enquiries hover layout / Expand ID/email stacks only on hover so names stay centred at rest. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Matters table parity / Align day separators and group hover cues with the Enquiries table styling. (~ src/tabs/matters/MatterTableView.tsx)
2026-01-19 / Enquiries timeline accents / Increase timeline line prominence at rest and on hover for clearer AOW cues. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Enquiries row-hover details / Smooth row-hover reveal for email/value with subtle transitions. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Edit enquiry modal prompts clarity / Restyle access/error/success prompts to match InlineWorkbench status banners for clearer guidance. (~ src/tabs/enquiries/EditEnquiryModal.tsx)
2026-01-19 / Edit enquiry modal redesign / Refresh modal styling, spacing, and input treatments to match the new dark card layout. (~ src/tabs/enquiries/EditEnquiryModal.tsx)
2026-01-19 / Enquiries timeline line AOW colour / Colour the left timeline line per Area of Work. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Enquiries hover details / Hide email/value until day group hover to reduce table noise. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Enquiries day separators softened / Replace banner separators with subtle fading lines and extra whitespace. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Enquiries table layout simplified / Move prospect to the first column and rebalance ID/AOW/Date order for clarity. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Matters table headers sortable / Add header sorting with date grouping only on Opened. (~ src/tabs/matters/MatterTableView.tsx)
2026-01-19 / Matters legacy data restored / Use unified matters fetch in local dev so legacy/all records are included. (~ src/index.tsx)
2026-01-19 / Matters table aligned to prospects/clients / Match Matters table container + header styling to the Prospects/Clients tables. (~ src/tabs/matters/MatterTableView.tsx)
2026-01-19 / Matters source toggle removed / Show all sources by default and drop legacy/new toggle. (~ src/tabs/matters/Matters.tsx)
2026-01-19 / Matters filter icons + order / Make Mine/All first and add iconed Open/Archived + Responsible/Originating toggles. (~ src/tabs/matters/Matters.tsx)
2026-01-19 / Admin filter cues / Add subtle admin-only rings for Matters dataset toggle and Enquiries Triaged filter. (~ src/tabs/matters/Matters.tsx, ~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Matters initials matching / Match solicitor initials to full names so matters role detection doesn’t drop all records. (~ src/utils/matterNormalization.ts)
2026-01-19 / Conversion metric animation redo / Replace conversion metric count-ups with one-time animated values to stop retriggers on first entry/toggle. (~ src/components/modern/EnquiryMetricsV2.tsx)
2026-01-19 / Home metric animation redo / Replace the home metric count-up with a one-time animated number to stop repeat retriggers on first entry. (~ src/tabs/home/MetricCard.tsx)
2026-01-19 / Home time metrics load timeout / Add a 12s WIP fetch timeout and clear loading state if the home-wip request stalls, preventing infinite loading on first entry. (~ src/tabs/home/Home.tsx)
2026-01-18 / Timeline pitch fallback from enrichment / When no pitches found by enquiry ID, fall back to email-based enrichment data so deals show in workbench. (~ src/tabs/enquiries/EnquiryTimeline.tsx, ~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries payment chip shows pending color / Payment chip now shows orange/blue for pending payments instead of neutral grey. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries eager enrichment prefetch / Fire parallel micro-batches on initial load so hover data is ready before user even scrolls. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries enrichment prioritise speed / Increase batch size, remove debounce, and prefetch farther ahead for faster pipeline updates. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries pipeline pulse unified / Use a single smooth pulse animation for pitch/ID cue dots to keep timing consistent. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries payment icon uses GBP / Replace money stack icon with CurrencyPound in payment pipeline stages to keep the cue visible. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries pipeline hover cleanup / Auto-hide stuck pipeline hover tooltip on mouse move off chips, scroll, or window blur. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries pipeline placeholder shows instruction / Align loading placeholder pipeline icons with actual stages so Inst appears while processing. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries pipeline uses ACID for workbench / Resolve inline workbench lookup by ACID/prospect ID so enquiry pipeline reflects instruction-linked stages. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Prospect overview selection prefers instruction / Resolve selected overview item by InstructionRef/DealId/ProspectId to align deal clicks with instruction-linked workbench data. (~ src/tabs/instructions/Instructions.tsx)
2026-01-17 / Tech tickets Asana auth + ledger refresh / Use Key Vault + team table Asana credentials for tech tickets and redesign the ledger rows with clearer status chips, readable text, and edit/delete actions. (~ server/routes/techTickets.js, ~ src/CustomForms/shared/TechTicketsLedger.tsx)
2026-01-17 / Tech tickets Asana fixes / Remove workspace ID from task creation and store submitter initials to avoid SQL truncation. (~ server/routes/techTickets.js)
2026-01-17 / Annual leave day selection date compare / Use date-only comparisons for selectable days to prevent time-of-day blocking and zero-day counts. (~ src/CustomForms/AnnualLeaveModal.tsx)
2026-01-17 / Annual leave modal fallback fetch / Modal now self-fetches leave data when Home props are empty to avoid blank history. (~ src/CustomForms/AnnualLeaveModal.tsx)
2026-01-17 / Annual leave timestamps / Added request/approval/booking timestamps with schema migration and history display. (~ server/routes/attendance.js, ~ database/migrations/013_annual_leave_timestamps.sql, ~ src/CustomForms/AnnualLeaveModal.tsx, ~ src/tabs/home/Home.tsx, ~ src/app/functionality/types.ts)
2026-01-17 / Annual leave bulk update / Added multi-select and bulk status/days updates for leave history in the modal. (~ src/CustomForms/AnnualLeaveModal.tsx)
2026-01-17 / Annual leave modal loading skeletons / Show loading skeletons and guard empty states while annual leave data loads. (~ src/CustomForms/AnnualLeaveModal.tsx, ~ src/tabs/home/Home.tsx)
2026-01-17 / Annual leave modal edit refresh / Admin edits now refresh viewed employee data without closing the modal. (~ src/CustomForms/AnnualLeaveModal.tsx)
2026-01-17 / Annual leave modal scroll + ledger cleanup / Removed nested scrollbars and simplified the leave history header controls. (~ src/CustomForms/AnnualLeaveModal.tsx)
2026-01-17 / Annual leave Outlook calendar sync / Create Outlook calendar entries when leave is booked, store event id, and delete on record removal. (~ server/routes/attendance.js, ~ database/migrations/012_annual_leave_outlook_entry_id.sql)
2026-01-17 / Annual leave modal next-year stats swap / Stats card now swaps to a distinct next-fiscal-year layout with clear signposting when the selection is entirely next year. (~ src/CustomForms/AnnualLeaveModal.tsx)
2026-01-17 / Enquiries pipeline hover positioning / Tooltip shows below chip without jolt (removed scaling, animation, centering). (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Enquiries rating chip + modal descriptions / Rating action chip now reflects Good/Neutral/Poor visuals and the rate modal shows full descriptive text. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Enquiries actions column / Moved call/email/rate into the right actions column (no hover overlay) and show edit/delete only when Actions is enabled. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Enquiries table phone hidden / Removed phone display from child enquiry rows to keep pipeline columns aligned. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Grouped prospect count badge / Moved enquiry count into the chevron badge for grouped prospects (no extra chip). (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Clear filters resets search / Clearing all filters now resets the debounced search term so results return immediately. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Grouped prospects clarity / Grouped prospect banner and child rows now label enquiries explicitly (count chip, Prospect label, and per-enquiry index) to avoid confusion. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Timeline chip cleanup / Inline workbench in enquiry timeline now hides Enquiry/Pitch chips and shows Instructed as green when stage is initialised (without tick). (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Passcode link copy fallback / Clipboard copy now falls back to execCommand when Clipboard API is blocked (Teams/webview), fixing “copy link” after generation. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-15 / Enquiry default tab honours pitch enrichment / Selecting an enquiry now opens Timeline when pitch data or pitch ID is present, avoiding Pitch Builder for already-pitched enquiries. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-15 / Timeline deals unified / Timeline now treats all pitch records as deals and signposts whether each was created via pitch email or link enablement. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Timeline deal content signposting / Link-enabled deals now show a clear “no email content” callout and hide the forward-email action. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Timeline doc-request pitch styling / Doc request (workspace) entries now render with a pitch-style icon/chip and distinct colour to match deal items. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Timeline loading skeletons / Added shimmer skeletons for processing sources and initial timeline load to match Home page loading states. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Timeline cache revalidation / Session cache now revalidates in the background so newly generated deals appear without hard refresh. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Link-only deal rendering / Manual link deals now show a checkout link block (no email content) in the timeline. (~ src/tabs/enquiries/EnquiryTimeline.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx)
2026-01-15 / Link-only deal flagging / Manual link generation now flags Status=CHECKOUT_LINK (and DealKind if available). (~ src/tabs/enquiries/PitchBuilder.tsx, ~ server/routes/dealCapture.js, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Pitch Builder draft restore guard + timeline cache bust / Draft values (including service description) only restore when resume is enabled; pitches fetch now busts cache so newly captured deals appear immediately. (~ src/tabs/enquiries/PitchBuilder.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Deal capture de-dupe removed / Removed recent-duplicate detection so every capture creates a new deal/passcode and timeline entry. (~ server/routes/dealCapture.js)
2026-01-15 / Pitch Builder link activation lock / Added activation mode (pitch vs manual) and lockout for scenario/editor when manual activation is selected; updated manual activation helper copy and required field markers. (~ src/tabs/enquiries/components/ProspectHeader.tsx, ~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx, ~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-15 / Pitch Builder notes + prompt layout / Moved enquiry notes into the ProspectHeader as a full-width second row and redesigned the pre-scenario pitch-context prompt as an InlineWorkbench-style banner. (~ src/tabs/enquiries/components/ProspectHeader.tsx, ~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx)
2026-01-15 / Deal details input focus hardening / Switched the Deal details Service description + Amount fields to uncontrolled refs with safe prop sync, preventing focus loss while typing under re-render pressure. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-15 / Enable Link input fix + Link Enabled timeline event / Fixed service description input losing focus on each keystroke (was caused by parent state update triggering component re-render). Added 'link-enabled' as a distinct timeline event type for deals captured without sending a pitch email - shows with purple link icon and "Link Enabled" label in both card and ledger views. (~ src/tabs/enquiries/components/ProspectHeader.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Pitch Builder flattened + Timeline ledger mode / Removed card-based context panel from Pitch Builder header - replaced with minimal inline hints (unconverted pitch warning, notes toggle) so scenario selection appears immediately after the prospect header. Added toggleable "ledger mode" to Enquiry Timeline that renders a clean Clio-style table instead of nested cards with animations. Toggle persists in localStorage. (~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Pitch Builder layout flattening / Reduced pre-scenario clutter by collapsing pitch context + notes into a single compact panel, and moved extracted-section option blocks below the main composer so scenario selection appears sooner. (~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx)
2026-01-15 / Prospect contact actions / Standardised contact display under the client name (email + phone inline with subtle separator, tap-to-email/call and one-click copy) in InlineWorkbench. In Pitch Builder Prospect & Enquiry header, keep contact on the right under the “Contact” subheading with the same actions/copy. (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-15 / Pitch Builder passcode link gating / Passcode now displays as an instruction link that stays masked/uncopyable until the user confirms Amount + Service Description and triggers Deal capture (same flow as after pitching). (~ src/tabs/enquiries/components/ProspectHeader.tsx, ~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx)
2026-01-15 / Pitch history context + Timeline endpoint fix / Pitch Builder header banner now warns when there are previous unconverted pitches (no “saved draft” wording). Enquiry Timeline no longer calls missing `/api/instruction-data` and instead derives lightweight pitch status directly from `/api/pitches`. (~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-12 / Prospects: pipeline column icon-only / Pipeline header now shows labels only; pipeline cells render icon-only states (neutral when absent, coloured when present) and the claim prompt chip supports icon-only mode in the grid. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-12 / Payments: deal capture DB connection-string parsing fix / Support Data Source/Database variants (not just Server/Initial Catalog) so production doesn’t silently connect to the wrong DB and fail with “Invalid object name 'Deals'”. Mark missing-Deals-table as recoverable to avoid hard-failing email flows. (~ server/routes/dealCapture.js)
2026-01-12 / Console noise + missing endpoints fixes / Initialise Fluent UI icons before first render (stops “icon not registered” warnings); fix doc-workspace pending-actions URL to avoid `/api/api` double prefix; mount CallRail route in prod entrypoint; downgrade doc-workspace blob auth failures to 200 empty payload to avoid 500 spam. (~ src/index.tsx, ~ src/tabs/home/Home.tsx, ~ server/server.js, ~ server/routes/doc-workspace.js)
2026-01-11 / Enquiries: pipeline header alignment polish / Reserve a fixed gutter column (used for Clear Filters) across pipeline header + rows so headings stay perfectly aligned with chips even when the clear button appears. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: pipeline header de-dup / Remove the separate pipeline headings row; the filter row now serves as the header so labels aren’t duplicated. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: pipeline filter chip consistency / Standardise tri-state filter indicators: ✓ for Has, ✕ for No (removes mixed dot/tick behaviour). (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: POC filter chip consistency / Replace the POC filter active dot with the same ✓ indicator used for other active filters. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: Claimed tab claim filter cleanup / Hide redundant Claim tri-state stage filter in Claimed tab (claim is guaranteed); keep the person/POC filter only; ignore any persisted claimed-stage filter while in Claimed. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: prefetch instruction data / Allow instruction data fetch when Prospects tab is active (for InlineWorkbench expansion), gated to users with Clients access; fixes “only notes” expansions unless Clients tab visited first. (~ src/app/App.tsx)
2026-01-11 / Enquiries: stacked date/time/ago / Enquiries table date column now renders as 3-line stack (weekday, date + optional time, and “x days ago”) with full timestamp preserved in tooltip. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: pipeline + table readability / Removed Value column and stacked Value under ID to free space for Pipeline; added post-pitch stages; improved date cell readability. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: fixed pipeline columns / Converted the pipeline header + row indicators into a fixed 8-column grid (Teams, Claim, Pitch, Inst, ID, £, Risk, Matter) so headings align and the table doesn’t shift. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Prospects: context chips not faded / When `enableContextStageChips` is enabled, Enquiry/Pitch/Instructed chips use the same status palette as the main workbench tabs (no greyed/faded styling) and connector lines reflect prior stage status. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-11 / Prospects: context chips show data / Clicking Enquiry now opens a lightweight context panel in the workbench Details view; Pitch uses a full-width Details-layout card showing pitch fields (amount/service/passcode etc); Instructed focuses the standard Details landing view. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-11 / Prospects: enable pipeline context chips / InlineWorkbench now allows Enquiry/Pitch/Instructed chips to be clickable when rendered in Prospects (Enquiry navigates back to Prospects; Pitch/Instructed focus Details). (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/*)
2026-01-11 / Enquiries cards: InlineWorkbench expansion / Card view expansions now show InlineWorkbench (claimed/unclaimed/grouped) and linkage is more resilient (wrapper prospectId + deal-only records). (~ src/tabs/enquiries/Enquiries.tsx, ~ src/tabs/enquiries/ClaimedEnquiryCard.tsx, ~ src/tabs/enquiries/NewUnclaimedEnquiryCard.tsx, ~ src/tabs/enquiries/GroupedEnquiryCard.tsx, ~ src/tabs/enquiries/EnquiryLineItem.tsx, ~ src/tabs/enquiries/UnclaimedEnquiries.tsx)
2026-01-11 / Prospects: InlineWorkbench duplication / Show the existing Instructions InlineWorkbench under expanded Prospects (enquiries) table rows when linked instruction data exists; rows are expandable even when there are no notes. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-12 / Demo mode: instructions table demo row / When demo mode is enabled (UserBubble), Clients/Instructions table prepends a synthetic demo client/instruction row for screenshots and walkthroughs. (+ src/app/App.tsx, + src/tabs/instructions/Instructions.tsx)
2026-01-12 / Payments: deal capture SQL hardening + Redis log spam throttle / Schema-qualify Deals-related tables (dbo.*) to avoid default-schema issues and include dbName in failure logs; add cooldown + rate-limited logging for noisy Redis socket-close errors. (~ server/routes/dealCapture.js, ~ server/utils/redisClient.js)
2026-01-12 / ID verification: start verification modal clarity / Replaced notification controls with a clear summary of what checks run and confirmation that no client email is sent from Helix Hub; avoids leaving the user in the dark after clicking Start Verification. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-12 / Demo mode: ID verification simulation / Demo instruction now simulates EID processing → completion and updates the same pipeline/workbench UI states without performing any provider calls. (~ src/tabs/instructions/Instructions.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-10 / Reporting: WIP current week DB fallback / Fixed Management Dashboard not showing current week WIP when Clio unavailable. When wipClioCurrentWeek fails (401/token issues), stream now properly signals error status (instead of empty data) so frontend merge logic falls back to wipDbCurrentWeek dataset. Also added user credential fallback (lz/jw/ac) to reporting.js when clio-pbi token unavailable. (~ server/routes/reporting-stream.js, ~ server/routes/reporting.js)
2026-01-08 / ReportingHome + ManagementDashboard UX polish / Applied InlineWorkbench design patterns across reporting screens: added shimmer/pulse/slideIn/scaleIn animations, uppercase 9px section labels with letter-spacing, processing modal overlay that shows during data refresh, wired isFetching state to processing modal display, borderRadius: 0 throughout, fadeInUp entrance animations for sections, skeleton shimmer utility class in CSS. Dashboard now shows lightweight processing modal during refresh operations with spinner and progress bar. (~ src/tabs/Reporting/ReportingHome.tsx, ~ src/tabs/Reporting/ManagementDashboard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)
2026-01-09 / Reporting: totals explainer + disbursements toggle / Added a Disbursements include/exclude toggle (affects current + previous period Collected) and a bottom click-to-explain callout quantifying KPI vs table total deltas and explaining scope differences (all data vs visible members). (~ src/tabs/Reporting/ManagementDashboard.tsx)
2026-01-09 / Senior Partner role support / Treat “Senior Partner” as partner-class in reporting role filters and matter opening supervising partner selection; add Senior Partner role option where roles are selectable and ensure Partner selection still includes Senior Partner members. (~ src/tabs/Reporting/ManagementDashboard.tsx, ~ src/tabs/Reporting/MattersReport.tsx, ~ src/tabs/Reporting/EnquiriesReport.tsx, ~ src/tabs/Reporting/AnnualLeaveReport.tsx, ~ src/tabs/instructions/NewMatters.tsx, ~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx, ~ src/tabs/instructions/DocumentEditorPage.tsx, ~ src/tabs/home/WeeklyAttendanceView.tsx)
2026-01-07 / Home time metrics load delay / Fixed ~5–10s delay in metrics appearing on Home load. Root cause: parallel fetch effect triggered 3x due to unstable deps (email/initials derived from userData), first 2 runs discarded as stale. LZ/Luke/localhost users had no Clio ID → home-wip returned zeros → triggered slow reporting fallback. Solution: removed email/initials from effect deps (derived from userData anyway), added Alex fallback logic to parallel fetch (matches handleRefreshTimeMetrics pattern), only trigger reporting fallback when truly needed (data exists but all zeros). Metrics now land immediately using lightweight endpoint, no unnecessary fallback. (~ src/tabs/home/Home.tsx)
2026-01-07 / To Do skeleton load / To Do now starts with skeleton chips and only shows the empty "All caught up" state after actions settle, avoiding the green empty-state flash before cards appear. (~ src/tabs/home/ImmediateActionsBar.tsx, ~ src/tabs/home/Home.tsx)
2026-01-07 / Annual leave approval To Do chip subtitle / Fix annual leave parallel-fetch mapping to preserve `person`/leave fields so “Approve Annual Leave” shows initials/names again. (~ src/tabs/home/Home.tsx)
2026-01-08 / Annual leave local+demo parity / In local data mode, derive annual leave approvers from team `AOW` (production routing). In demo mode, show a single “Approve Annual Leave (Demo)” To Do card instead of live approvals. (~ src/tabs/home/Home.tsx)
2026-01-11 / Annual leave approvals: construction routing fix / Stop treating AC as a broad-visibility approver; approvals now follow per-request `approvers` so construction requests show for JW + LZ only, and non-construction for AC + LZ. Also harden construction detection (AOW contains 'construction' or 'cs') in local-mode derivation and backend determineApprovers. (~ src/tabs/home/Home.tsx, ~ api/src/functions/getAnnualLeave.ts)
2026-01-11 / Demo mode: annual leave test cards / Remove the separate “Annual Leave Test Cards” feature toggle and make annual leave demo/test To Do cards controlled solely by the Demo Mode toggle. (~ src/components/UserBubble.tsx, ~ src/tabs/home/Home.tsx)
2026-01-08 / Attendance confirm modal crash / Repair TSX corruption in attendance confirm components and harden Week_Start normalisation + null-safe guards to prevent ErrorBoundary crash on open. (~ src/tabs/home/AttendanceConfirmPanel.tsx, ~ src/tabs/home/PersonalAttendanceConfirm.tsx)
2026-01-08 / Demo mode To Dos / Demo mode now forces demo To Do cards (Approve Annual Leave + Book Requested Leave + Confirm Attendance) and avoids writing live attendance during demos. Demo mode persists as a user-bubble toggle via localStorage. (~ src/app/App.tsx, ~ src/components/UserBubble.tsx, ~ src/tabs/home/Home.tsx, ~ src/tabs/home/PersonalAttendanceConfirm.tsx)
2026-01-08 / Metrics previous-period toggle + header status chip / Add a Current/Previous toggle in the Time Metrics header (applies to both Time + Conversion cards). Make the “Syncing Clio…” badge morph into an “Updated” badge in the same spot after refresh completes; label deltas as “vs previous” and prevent the initial count-up animation from re-running when viewing previous. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-01-08 / Clarify “Previous” meaning / For “Time Today”, Previous now means same weekday last week, with an explicit secondary “Yesterday” line when available. Week-to-date comparisons align to last week-to-date. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/tabs/home/Home.tsx)
2026-01-08 / Home metrics delta tooltips / Remove modal/sidepane explainer and card-click breakdowns. Add subtle hover info bubbles next to delta indicators (Current view only), hide deltas when viewing Previous, and rename card titles in Previous view for clarity. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-01-08 / Home metrics details modal / Make Time + Conversion metric cards subtly clickable and open a Workbench-style modal explaining what each metric includes (period, comparator, optional AOW breakdown). (+ src/components/modern/MetricDetailsModal.tsx, ~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-01-07 / Fix financial forms / Registered `/api/financial-task` on legacy server entrypoint (+ server/server.js)
2026-01-07 / Home time metrics dropping to 0 / Don't abort fetch controller on effect cleanup (was killing requests in React Strict Mode before they completed); treat `/api/home-wip` `{ error }` as failure; extend stale cache TTL; retry once on Clio 401 after clearing token cache (+ src/tabs/home/Home.tsx, server/routes/home-wip.js)
# Changelog
 2026-01-06 / Rate change modal: bulk pressure test outstanding matters / Added `scripts/bulkPressureTestRateChangeOutstanding.mjs` to bulk sync outstanding (pending) matters via `/api/rate-changes/sync-matters`. Hardened the bulk sync endpoint with 429 backoff + light throttling to avoid Clio rate limits. (~ server/routes/rate-changes.js, + scripts/bulkPressureTestRateChangeOutstanding.mjs)

 2026-01-12 / Cleaned up Data Flow workbench copy to match current architecture (simplified UI → /api → Functions/Express → DBs/integrations) and removed outdated “Instructions vs Enquiries” narrative.
 2026-01-06 / Rate change modal: hide new-rate matters / Exclude matters opened in the rate-change year from the main notification list (opened on/after 1 Jan 2026), while keeping them available under the Migrate tab via a separate dataset fetch. (~ server/routes/rate-changes.js, ~ src/tabs/home/useRateChangeData.ts, ~ src/tabs/home/Home.tsx, ~ src/tabs/home/RateChangeModal.tsx)
- 2026-01-06 / Enquiries realtime stream / Added SSE stream at `/api/enquiries-unified/stream`, broadcast on update/create/delete/cleanup and claim; Enquiries tab subscribes when active with debounced refresh; throttled server cache flush in refreshEnquiries. (server/utils/enquiries-stream.js, server/routes/enquiries-unified.js, server/routes/claimEnquiry.js, server/index.js, src/tabs/enquiries/Enquiries.tsx, src/index.tsx, src/setupProxy.js)

- 2026-01-06 / Enquiries stream debugging logs / Added reason-tagged console logs for team-wide fetch triggers + SSE lifecycle/events to quickly diagnose repeated `/api/enquiries-unified` calls without logging PII. (~ src/tabs/enquiries/Enquiries.tsx)

- 2026-01-07 / Enquiries realtime claim patch / SSE claim events now include `claimedAt`, and the Enquiries UI applies an immediate local patch (POC + optional claim time) so claimed/unclaimed filters and counts update instantly; keeps a slower backstop refresh to reconcile. (~ server/routes/claimEnquiry.js, ~ src/tabs/enquiries/Enquiries.tsx)

- 2026-01-07 / Enquiries realtime external claims / While SSE clients are connected, Hub now polls `TeamsBotActivityTracking.UpdatedAt` and broadcasts claim/unclaim changes as SSE events, so the Enquiries UI responds in realtime even when claims originate outside Hub routes (e.g. platform/Teams bot). (~ server/utils/enquiries-stream.js, ~ src/tabs/enquiries/Enquiries.tsx)

- 2026-01-07 / Enquiries realtime watcher hardening / Deduped external-claim broadcasts per enquiryId and switched the polling watermark compare to `UpdatedAt >= since` to avoid edge-case misses; increased batch size. (~ server/utils/enquiries-stream.js)

- 2026-01-07 / Local dev startup stabilisation / Auto-resets corrupted Azurite state on boot; avoids `/api/matters-unified` cold-start stalls in local dev; treats doc-workspace blob auth failures as empty results. (~ scripts/startAzurite.mjs, ~ package.json, ~ src/index.tsx, ~ server/routes/doc-workspace.js)

- 2026-01-07 / Home metrics stability / Avoid deprecated `/api/getAllMatters` 410s in local dev and harden WIP metrics fetch against abort/race (dedupe, cancel, retry once). Also cleaned up a few new lint warnings introduced during the change. (~ src/index.tsx, ~ src/tabs/home/Home.tsx)

- 2026-01-07 / Dead code cleanup (round 1) / Removed a handful of clearly-unused imports/consts flagged by ESLint (safe, no behaviour changes). Added roadmap item for broader cleanup. (~ src/tabs/home/*, ~ .github/instructions/ROADMAP.md)

- 2026-01-07 / Dead code cleanup (round 2) / Removed additional clearly-unused imports/vars in Home tab components (safe, no behaviour changes). (~ src/tabs/home/ActionSection.tsx, ~ src/tabs/home/AttendanceCompact.tsx, ~ src/tabs/home/EnhancedAttendanceNew.tsx, ~ src/tabs/home/HomePanel.tsx, ~ src/tabs/home/PersonalAttendanceConfirm.tsx)

- 2026-01-07 / Home page enquiry metrics standalone route / Created `/api/home-enquiries` endpoint that returns aggregated enquiry counts (today/week/month + prev periods + matters opened) via server-side SQL instead of client-side filtering. Queries both legacy and instructions DBs, 60s Redis cache with stale fallback. Home now fetches this lightweight endpoint independently of the heavy enquiries-unified payload. Added separate `isLoadingEnquiryMetrics` prop for skeleton state. (+ server/routes/home-enquiries.js, ~ server/server.js, ~ src/tabs/home/Home.tsx, ~ src/components/modern/TimeMetricsV2.tsx)

- 2026-01-06 / ChunkLoadError auto-recovery / Added a one-time reload fallback when CRA code-split chunks fail to load (common after dev server restarts with stale chunk URLs). (~ src/index.tsx)

- 2026-01-06 / Unified matters stall diagnostics / Added server timing logs + response timeout for `/api/matters-unified` and client-side pending/timeout logging for the unified matters fetch. (~ server/routes/mattersUnified.js, ~ src/index.tsx)

- 2026-01-06 / Update Alex + Jonathan signatures / Set title to “Senior Partner” for JW + AC, and add an extra “Alex” line above “Alex Cook” in AC signature (+ v2 + txt/rtf variants)
 2026-01-06 / Rate change modal: sync open/close dates / Updated rate-change Clio→SQL sync endpoints to also persist matter Open Date + Close Date (so modal sorting/filtering isn't reliant on stale legacy SQL dates). (~ server/routes/rate-changes.js, ~ src/tabs/home/RateChangeModal.tsx)
 2026-01-06 / Matter Opening: Workbench-structure + opponent entry / Replaced the bespoke ID verification tile block in PoidSelectionStep with IdentityConfirmationCard (Workbench-style layout incl. document-provided + meta row). Also allow entering opponent/solicitor details before confirming no-conflict (Continue remains disabled until confirmed). (~ src/tabs/instructions/MatterOpening/PoidSelectionStep.tsx, ~ src/tabs/instructions/MatterOpening/OpponentDetailsStep.tsx)
 2026-01-06 / Matter Opening: Client summary clarity / Reworked client personal details banner into structured Contact/Address/Personal tiles (no more raw “dump”); updated conflict context tiles so populated Matter/Opponent/Solicitor read as active/selected rather than faded. (~ src/tabs/instructions/MatterOpening/PoidSelectionStep.tsx, ~ src/tabs/instructions/MatterOpening/ConflictConfirmationCard.tsx)
 2026-01-06 / Matter Opening: Fix POID selection regression / Restored PoidSelectionStep selection-context logic after JSX was mistakenly inserted into a useMemo, breaking compilation. Structured Contact/Address/Personal tiles now render in the banner scope (where selectedPoid exists). (~ src/tabs/instructions/MatterOpening/PoidSelectionStep.tsx)
 2026-01-06 / Matter Opening: ID & Conflict confirmation cards / Created two new InlineWorkbench-style components for Matter Opening flow: IdentityConfirmationCard (rich ID verification display with status banners, tiles for ID/PEP/Address, confirmation toggle with override modal) and ConflictConfirmationCard (conflict check display with client/matter/opponent context tiles, checklist modal for Clio search confirmation). Replaced simple ModernMultiSelect conflict picker in OpponentDetailsStep with the enhanced ConflictConfirmationCard. Added clientDisplayName useMemo to FlatMatterOpening and passed clientName + matterDescription props through. (+ src/tabs/instructions/MatterOpening/IdentityConfirmationCard.tsx, + src/tabs/instructions/MatterOpening/ConflictConfirmationCard.tsx, + src/tabs/instructions/MatterOpening/components.ts, ~ src/tabs/instructions/MatterOpening/OpponentDetailsStep.tsx, ~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx)
 2026-01-06 / Inline workbench: Manual ID approval indicator / EID section now clearly distinguishes between automatic "Pass" and manual "Approved" status. When ID was manually approved despite underlying check issues (e.g. Address = Review), displays "ID Approved" banner with explanation, "Manually Approved" badge on EID header, and shows "Approved" in Overall tile while preserving original individual check results. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Global Toast System / Created centralised ToastProvider context with useToast hook for app-wide toast notifications. Supports success/error/warning/info/loading states with automatic dismissal, dark mode, and action buttons. Integrated into App.tsx and migrated InlineWorkbench + Instructions.tsx from local toast state to global system. (+ src/components/feedback/ToastProvider.tsx, ~ src/app/App.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/instructions/Instructions.tsx)
 2026-01-05 / Inline workbench / Approve and Request docs actions now open proper modals with clear prompts: Approve modal explains what confirmation means; Request docs modal shows email preview/template, explains fee earner drafts then sends, and notes that "Docs received" status is manual until systematic tracking is built. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Simplified ID layout: Individual clients show one card (details + address); Company clients show two side-by-side cards — Individual (details + address) | Company (details + registered address). Each card is self-contained. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Restructured company client ID view: added prominent "COMPANY CLIENT" banner with company name + number, header now shows individual name with "Director / Individual" label. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Removed redundant "View Details" action from the ID Verified banner now that EID details are inline/expanded by default. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Company client ID section now shows the individual/director details the EID check is run against (with a clear confirmation prompt when missing) instead of only company entity context. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Individual checked panel now wraps long values and shows postcode within the address line (no separate postcode field). (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / EID results now render as compact cards with status pills, and expanded details include a workflow state strip + recommended action guidance (restoring the best parts of the old review modal inline). (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Moved Business Details into the Company Address card so Personal sits side-by-side with Company Address+Business Details at the top. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Company Address card now shows Business Details above the address fields; Document Provided now uses a passport vs driving-licence selector button layout with the non-selected option disabled. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Added a Show raw record toggle in expanded EID details to view the stored raw verification payload inline (pretty-printed when JSON). (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Prevent delayed placeholder EID failure text like “Check failed or requires review (N/A)” from appearing after verification details load. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Fixed Company Address “No./Street” row alignment by matching grid columns to other address rows and trimming house number display. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Document Provided buttons are now taller with icons and embedded values (no extra detail panel below), and the Recommended action box has been removed (workflow chips retained). (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / EID meta rows: removed duplicate Corr reference, renamed “Tiller ID” to “Corr”, and left-aligned meta labels while keeping value column start fixed. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Clarified workflow chips to “EID status” (Pending / Needs review / Verified) and stopped using docsRequested/docsReceived so uploaded documents don’t incorrectly drive the state yet. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / ID verification now expands inline inside EID Results with per-check dates + fail breakdown; Request docs is internal-only (draft to fee earner), and duplicate summary lines removed. (+ src/tabs/instructions/InlineWorkbench.tsx, src/services/verificationAPI.ts)
2026-01-05 / Inline workbench / Combined ID Document + EID Results into a single full-width ID Verification box for clearer scanning. (+ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-05 / Inline workbench / EID expanded details now surface provider + reference IDs (when available), and the ID Verification header includes a status pill for clearer scanning. (+ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-05 / Inline workbench / EID details are expanded by default and checked dates are date-only (no 00:00). (+ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-05 / Inline workbench / Hide placeholder EID failure reasons (e.g. N/A) so “Fail” only appears when there’s a real issue. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-05 / Inline workbench / EID details now show provider correlation ID (Tiller ID) instead of repeating email, and Approve/Request docs require confirmation. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-05 / Inline workbench / EID tiles now use a simple status icon and no longer repeat per-tile checked dates (single checked date is enough). (~ src/tabs/instructions/InlineWorkbench.tsx)

- 2026-01-05 / Home demo-mode default / Demo mode no longer persists across reloads; clears stale localStorage so Home doesn't show demo data unless explicitly enabled. (~ src/app/App.tsx)

- 2026-01-05 / Instructions: ID review in tray / ID verification Review/View Details now opens the existing review UI inside the inline workbench tray (no legacy modal), preserving approve/request/draft actions. (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/components/modals/IDVerificationReviewModal.tsx)

- 2026-01-05 / InlineWorkbench identity cards: data-per-source + Teams fallback / Redesigned avatar section to show key data fields per source (SQL: name/email/phone; AC: contact ID + status; Teams: tracking/enquiry ID + status). Added ProspectId fallback for Teams link resolution so instructions linked to enquiries can resolve Teams cards even without direct tracking IDs. All three tiles now always visible with reduced opacity when not linked. (~ src/tabs/instructions/InlineWorkbench.tsx)

- 2026-01-05 / Reporting LogMonitor production fix / Fixed SSE log streaming reliability by making CORS origin checks request-aware (allow same-origin behind proxies) and flushing SSE headers/writes for /api/logs/stream. (~ server/index.js, ~ server/routes/logs-stream.js)

- 2026-01-05 / Reports visual refresh / Aligned Reporting surfaces with the newer Helix dark styling: horizontal gradients + brand borders on overview + cards, theme-aware report card text, and removed off-brand sky-blue accents in the shared glass container. (~ src/tabs/Reporting/ReportingHome.tsx, ~ src/tabs/Reporting/ReportCard.tsx, ~ src/tabs/Reporting/components/ReportingSectionCard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)

- 2026-01-05 / Instructions workbench: AC badge opens wrong contact / Centralised ActiveCampaign contact ID resolution and fixed precedence to prefer instruction-level ACID/acid over deal-level ProspectId when both exist. Added Jest coverage for the resolver. (+ src/utils/resolveActiveCampaignContactId.ts, + src/utils/__tests__/resolveActiveCampaignContactId.test.ts, ~ src/tabs/instructions/InlineWorkbench.tsx)

- 2026-01-05 / Tech tickets: problem submit 400 + ledger dark mode / Fixed Tech Problem form payload to match /api/tech-tickets/problem contract (system/summary/expectedVsActual/urgency) and corrected Tech Tickets ledger row text colour in dark mode. (~ src/CustomForms/TechProblemForm.tsx, ~ src/CustomForms/shared/TechTicketsLedger.tsx)

- 2026-01-05 / Test stability: Jest open handle / Unref'd the delayed SQL health-check startup timer so it doesn't keep Node/Jest alive after tests complete. (~ server/utils/db.js)

- 2026-01-04 / Session-start: submodule check messaging / Clarified session-start output to explicitly state submodule checks are read-only. (~ scripts/session-start.mjs)

- 2026-01-04 / Instructions tab backtrack links: AC & Teams origin / Added subtle origin indicators on the avatar (AC + T). AC deep-links to the ActiveCampaign contact; Teams resolves a deep link to the original Teams card via /api/teams-activity-tracking when an enquiryId/record id is available, with safe fallback to Teams web. Positioned as small overlay badges to cue provenance without clutter. (~ src/tabs/instructions/InlineWorkbench.tsx)

- 2026-01-04 / Instructions tab redesign: comprehensive client overview / Transformed identity tab into full "Instructions" client workspace. Added prominent header with person/company avatar, primary name/company name & number, and quick contact details (email/phone/ref). Below: key details grid (DOB, Nationality, City, Postcode), full address card with copy, then ID verification section (passport/license only, removed false "national ID"), EID results, and business details. Space now shows complete instruction/client picture—not just ID verification, but full checkpoint for all client details and verification status. (~ src/tabs/instructions/InlineWorkbench.tsx)

- 2026-01-04 / Workbench visual clarity: ID documents & payments / Enhanced ID document section to visually show which document was used (passport/license/national ID) with green highlight and indicator dot, grayed-out alternatives, and properly formatted date of birth (no timestamp). Similarly added payment method selector showing card vs bank transfer with visual status indicators. Space now speaks for itself—clearly shows situation, position, and alternatives. (~ src/tabs/instructions/InlineWorkbench.tsx)

- 2026-01-04 / Inline workbench per instruction row / Moved workbench from page-level global component to inline expansion within each instruction row. Created InlineWorkbench.tsx component with tabbed sections (ID, PAY, DOCS, RISK, MATTER). Click row to toggle workbench. Includes header with instruction ref, notes/description, and all pipeline action buttons. Removed page-level workbench visibility triggers from onRowClick. (+ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/instructions/InstructionTableView.tsx, ~ src/tabs/instructions/Instructions.tsx)

- 2026-01-04 / Instructions table ref selector not opening / Replaced inline absolute dropdown with Fluent UI Callout anchored to the reference chip (avoids overflow clipping) and keyed view-mode state by a stable selector key (email/ref fallback). (~ src/tabs/instructions/InstructionTableView.tsx)

- 2026-01-04 / Instructions table ref cue + linking / Added an explicit multi-ref count badge and a stacked secondary ref line to visually link matter + instruction in the same chip area (and removed debug console spam). (~ src/tabs/instructions/InstructionTableView.tsx)

- 2026-01-04 / Instructions table chip compactness / Reverted ref chip to single-line height; replaced badge with subtle dot cue; show matter↔instruction linkage only inside the open selector. (~ src/tabs/instructions/InstructionTableView.tsx)

- 2026-01-04 / Instructions table chip overlap / Constrained ref chip to its fixed-width cell (clip overflow) so it doesn't overlap the pipeline connector line. (~ src/tabs/instructions/InstructionTableView.tsx)

- 2026-01-02 / Workbench UI consistency redesign / Redesigned Matter Opening Workbench (ID/PAY/DOCS/RISK/MATTER tabs) for better consistency with app design patterns. Simplified header styling, removed complex gradients/shadows, aligned tab design with app conventions, improved color consistency using established theme system. Cleaner visual hierarchy, consistent spacing, and reduced visual noise while maintaining full functionality. (~ src/tabs/instructions/Instructions.tsx)

- 2026-01-02 / Enquiries ID column shows instruction reference / Added instruction reference display beneath enquiry ID when a pitch/deal exists with an InstructionRef. Matches Instructions table pattern (ID + Reference stacked). Updated backend SQL to include InstructionRef, added field to pitchEntry object and TypeScript interface. (~ server/routes/enquiryEnrichment.js, src/app/functionality/enquiryEnrichment.ts, src/tabs/enquiries/Enquiries.tsx)

- 2026-01-02 / Pitch builder caret jumps to start while typing / Fixed body sync effect to treat focus within editor children (e.g. placeholder spans) as focused, preventing innerHTML rewrites during typing. (~ src/tabs/enquiries/PitchBuilder.tsx)
- 2026-01-06 / Financial forms failing with attachments / Increased Express JSON body limit (base64 uploads) and fixed Payment Requests >£50k field key mismatch. (~ server/index.js, server/routes/financialTask.js)
- 2026-01-06 / Financial forms traceability / Added structured trace logs for /api/financial-task and a JSON error middleware (incl. payload-too-large) for clearer Azure Log Stream debugging. (~ server/index.js, server/routes/financialTask.js)
- 2026-01-06 / Edge Tools hygiene: signatures + nested interactive + CSS prefixes / Added rel="noopener noreferrer" to signature links (bulk script + sendEmail safety-net), removed button-like role/tabIndex from InstructionCard wrapper to avoid nested interactive controls, and reordered -webkit CSS properties before unprefixed equivalents. (+ scripts/fix-signature-noopener.mjs, ~ src/assets/signatures/**, ~ server/routes/sendEmail.js, ~ src/tabs/instructions/InstructionCard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)

- 2026-01-01 / Annual leave UX polish & space booking system / Enhanced annual leave delete modal contrast for dark mode (pure white text). Fully tested half-day leave functionality via terminal with database schema updates (half_day_start/half_day_end columns). **Major**: Space booking system fully operational - fixed bookSpace.js imports, added attendanceQuery pattern, tested Boardroom/Soundproof Pod bookings with Clio integration. Added DELETE endpoint + UI delete functionality with confirmation dialogs. Cleaned availability UI to only show dates with bookings. Added booking refresh after creation. (~ src/CustomForms/AnnualLeaveForm.tsx, BookSpaceForm.tsx, server/routes/bookSpace.js, server/server.js, src/tabs/home/Home.tsx, + scripts/createBookingTables.mjs, deleteTestBookings.mjs)

- 2026-01-01 / Instructions day folding not applying / Fixed local/static server to prefer serving latest CRA output from build/ so UI code changes (e.g., day folding/hover) show up after rebuild. (~ server/index.js, server/server.js)

- 2025-12-31 / Pitch builder production refinements / Cleaned up pitch builder for production: standardized terminology (Scope of Work, Quote Amount), simplified labels (removed colons, reduced verbosity), cleaner VAT toggle ("No VAT (international)"), improved error display, consolidated confirmation messages. Enhanced UI with refined borders (8px radius), softer shadows, smoother transitions (cubic-bezier), subtle focus glows, better card hover states. Professional polish throughout. (~ src/tabs/enquiries/pitch-builder/DealCapture.tsx, PaymentPreview.tsx, EditorAndTemplateBlocks.tsx)

- 2025-12-30 / Migrate decoupled-functions to Express / Ported 5 functions to direct SQL in Express routes (matterRequests, opponents, ccl, pitches). Deleted ALL remaining decoupled function folders (15 total). decoupled-functions/ now empty except scaffolding. No more dependency on instructions-vnet-functions Azure Function App. (~ server/routes/matterRequests.js, server/routes/opponents.js, server/routes/ccl.js, server/routes/pitches.js, - decoupled-functions/*/)

- 2025-12-30 / Dead code removal: decoupled-functions / Deleted 8 unused Azure Functions: fetchEnquiryEmails, fetchEnquiriesData, recordRiskAssessment, dealCapture, importInstructionData, deleteTestMatters, insertEnquiry, sendEmail. Also removed dead routes: enquiries.js, enquiryEmails.js, EnquiryEmails.tsx. (- decoupled-functions/*, server/routes/enquiries.js, server/routes/enquiryEmails.js, src/tabs/enquiries/EnquiryEmails.tsx)

- 2025-12-30 / Foundation cleanup / Archived one-off scripts, fixed stale file references in instruction docs, added doc maintenance rule to copilot-instructions. (+ scripts/archive/, .github/copilot-instructions.md, .github/instructions/*.md)

- 2025-12-30 / Agent infrastructure / Built context sync system for autonomous agents. Scripts auto-generate REALTIME_CONTEXT.md with branch state, submodule status, server ports. Session start protocol established. (+ scripts/sync-context.mjs, scripts/update-submodules.mjs, scripts/validate-instructions.mjs, scripts/session-start.mjs, .github/instructions/REALTIME_CONTEXT.md, .github/copilot-instructions.md)

- 2025-12-30 / 2025 Rate Update / Updated all fee earner rates in both databases (helix-core-data, instructions). Alex Cook + Jonathan Waters → Senior Partner £475. All roles updated to new structure. (+ scripts/updateRates2025.mjs, scripts/updateRatesInstructions.mjs, database/migrations/010_2025_rate_update.md, .github/instructions/TEAM_DATA_REFERENCE.md)

- 2025-12-30 / Instruction files foundation / Added TEAM_DATA_REFERENCE.md, WORKSPACE_OPTIMIZATION.md. Updated copilot-instructions.md to match typefxce foundation pattern. (+ .github/instructions/*, .github/copilot-instructions.md)

- 2026-01-08 / Conversion metrics reloading / Stabilised conversion metric cards by removing refresh-based remounting and using a short refresh pulse animation (src/components/modern/EnquiryMetricsV2.tsx)

- 2026-01-08 / Conversion metrics breakdown inspect / Home now stores `/api/home-enquiries` `breakdown` payload and passes it into Conversion Metrics; enquiry cards show a subtle inspect cue and open a BespokePanel modal with top AOW segments (today/week/month). (~ server/routes/home-enquiries.js, ~ src/tabs/home/Home.tsx, ~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
