2026-02-25 / Add ID high-level timeline row and remove duplicate save cue / Added an Instructed→ID timeline strip to the Identity tab for parity with Payment/Risk headers, and removed manual `Save report` control in demo auto-submit mode while showing a single auto-submit status chip (`enabled/saving/failed/submitted`). (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Simplify company client prompt copy / Shortened the Instructed company info prompt text to `Company client` by removing the extra confirmation guidance line. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Hide pitch expiry cues after instruction / Updated Pitch header timeline to suppress expiry connector and expiry-window chip when the deal is instructed/closed, so only Pitched → Instructed cues remain before tab chips. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Add breathing space between amount and VAT lines / Increased vertical spacing between primary amount values and `incl. VAT` sublines in Pitch and Instructed amount cards to reduce visual crowding. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Fix pitch-time UTC drift in timeline chips / Corrected pitch/instruction time merge to parse raw clock values from time fields and format display in Europe/London, preventing local timezone offset from shifting `PitchedTime` (e.g. 11:44 showing as 12:44). (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Remove non-claim timestamp fallback from claimed-time display / Reverted legacy fallback that sourced `Claimed by` time from pitch timestamps; claimed timeline now uses only claim-related sources to avoid misrepresenting event timing. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Add legacy claim-time fallback from pitch records / After DB verification showed no explicit claim timestamp for some legacy enquiries, added claim-time fallback sourcing from `Deal.PitchedTime` and pitch-content created timestamps so `Claimed by` can still show a time where available. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Harden enquiry claim-time parsing for legacy formats / Added robust claim datetime parsing (10/13-digit epoch support, dotted `HH.mm` times, safe date parsing, and intrinsic non-midnight time detection) so `Claimed by` retains time when available while touchpoint remains date-only for legacy defaults. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Correct enquiry time display split (touchpoint vs claim) / Suppressed touchpoint `00:00` default time in Enquiry timeline while restoring claim-time rendering by broadening claim time extraction (including epoch/timed claim formats and merged claim date+time fields). (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Keep inactive pipeline chips hover-responsive / Removed disabled-state gating on EnquiryTimeline pipeline chips so inactive stages still receive hover lift and pointer affordance while staying visually muted. (~ src/tabs/enquiries/EnquiryTimeline.tsx)

2026-02-25 / Prioritise claim timestamp time in enquiry header / Corrected Enquiry claimed-time formatting to prefer claim sources with explicit time before any date-only fallback, preserving claim time display while still suppressing legacy touchpoint `00:00`. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Suppress legacy enquiry midnight times / Updated Enquiry timeline formatting to only show touchpoint/claimed times when source data contains an explicit time, preventing legacy date-only records from displaying `00:00`; also suppresses touchpoint→claim duration when touchpoint time is not present. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Hide orphan instructed timeline connector / Updated the Instructed timeline row to render the Pitched→Instructed connector only when both chips are present, preventing dangling connector lines when no instruction chip exists. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Prevent false instructed state in pitch timeline and header / Removed enquiry-date fallback from Pitch instructed timestamp resolution and gated `Deal Closed`/`Instructed` cues behind explicit instructed-stage signals (`instruct*`, `matter-opened`, `proof-of-id`, `payment`, `id check`, `risk`) so `Request Docs` cases no longer show as instructed. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Close pitch amount-service and checkout section borders / Updated Pitch Amount/Service and Checkout Link containers from top-only borders to full bordered boxes so section framing is consistent with adjacent panels. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Remove pitch delivery-mode prompt and move mode cue into link label / Removed the Pitch delivery-mode info prompt box and made the checkout label self-describing: `Pitch Link` when pitch email content exists, otherwise `Checkout Link (via link)`, so mode is conveyed by the link cue itself. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Correct enquiry notes fill to subtle pitch-link row shade / Replaced the too-strong enquiry notes tint with the subtle Pitch link-row background tone (`rgba(54, 144, 206, 0.04)` dark / `rgba(54, 144, 206, 0.03)` light) to match cross-tab styling more closely. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Match enquiry notes fill to pitch checkout-link chip shade / Updated Enquiry notes box background to use the same fill tone as the Pitch checkout link chip (accent-tinted in dark mode, highlight-tinted in light mode), replacing the prior delivery-mode-style neutral fill. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Clean pitch borders and replace generated-strip with mode prompt box / Closed Pitch data-bar and pitch-content side borders (full box borders), and replaced the old `Pitch link generated` strip with a company-style info prompt box that confirms delivery mode: `Pitch Email`, `Doc Request`, or `Link Generation`. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Close enquiry data bar and notes side borders / Updated Enquiry section data bar and notes container from top-bottom-only borders to full bordered boxes so left/right edges are visually closed and separators read cleaner. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Hard-align enquiry-notes and instructed section headers to box edge / Removed remaining left padding from `Enquiry Notes`, `Individual`, and `Company` header rows so labels align with their container box left edge instead of the inner content text baseline. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Align instructed individual-company headers and add subtle client badge / Nudged Instructed `Individual` and `Company` header rows left to align with their section boxes, and added a low-emphasis `Client` badge next to `Company` when client type is company. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Nudge enquiry notes header left to align with notes box / Adjusted Enquiry Notes header row horizontal padding so the header sits subtly left of the note text and aligns better with the notes box boundary. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Remove explicit checkout status text badges from link rows / Removed the separate `Instructed`/status text chips from Pitch and Instructed checkout link rows and retained colour-only state signalling (accent/highlight for pending, green for actioned/completed) to reduce label clutter. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Improve link-row affordance with distinct chips hover and feedback / Reworked Pitch and Instructed checkout rows into clearly separated chips (label, URL, status, copy), added hover lift/contrast feedback on clickable elements, and added explicit open/copy toasts so click targets and outcomes are obvious. Also added toast feedback for instruction reference copy. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Add copy cues to pitch and instructed link chips / Added visible copy icon cues and explicit click-to-copy behaviour on Pitch and Instructed checkout link chips, plus a copy cue on the Instructed instruction tag chip, with success toasts for copied links. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Accent dark-mode company cue and boxify pitch-instructed checkout links / Updated Instructed company client prompt to use accent treatment in dark mode, converted Pitch and Instructed checkout links to house-style boxed link chips with visible URL text, and added state cues (accent pending in dark mode; green when instructed/completed). Also restyled instruction reference as a matching box chip in the Instructed link row. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Neutralise pitch and instructed amount text colour / Changed Amount values in Pitch and Instructed amount/service panels from highlight blue to body text colour so they match Service description text and maintain consistent emphasis. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Remove amount-service left accent borders in pitch and instructed / Dropped the left border accent from the Amount/Service split panels in both Pitch and Instructed sections so blue amount text remains the single emphasis cue and styling stays consistent. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Enforce boxed company reminder chip in instructed view / Updated Instructed company reminder to always render as a visible house-style boxed chip (subtle blue tint, border, left accent bar, info icon) so it matches Matter-style prompt boxes and cannot appear unboxed in flat embed states. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Match instructed company reminder to matter-portal style box / Restyled the Instructed company reminder as a compact single-line info box using the Matter Portal row visual pattern (inline box, subtle blue tint, thin border, info icon) with concise role-confirmation prompt text. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Simplify instructed company reminder to one-line info cue / Reduced the Instructed company reminder to a low-emphasis single-line info box (info icon + prompt text) with optional inline company name/number, replacing the heavier multi-line reminder block. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Make pitch header state-aware for instructed and expiry outcomes / Updated Pitch panel heading to show `Deal Closed` when instructed, `Pitch Expired` when expiry window elapsed without instruction, and `Pitch Sent` otherwise; description text now adjusts to match each state. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Strengthen instructed company reminder box with role mapping cue / Redesigned the Instructed company info box into a house-styled reminder panel with info icon prompt and explicit `Individual (point of contact) · Company (client)` confirmation text, keeping company name/number immediately visible beneath the data bar. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Replace pitch area icon with status dot cue / Swapped Pitch data-bar `Area` icon for a compact colour status dot so area signalling matches the cleaner live-cue style now used in Enquiry. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Move instructed company panel below data bar as secondary info box / Repositioned company client details to render beneath the Instructed data bar and restyled the block to lower-emphasis informational treatment so primary emphasis remains on data-bar `Type` confirmation first. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Replace enquiry area icon with live status dot cue / Swapped the Enquiry data-bar `Area` emoji icon for a compact colour status dot using area accent colours to reduce visual clutter while preserving at-a-glance state signalling. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Standardise pitch and instructed data-bar values / Updated Pitch and Instructed `DataCol` value rendering to explicit Raleway and bottom-left stack alignment so data-bar values match the same typography/alignment standard now used in Payment and Enquiry. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Standardise payment and enquiry data-bar values / Applied explicit Raleway typography and bottom-left label/value stack alignment across Payment summary data-bar columns (Total Paid, Deal Amount, Payments, Last Payment, Method) and Enquiry data-bar values via `DataCol` so value presentation is consistent in both sections. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Fix Last Payment tile typography and alignment / Updated Payment summary `Last Payment` tile value to explicit Raleway and aligned its label/value stack to bottom-left for consistency with requested payment formatting. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Revert out-of-scope payment summary typography change / Restored `Total Paid`, `Deal Amount`, and `Last Payment` summary-bar values to their previous styling after confirming typography updates should remain scoped to the expandable payment record card only. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Use Raleway for payment summary last-payment and amounts / Replaced remaining monospace styles in Payment summary data bar so `Total Paid`, `Deal Amount`, and `Last Payment` values render in Raleway for consistent payment typography. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Standardise payment record card typography and remove collapsed status duplicate / Removed collapsed-row `• succeeded` text in payment records and normalised expanded payment detail label/value blocks to consistent Raleway styling with left-aligned, bottom-anchored values for Date, Amount, Currency, Method, Service, Payment ID, and Instruction Ref. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Remove duplicate payment success cue in single-record case / Suppressed lower per-payment result pills when there is exactly one successful payment so the `£... · succeeded` signal appears only once in the top payment banner context. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Refine payment banner copy and controls alignment / Changed successful card-payment banner subtext from `Paid — £...` to `£... · succeeded`, and reordered Payment controls bar so record-count badge sits left with `Create Payment Link` aligned far right. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Merge instructed-pitch expiry cues into one subtle chip / In Pitch timeline when instruction exists, removed duplicated emphasis by suppressing separate connector diff text and replacing struck expiry label with a single muted `Expiry window · <diff>` cue; keeps context clear without drawing priority to superseded expiry state. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Add demo touchpoint time fallback in enquiry timeline / Updated Enquiry touchpoint time resolver to fall back to explicit time fields and, for demo prospects, claim timestamp time when touchpoint date is date-only, so `Touchpoint · ... · HH:MM` renders for demo visualisation. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Improve light-mode pipeline connector visibility / Increased inactive connector contrast and thickness between pipeline chips in light mode so links remain visible between both inactive and active-adjacent stages. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Soften light-mode timeline difference cue text / Reduced visual weight of connector elapsed/difference labels in light mode (lower weight + opacity) across Enquiry, Pitch, Instructed, Payment, and Risk timeline rows while keeping dark-mode contrast unchanged. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Correct enquiry claim chip to claimed-by initials with date-time / Replaced time-only `Touchpoint claimed` chip text with `Claimed by <initials> · <date time>` in Enquiry timeline, deriving initials from Point of Contact and using resolved claim timestamp for clearer attribution and timing context. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Add Today-Yesterday timeline labels and fix pitch-to-instruct delta source / Updated timeline stamps to show `Today` / `Yesterday` where applicable, and fixed Pitch timeline elapsed calculation to use instruction date+time fallbacks (including submission time fields) with `<1m` minimum output instead of misleading `0m`; instructed chip in Pitch now includes timestamp context. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Adopt enquiry-style chip boldness balance across timelines / Updated timeline chips so milestone labels remain stronger while timestamp segments render slightly softer (same visual balance as Enquiry), applied across Pitch, Instructed, Payment, Risk, and Enquiry claim chips for more consistent first-pass readability. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Standardise timeline chip readability and touchpoint wording / Normalised timeline chips to `Label · timestamp` formatting across Enquiry, Pitch, Instructed, Payment, and Risk rows, and clarified Enquiry wording to `Touchpoint · ...` / `Touchpoint claimed · ...` so touchpoint meaning is explicit at first glance. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Make payment instructed chip neutral and move risk timeline tags above summary box / Changed the Payment timeline `Instructed` chip to neutral start-state styling, and moved Risk timeline tags out of the inner summary card into the header area with `Instructed -> elapsed -> Risk` sequencing so risk follows the same top-row pattern as other tabs. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Add identity timeline row with instructed-to-verification delta cues / Added an ID header timeline row in Identity view showing `Instructed <timestamp> -> <elapsed> -> Verified/Failed/Review <timestamp>`, with result chip semantics mapped to green for approved/verified and red for failed/review (pending remains amber), while keeping connector elapsed text neutral. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Set enquiry claimed cue to green and pitch start cue to neutral / Updated Enquiry claimed chip styling from blue to green, and changed the Pitch `Pitched` starting chip to neutral styling (muted icon/text + neutral background/border) to reflect starting-state semantics. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Normalize all timeline difference cue colours to neutral / Standardised connector elapsed/difference labels (day/hour cues) to neutral text tokens across Enquiry, Pitch, Instructed, and Payment rows, removing mixed blue/accent styling and keeping only chips as semantic colour cues. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Move payment timeline tags to header bar with instructed-to-paid delta / Added a tag row directly under the Payment header banner (matching other tabs) showing `Instructed <timestamp> -> <elapsed> -> Paid/Confirmed <timestamp>`, and removed the status segment from the inner payment summary panel so timeline cues sit in the correct top bar. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Strike through pitch data-bar expiry after instruction / Updated Pitch context data bar so `Expiry` value is struck through (and muted) when the record has reached instructed state, matching the timeline-chip expiry superseded cue. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Move paid status into payment summary bar with timestamp / Relocated the overall payment status badge (`Paid`/`Payment Failed`/`Pending`) from the lower pills row into the summary data bar and added paid timestamp display beside it, reducing duplicate status cues and keeping timeline state in a single bar. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Deduplicate instructed header cues and align chip semantics / Removed the top-right `Instructed · ...` text and removed the duplicate right-side instructed status chip in the Instructed context row; updated timeline chips so `Pitched` renders neutral and `Instructed ...` renders as a green completion cue. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Infer missing pitch expiry for timeline strike-through cue / Added fallback expiry derivation (`pitched date + 14 days`) when source expiry fields are absent, so the Pitch timeline still renders the expiry chip and applies strike-through after instruction confirmation. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Reflow pitch chips into timeline order with instructed in sequence / Reworked Pitch chip row to show a true timeline (`Pitched -> time -> Instructed -> time -> Expires`) by moving `Instructed` into the middle of the sequence, removing the far-right duplicate status chip, preserving time-between cues on connectors, and keeping expiry struck through once instructed exists. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Strike through pitch expiry when confirmed and replace right chip with instructed / In Pitch context, when confirmation cue is present (`Confirmed … before/late`), the right-side status chip now switches to a single `Instructed` chip (green for in-window, alert for late) and expiry chip is struck through for confirmed-in-window records to avoid duplicate status signalling. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Remove duplicate pitch top-right timestamp and widen expiry field fallback / Deleted the top-right `Pitched ...` text from the Pitch header so only the chip row carries timeline info, and expanded pitch expiry field resolution (`ExpiryDate`, `ExpiresAt`, `ValidUntil` variants) so the expiry chip and connector cue appear more consistently. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Replace pitch elapsed connector with confirmation/remaining cue / Updated the Pitch expiry connector micro-cue to show outcome-aware text: `Confirmed … before` when instructed within expiry, `Confirmed … late` when instructed after expiry, otherwise live `… left` or `Expired … ago`, while keeping the expiry chip visible. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Split payment header copy by method and tidy docs autosubmit wording / Payment banner now shows `Payment received` with `Paid — £...` for successful card flows and `Payment confirmed` with `Confirmed <date>. Please verify transactions with Accounts.` for successful bank flows; also renamed EID report action text to `Save report` and `Auto-submitted` for cleaner status messaging. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Align payment shell colour and use accent for dark-mode blue headers / Matched Payment tab content container to the same card surface/border treatment as other tabs, and switched blue header cues (icon/title before description) to `accent` in dark mode for status banners plus Enquiry/Pitch/Instructed context headers. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Restore payment records for paid demo chips and re-enable chip hover affordance / Inline workbench now falls back to top-level `item.payments` when instruction-scoped payments are absent (fixes paid demo case showing no records), and pipeline chips now visibly react on hover even in pending/neutral states so users can still click through confidently. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Gate tab banner blue state by actual evidence / Added evidence-aware banner statuses for ID, Payment, Risk, Matter, and Docs so `complete` (blue header) only renders when corresponding data exists on the record; otherwise banners fall back to pending/neutral styling and copy. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Remove pitch midnight time noise and normalise instructed stage text / Updated pitch datetime rendering to avoid appending `00:00` when source data is date-only, and mapped instruction stage display so raw values like `matter-opened` render as user-facing labels (e.g. `Instructed` / `Proof-of-ID`). (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Align enquiry tag spacing and harden claimed timestamp fallback / Matched Enquiry outside tag-row height to Pitch (`minHeight: 36`) and expanded live claimed-time resolution fallbacks (claimed date/time fields + submission timestamps) so Teams chip shows `Claimed HH:MM` more reliably on live records. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Remove updated prefix from header right labels / Dropped the `Updated` prefix from the remaining right-side header status/date labels in Pitch and Instructed so they show plain stage/date text (e.g. `proof-of-id · 22 Feb 2026 10:35`). (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Consolidate outside tag rows for enquiry, pitch, and instructed / Moved Enquiry rating chip to the outside tag row and removed its duplicate inner row; moved Pitch and Instructed tag bars (timeline/status chips) outside their cards under headers and removed duplicate inner tag rows to reduce noise and row duplication. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Remove enquiry updated text and lift chips outside card / Deleted the right-side `Updated Claimed ...` text from the Enquiry header and moved the two enquiry chips (touchpoint + Teams) to a row directly under the header, outside the card; kept rating chip inside the card to minimise layout churn. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Make one demo prospect individual for UI comparison / Updated demo workbench seed so `DEMO-ENQ-0002` uses `ClientType: Individual` and blank company fields, enabling side-by-side visual comparison of company-client banner/text behaviour. (~ src/tabs/enquiries/Enquiries.tsx)

2026-02-25 / Finalise enquiry and pitch header parity / Removed remaining details-wrapper horizontal inset and updated Enquiry/Pitch headers to blue value + separate description copy (`Review details below.`) to match the Instructed header treatment and reduce toggle mismatch. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Split instructed header value and description copy / Changed Instructed header text to use `Instruction received` as the header value and `Review details below.` as the adjacent description copy. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Move claimed and pitched headers outside cards / Applied the same structure used for Instructed: Enquiry (Claimed) and Pitch now render header rows outside their content cards, with the box starting below, matching Matter-style framing and reducing layout inconsistency. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Flatten instructed address rows to reduce section noise / Removed address sub-section divider lines inside Instructed `Individual` and `Company` blocks and tightened address row spacing so addresses read as part of their parent fields instead of separate sections. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Make instruction header blue and add one-line prompt / Updated Instructed details header cue to blue (icon + title), added a one-line descriptive prompt beside `Instruction`, and switched Matter-opened icons to `FaFolderOpen` in both the Matter status banner and Matter pipeline stage chip. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Match instructed header top inset with matter / Updated the Instructed outside header row padding to the same top/horizontal rhythm used by Matter status banners so toggle transitions no longer shift at the top edge. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Align instructed gutters and lift header outside card / Removed the extra outer horizontal inset for the Instructed details view and moved the `Instruction` header row above the content card so side padding matches Matter and the header sits outside the box. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Brand EID PDF with Raleway font and logo / Registered Raleway Regular + Bold as custom jsPDF fonts and embedded the white Helix logo PNG in the PDF header for both the workbench raw-record PDF and the UserBubble concept preview PDF. Created pdfAssets module with base64-encoded font and image data. (+ src/utils/pdfAssets.ts, ~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/components/UserBubble.tsx)

2026-02-25 / Restore instructed outer shell parity with matter / Reinstated the Matter-style outer content shell for Instructed existing-record view (same background, border, and padding) to keep structure and tab-to-tab positioning consistent. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Pull instructed header out of outer card / Removed outer shell styling from the Instructed container so the `Instruction` header no longer renders inside that added box. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Encapsulate enquiry and pitch headers inside card shell / Added Matter-style outer card shells to Enquiry and Pitch context views so their headers render inside the same box (matching Instructed/Matter structure). (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Align details-tab header vertical anchor / Removed extra top inset in the details context container so Enquiry/Pitch/Instruction headers sit at the same vertical position as ID/Payment/Risk/Matter tab headers. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Encapsulate instructed existing-record view / Added a Matter-style outer content card shell (background, border, padding) to the Instructed context existing-record layout so it has the same clean encapsulated presentation. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Style instructed checkout as green cue box / Restyled the Instructed context checkout link into a compact green cue box (matching Matter Portal cue language) while preserving the same link target and passcode display. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Keep instructed header as top row / Hid the Company Client banner in Instructed context so the new Instructed header stays first; banner still shows for Enquiry/Pitch contexts. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Box and align context headers with status banners / Updated Enquiry, Pitch, and Instruction context header rows to use the same boxed banner treatment and visual scale as ID/Payment status prompts (icon + title + update text) for consistent quick-glance hierarchy. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Align context header scale with workbench / Increased Enquiry, Pitch, and Instruction header/update text sizing and weight to match existing workbench section hierarchy (removed undersized appearance). (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Make context update labels quick-glance specific / Refined Enquiry, Pitch, and Instruction header `Updated` text to be stage-contextual (e.g., touchpoint/claim time for Enquiry, pitched/status context for Pitch, and status+date for Instruction) for faster scanning. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Add update headers to context sections / Added compact header rows with `Updated …` timestamps to the Enquiry, Pitch, and Instruction context panels in InlineWorkbench to match the Matter-style section framing and improve visual consistency. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-25 / Fix matter declaration order compile break / Reordered matter-section constants so `feeEarner` and `matterSupervisingPartner` are declared before use, resolving TS2448 compile errors in InlineWorkbench. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-24 / Switch overview case chips to left-border cues / Updated the Enquiries top overview case selector chips (above the pipeline strip) to use internal left-border colour cues instead of circular dot markers. (~ src/tabs/enquiries/components/ProspectHeroHeader.tsx)

2026-02-24 / Expand existing matter panel with opening trail and collected fields / Matter tab now surfaces comprehensive existing-matter data: Opening Trail (opened on/by/method + assignment chain), Matter Collected Fields (client + matter identifiers/details), Clio logo cue, and Matter Portal row with explicit opened state + passcode sourced from Clio Client ID (fallback to existing passcode fields). Added ND workspace detection placeholder row for follow-up integration. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-24 / Switch matter case chips to left-border cues / Updated Matter tab case chips to use internal left border accents (status/context cues) instead of icon/dot-style leading markers, matching the requested pipeline chip language. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-24 / Expand existing matter workbench panel with comprehensive chip sections / Upgraded Matter tab (existing matters) from minimal summary to full pipeline-style layout: richer top chips (opened date, matter ref, status, practice area, Clio ID, instruction ref), expanded assignment data bar (responsible/originating/supervising + responsible email), client-description-value block, and lifecycle/origin block (opened/closed/source/referrer). Removed inline matter debug log noise. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-24 / Redesign conflict section to OG button flow + add solicitor address / Conflict section now mirrors ConflictConfirmationCard OG: Shield header with title/subtitle, coloured status banner (green confirmed / red unconfirmed) with SkypeCheck/Warning icon, in-box `Confirm No Conflict` action button, context tiles (Client, Description, Opponent, Opp. Solicitor), and confirmed-state reset row. Removed old checkbox interaction. Added opponent solicitor address fields (house number, street, city, county, postcode, country) with state, localStorage persistence, UI inputs, and payload wiring. (~ src/tabs/instructions/MatterOpening/CompactMatterWizard.tsx)

2026-02-24 / Fix conflict box, fee earner resolution, and demo client type / Merged conflict info strip + checkbox into single unified box with Shield→SkypeCheck icon transition on confirm. Fixed fee earner/originating defaulting to "Alex" — resolvedFeeEarner now resolves signed-in user FullName from Email via teamData lookup (currentUser only has Email, not FullName). Fixed demo prospect showing "Individual" + "Demo Corp" — changed ClientType to 'Company' to match CompanyName. (~ src/tabs/instructions/MatterOpening/CompactMatterWizard.tsx, ~ src/tabs/enquiries/Enquiries.tsx)

2026-02-24 / Fix workbench visual regressions and matter wizard defaults / Fixed 5 instances of \u00A3 rendering as literal text in JSX payment displays (replaced with actual £ character). Fixed borderRadius: 999→0 on 2 payment status pills and borderRadius: 4→0 on 9 timeline chips/status badges. Standardised matter display data bar background/border tokens to match payment/identity sections. Restored conflict icon from react-icons FaShieldAlt to Fluent UI Shield (matching OG ConflictConfirmationCard pattern with 24×24 styled box). Fixed fee earner/originating stale default — added useRef tracking so signed-in user overrides propFeeEarner fallback when currentUser loads after mount. (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/instructions/MatterOpening/CompactMatterWizard.tsx)

2026-02-24 / Align workbench EID PDF with concept design / Rewrote buildRawRecordPdfBlob to match the validated concept from UserBubble: flat navy header (HELIX LAW + instruction ref), clean Summary section, grey-band check sections with result right-aligned, simple reason rows (key: reason (code)), and minimal SRA footer. Removed old gradient header, hero band, status dots, and embedded base64 mark image. ~8K chars vs old 16K. (~ src/tabs/instructions/InlineWorkbench.tsx)

2026-02-24 / Add confirmation, auto-report, and telemetry to CompactMatterWizard / Added pre-submit confirmation step (detail summary + acknowledge checkbox), success confirmation state (matter ID display + Done button), auto-report diagnostic email on failure (auto-sends to lz@helix-law.com), manual Report button in error UI, and App Insights telemetry (PreValidation.Failed, Processing.Started/Completed/Failed). Submit button now routes through confirmation before processing. (~ src/tabs/instructions/MatterOpening/CompactMatterWizard.tsx)

2025-02-24 / Complete Enquiries Report content-area brand cleanup / Systematically fixed ~100+ off-brand inline styles below the toolbar: all filter inputs (borderRadius 0, brand borders/bg/text), pocStyle/statusBadge/dealTag/instructionTag/v2Pill/claimedBadge (brand token hex suffixes instead of rgba Tailwind colours), initialsPillStyle (flat bg, brand border), migrationIndicator colours (colours.green/yellow/orange/accent/subtleGrey), migrationBadge (borderRadius 0), highlightedCellStyle (borderRadius 0, brand accent), AoW icon border, 3 chart dashed separators, marketing toggle button, reassignment dropdown (brand bg/border/shadow/text), data modal (borderRadius 0), close/filter/confirm/cancel buttons (borderRadius 0), pie chart tooltip (borderRadius 0), filter badge, timeline node (50%), claimer/non-claimer rows (borderRadius 0), and last 2 off-brand #1f2937 pie chart strokes. Zero compile errors. (~ src/tabs/Reporting/EnquiriesReport.tsx)
2026-02-24 / Structural rework of Enquiries Report toolbar to match ManagementDashboard / Replaced entire EnquiriesReport toolbar layout with ManagementDashboard's CSS-class-based pattern. Removed "Data window" bordered box, pitch/instruction count pills, dataset ranges sub-panel, and active filters indicator bar. Added `management-dashboard-container` wrapper with theme class for CSS scoping. Now uses `filter-toolbar`, `filter-toolbar__top`, `filter-toolbar__presets`, `filter-toolbar__roles`, `filter-toolbar__bottom`, `filter-section-label`, `preset-separator`, `filter-status-chip`, `filter-icon-button`, `filter-dataset-tooltip`, `date-stamp-button` CSS classes from ManagementDashboard.css. Active filters are now inline chips inside toolbar. Removed all inline hover handlers — CSS handles hover states. (~ src/tabs/Reporting/EnquiriesReport.tsx)
2026-02-24 / Route workbench ID chip demo PDF flow to production-shaped sample / Updated InlineWorkbench demo verification details to use the full production-style raw payload (array record with Address + PEP `checkStatuses`, results, reasons, correlation/external refs) so Prospects Overview → Pipeline → Workbench ID `View Report`, `Download`, and `Save to Docs` generate from the same report version shown in concept work. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-24 / Add real PDF preview to UserBubble EID concept modal / Upgraded the local EID concept modal from card-only mock to a generated sample PDF preview (via jsPDF) with inline embed + download fallback, using the same sample payload mapping for Address/PEP sections, reasons, correlation/external refs, and a trust footer line so concept and document view are aligned. (~ src/components/UserBubble.tsx)
2026-02-24 / Add branded header and trust footer to EID concept modal / Updated the local UserBubble EID report concept preview with a Helix-branded heading (mark + logo assets from the assets folder) and a subtle trust footer strip (SRA regulated, auditable checks, correlation-linked, SRA ID) to better reflect the intended report usability and brand tone. (~ src/components/UserBubble.tsx)
2026-02-24 / Add local EID report concept preview in UserBubble / Added a new local-only control in UserBubble (`EID Report Concept`) that opens a compact modal prototype rendering the production-style sample verification payload (correlation/external references, overall result, Address and PEP check blocks, result counts, and nested reasons) so report mapping can be validated visually before final PDF output changes. (~ src/components/UserBubble.tsx)
2026-02-24 / Add demo EID auto-submit status cue in workbench / Identity workbench now performs a one-time automatic EID report save for demo prospects once ID status is no longer pending, and surfaces explicit UI state chips (`Auto-submit: Saving…`, `Submitted`, `Failed`) so operators can see submission outcome immediately instead of waiting on document-list refresh timing. Also routes post-trigger auto-save through the same `auto` path for consistent status handling. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-24 / Fix workbench ID chip + report mapping for production raw JSON / Normalised EID raw payload parsing to handle array-wrapped records, then sourced Overall/PEP/Address chip values from `checkStatuses` results so production records no longer show placeholder dashes. Updated verification failure extraction to the same shape and tightened generated report branding/metadata (Helix success/blue tokens + external reference/correlation rows) for accurate, on-brand PDF output. (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/services/verificationAPI.ts)
2026-02-24 / Standardise Enquiries Report header to ManagementDashboard / Restyled all header/filter controls in EnquiriesReport to match ManagementDashboard's visual language: borderRadius 0 everywhere (buttons, chips, tooltips, date range bar, filter indicator, action buttons), replaced all off-brand hex (#60a5fa, #bfdbfe, #cbd5f5, #E2E8F0, rgba(148,163,184,...), rgba(15,23,42,...)) with brand tokens from colours.ts, unified transitions to 0.18s cubic-bezier(0.4,0,0.2,1), removed translateY lifts on hover, standardised 0.5px borders, 32px height controls, 12px font. Moved Enquiries Report card to "In development" section in reports grid with orange accent. (~ src/tabs/Reporting/EnquiriesReport.tsx, ~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-24 / Fix annual leave blocking management dashboard / Annual leave fetch failure was poisoning all 4 non-streaming datasets (meta, GA, GAds) via Promise.all — replaced with Promise.allSettled so each dataset settles independently. Catch block now marks stuck datasets as 'error' instead of leaving them in 'loading'. handleReportCardClick no longer treats 'loading' as needing a fresh refresh (prevents re-entry loops). Safety timeout reduced from 10 min to 3 min. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-24 / Amalgamate Mine/All into Claimed chip + brand area filter / Mine and All are now peer chips inside the main filter bar — clicking Mine or All activates Claimed state and sets scope in one action. No separate "Claimed" label; the check icon on Mine makes it clear. Divider separates claimed scope from Unclaimed/Triaged. IconAreaFilter branded: borderRadius 0, navy container, full-opacity AoW-coloured borders on selected chips, colours from tokens (not raw hex). (~ src/tabs/enquiries/Enquiries.tsx, ~ src/components/filter/IconAreaFilter.tsx)
2026-02-24 / Brand enquiries filter bar / Redesigned StatusFilterWithScope, Mine/All toggle, Find Person, Add Contact, Card/Table view switcher, and person filter chip to Helix brand: borderRadius 0 everywhere, brand navy surfaces (dark.sectionBackground/cardBackground), accent (#87F3F3) active borders in dark mode, highlight (#3690CE) in light mode, Raleway 11px with letter-spacing, unified chipStyle/scopeChipStyle/countBadge factories. Triaged tab only renders for admin. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-24 / Animate All badge count settle / All badge now shows a breathing two-dot cue while team-wide data resolves, then the final count pops in with a spring-scale settle animation. Replaces the static dash placeholder. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-24 / Stabilise Mine/All toggle UX / Fixed 3 toggle issues: (1) All badge no longer flashes stale count — shows dash until team-wide data loads, then real count; (2) "Updating view" cue now fires on Mine↔All toggle within Claimed tab (was only firing on tab→dashboard); (3) background prefetch landing wrapped in startTransition to prevent jank/reflow when 5k-item dataset arrives. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-24 / Fix EID PDF preview crash on PNG parsing / Replaced the embedded Helix mark payload with a clean re-encoded PNG base64 and introduced `safeAddHelixMark` wrapping all `jsPDF.addImage` calls in header/footer/watermark so corrupt-image parse errors cannot crash `View Report`, `Download`, or `Save to Docs` flows. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-24 / Replace fabricated PDF logo path with real Helix asset / Removed custom `drawHelixMark` geometry from the EID PDF generator and switched header/footer branding to the real embedded Helix mark image (`mark192colour.png` base64). Also changed hero watermark fallback to no-op instead of drawing synthetic logo geometry, so preview/save paths never show manufactured branding when graphics state fails. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-24 / Rebrand EID verification PDF to instruct-pitch design / Rewrote buildRawRecordPdfBlob to match the instruct-pitch premium layout as an internal compliance record. Header: 135deg gradient (#061733→#054b87), white chevron mark + spaced firm name, instruction ref. Hero: white band with 3.5%-opacity brand watermark, title only — no fluff description. Overall result: coloured text (green/red/blue) without decorative badges. Status dots: simple fill circles, no checkmarks or tinted row backgrounds. Footer: #FAFAFA bg, #F3F4F6 border, SRA line, page/date, copyright in #6B7280. Stripped: contact details, teal accent bars, hero description, blue underline, green-tinted row backgrounds, checkmark-inside-dot, trust badges. (~ src/tabs/instructions/InlineWorkbench.tsx)
2025-02-25 / Fix pipeline rail pitched tick and risk branding / Pipeline rail pitched stage now checks enrichmentPitchData as fallback so demo prospects (and any enquiry with enrichment data loaded before timeline) correctly show the green tick. Compliance consideration labels in risk edit mode consolidated to single "I have considered:" header with short label names instead of repeating the prefix. Non-edit risk display updated to match edit form branding: translucent container (0.35 opacity), brand-token borders, tighter gap, "I have considered:" header on compliance row. (~ src/tabs/enquiries/EnquiryTimeline.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-24 / Increase recent-history WIP refill cadence / Tuned WIP scheduler windows to check recent historical fills more aggressively while keeping older history less frequent: hot tier now rolls 7 days hourly, warm tier 21 days every 6h, cold tier 56 days nightly. This improves catch-up of late Clio postings in recent weeks without over-prioritising old windows. (~ server/utils/dataOperationsScheduler.js)
2026-02-24 / Make coverage sync manual-only and keep month resync visible / Removed automatic month backfill on Data Centre entry so opening coverage no longer triggers sync-wip writes; month windows now sync only on explicit user action. Updated month-row sync icon styling to stay active-coloured after prior sync so current-month WIP windows (with current-week exclusion) still look and behave re-syncable. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-24 / Restore pitch checkout link in workbench pitch chip / Updated pitch-stage link rendering to fall back to passcode parsed from `InstructionRef` (`HLX-<prospect>-<passcode>`) when `Passcode` is missing in the payload, so Prospects > Overview > Workbench > Pitched now shows the checkout URL, passcode column, and passcode hint consistently for `CHECKOUT_LINK` deals. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-24 / Overhaul risk tab in workbench / Replaced off-brand green (rgba 115,171,96) with colours.green (#20b26c) in result badge; added medium-risk (orange) colour tier; merged score into result badge; hid assessor chip when empty; replaced noisy compliance confirmations data bar (4 columns + chevron links) with compact tick/cross pills that link to policy docs; added Jurisdiction and Source of Wealth to Q&A grid; shortened question labels; tightened row padding (8px→6px). Also fixed 170 remaining U+FFFD encoding issues file-wide. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-24 / Clean up Request Documents modal / Fixed 14 corrupted U+FFFD characters (bullets, em-dashes, ellipses) rendering as ?? in the email template preview. Reduced visual noise: removed redundant description paragraph and What happens box, replaced verbose template header with concise Email preview, tightened header/icon sizes and section spacing, capped template preview at 200px. Clarity of recipient/subject/draft-only behaviour preserved. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-24 / Inline EID review actions into identity workbench / Replaced the portalled EID Needs Review modal with an inline review actions strip shown directly in the identity tab when the EID result is review/fail. The strip shows a warning message with Approve and Request Docs buttons side-by-side, removing the extra click needed to see the options. Removed the showEidActionModal state and portal. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-24 / Fix claim timestamp resolution in workbench / Claim time now resolves from enrichmentTeamsData.ClaimedAt (preferred), then enquiry.claim field, then enrichment MessageTimestamp/CreatedAt. Previously, enquiries with no Teams bot message and no claim column showed no claim time. Also fixed submissionDateRaw field priority to prefer datetime for new-space enquiries. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-24 / Reorder pipeline in EnquiryTimeline / Swapped payment and identity stages so payment appears before ID in the prospects overview pipeline rail. Updated StageType, stage array, and isStageType guard to match. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Remove diamond fallback glyphs in identity strip / Replaced replacement-character (`\uFFFD`) fallbacks with em dash in the inline workbench identity summary for Type, DOB, Gender, ID Type, and passport/license number displays, and made passport icon matching case-insensitive so Passport values consistently show the icon. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-23 / Align pipeline checkmarks and separate light-mode shell fills / Forced journey pills to row layout so completion ticks stay at the pill end (not below), increased subtle light-mode pill contrast (inactive fill/border and active tint), and separated pipeline rail vs workbench-header fills in light mode to remove visual blending. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Show selected pipeline pill in workbench header / Replaced the static "Workbench" shell header in Prospect Overview with the active pill context (icon + label), so the dropped workbench area clearly reflects the currently selected journey stage/tab. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Fix modal headers and card fills in Resources and Forms / Replaced remaining off-brand header and card-fill literals in the active Resources and Forms modals with canonical Helix surface/border/text tokens, including section header accents, hover fills, and toast surfaces for consistent brand rendering in both views. (~ src/components/ResourcesModal.tsx, ~ src/components/FormsModal.tsx)
2026-02-23 / Fix workbench ID readiness stale/missing source data / Updated InlineWorkbench to hydrate instruction data from `/api/instructions/:instructionRef` when the inline payload lacks core identity fields, and to pass the active instruction ref into refresh callbacks so post-verification updates no longer no-op. This prevents false "Date of birth/Address/ID document missing" states for instructed records with valid instruction data. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-23 / Re-run ID verification for HLX-01141-75366 / Debugged prospect ID-check mismatch using instant lookup, confirmed instruction data existed but `IDVerifications` was empty, then triggered `/api/verify-id` to persist a fresh verification record (overall review, with check ID and expiry) so Overview ID Check now has backing data. (~ logs/changelog.md)
2026-02-23 / Align timeline pills to production chip rhythm / Refined prospect journey pills to match production-like pipeline composition from git references: icon+label grouped on the left with a dedicated trailing tick slot on the right for completed stages, improving spacing consistency across complete/incomplete chips while keeping scenario/action icons intact. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Restyle journey chips as pills with inline completion tick / Updated prospect journey stage controls to true pill chips with side-by-side icon and label, and moved completion indicator to an inline trailing tick at the end of each completed pill (removing corner-badge treatment) to match current production timeline styling direction. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Soften light-mode journey borders and restore scenario-driven pitch icon / Reduced harsh light-mode borders and separators in the journey/workbench shells by switching to Helix light border/surface tokens for cleaner transitions while navigating stages; updated the Pitch stage to use scenario-specific action icons (call/email/warning/progress/CFA) instead of a generic tick as the primary stage icon, with completion still shown as a subtle corner cue. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Add subtle top-right completion cue to journey pills / Kept action icons unchanged on completed pipeline stages and added a small top-right green tick badge as a low-noise completion marker so completion state is visible without replacing stage semantics. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Set incomplete journey circles to neutral Helix grey / Updated pipeline journey tone mapping so incomplete/current circles use neutral Helix grey (`subtleGrey`/`greyText`) instead of orange, keeping orange reserved for warning semantics and review cues. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Show hero case chip for single-case records / Updated hero case-row visibility logic to render when at least one case exists (not only when multiple), so single-case prospects still show explicit active case context in header. (~ src/tabs/enquiries/components/ProspectHeroHeader.tsx)
2026-02-23 / Improve hero case-chip clarity and active-state readability / Refined header case chips for clearer scanning: stronger section label contrast, increased chip size/padding, stronger active tint/border emphasis, improved hover affordance, and explicit ACTIVE marker on selected case while preserving existing selection wiring and brand-token palette. (~ src/tabs/enquiries/components/ProspectHeroHeader.tsx)
2026-02-23 / Standardise hero metadata row with icons and remove ref / Updated Prospect hero header metadata to a consistent icon+value pattern for all fields, removed case-specific ref from header metadata, and kept only ID using the ActiveCampaign icon treatment for the ID field. Added matching icons for area, date, and PoC so header values read as one coherent metadata system. Removed now-unused `instructionRef` prop from EnquiryTimeline hero call. (~ src/tabs/enquiries/components/ProspectHeroHeader.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Return case controls to hero and standardise case fills to brand tokens / Removed the separate case-control strip above the pipeline (including its summary label) and restored case boxes within the hero header, separated by the existing subtle horizontal divider. Updated hero case-chip background states to use brand-aligned token fills only (active tint, hover cardHover/highlightBlue, idle websiteBlue/grey) to eliminate non-brand background treatment. (~ src/tabs/enquiries/EnquiryTimeline.tsx, ~ src/tabs/enquiries/components/ProspectHeroHeader.tsx)
2026-02-23 / Move case tabs above pipeline and remove pipeline summary banner / Removed the lower pipeline banner summary strip and introduced a dedicated, prominent case-tab row above the pipeline in Prospects overview so active case context clearly drives what appears in journey/workbench/timeline. Added explicit active-state treatment and stronger visual hierarchy for case tabs, and disabled the hero’s internal case selector via new `showCaseSelector` prop to avoid duplication. (~ src/tabs/enquiries/EnquiryTimeline.tsx, ~ src/tabs/enquiries/components/ProspectHeroHeader.tsx)
2026-02-23 / Restore cleaner pipeline as circle-led pills with in-pill labels / Refined journey controls to cleaner icon-led pills (circle status icon + label inside each pill), removed secondary stacked status text, tightened spacing, and switched to sharper corners for a less noisy Helix look while preserving existing stage-click/workbench wiring and connectors. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Darken journey tray and flatten embedded workbench first tabs / Switched prospects journey tray from helixBlue to darker websiteBlue for a distinct but calmer surface relative to the hero header, removed duplicate workbench header status-dot cues, and added `flatEmbedMode` to InlineWorkbench for overview embedding. In flat embed mode, Details/Identity tab wrappers render without card-like outer fills/borders so content sits directly in the dropped websiteBlue workbench area while keeping all existing data wiring and tab logic intact. (~ src/tabs/enquiries/EnquiryTimeline.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-23 / Refine journey tray + dropped workbench shell hierarchy / Switched the journey tray fill to Helix mid-surface (`helixBlue`) to stay distinct from the hero’s darkBlue while avoiding bright light-blue emphasis; kept pipeline as compact pills with lower-chroma visual treatment and focused cueing for completion/action-needed states. Added a browser-style drop shell under the tray to encapsulate the websiteBlue workbench area, including a subtle top rail and consistent container boundaries so the pipeline/workbench stack reads as one deliberate interaction surface. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Tone down journey strip and rebalance workbench hierarchy / Reduced pipeline journey prominence to a quieter Helix baseline: removed extra journey heading copy, removed duplicated per-stage state badges, softened active/pending colours, reduced pill sizes, and simplified signal row to low-chroma inline cues with separators. Restored embedded workbench header behaviour to compact mode by disabling context stage chips and tab-stage headers in the overview embed so workbench content hierarchy remains consistent with the streamlined journey bar. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Fix EnquiryTimeline parse error at day header border styles / Replaced template-literal border declarations in grouped-table day header with string concatenation to remove parser-sensitive nested quoting and clear the reported unterminated string lint error at line 6093. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Rework prospect journey strip into actionable status pills / Rebuilt the Prospects overview pipeline from circle nodes into connected journey pills with explicit state tags (Complete/Next/Review/Pending/Locked), brand-token colouring, active-stage emphasis, and preserved click-through mapping to workbench tabs/context stages. Added Journey header guidance and upgraded the signal row into compact status chips (days open, recency, activity counts, next action) for clearer operational cues. Aligned embedded InlineWorkbench controls by enabling context stage chips and tab stages so journey, workbench, and timeline use the same stage model. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Prospect hero v4 — compact identity bar, no duplication / Stripped ProspectHeroHeader to a single-row compact bar: AoW colour dot + client name + subtle inline metadata tags (area, ID, ref, date, PoC) + contact cluster (email/phone with copy buttons) + CTA buttons (Pitch, Docs/Workspace). Case selector row appears only when >1 case. Removed all duplicate info that belongs in pipeline/workbench: status badge, next action, portal link, expiry label, two-column expanded body, chevron collapse/expand, AoW icon badge. Removed isHeroExpanded state and localStorage persistence from EnquiryTimeline. Cleaned props interface — dropped expiryLabel, instructLink, portalClientView, portalNextAction. Fixed case chip colours: active uses AoW border + tinted bg, hover uses dark.cardHover/highlightBlue brand tokens. (~ src/tabs/enquiries/components/ProspectHeroHeader.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Rebalance Matter Overview — demote portal, compact metrics / Removed portal-centric UI: dropped "Open Client Portal" and "Push to Portal" Next Steps chips, replaced "Portal & Connections" sidebar section with compact Reference block (key dates, CCL status, instruction ref, subtle portal pill). Replaced 4 metric card grid with inline KPI strip (WIP/Outstanding/Funds/Hours as labelled values, no card borders). Added "Outstanding Balance" Next Steps chip when balance >0. Stripped all tab panels to minimal content: Activities/Billing show inline KPI strips + empty states, Documents shows inline CCL status line + empty state, Communications shows inline contact links + empty state. Removed all roadmap placeholder cards. Added kpiStripStyle/kpiItemStyle/tabEmptyStateStyle to styles. Cleaned up unused imports. (~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/matters/styles/matterOverview.styles.ts)
2026-02-25 / Prospect Overview v3 — collapsible hero, pipeline+signal strip, flat workbench / Rewrote ProspectHeroHeader as a collapsible identity header: always-visible bar with AoW icon, name, status badge, and chevron toggle; collapsed mode adds inline area/ref, icon-button shortcuts (email, phone, pitch), and next-action cue; expanded mode shows full two-column layout (metadata stack + cases left, contact/CTAs/status right) with smooth max-height/opacity transitions. Added isHeroExpanded state in EnquiryTimeline with localStorage persistence (default: expanded). Restructured pipeline section: removed side borders, wrapped in subtle background container, added signal footer row below stage nodes showing days-open (red >30d), last-activity recency (orange >7d), activity counts (emails/calls/pitches/docs with icons), and right-aligned next-action cue in accent. Removed workbench card wrapper — InlineWorkbench now renders flat without bordered container, creating a deliberate hierarchy: hero card → pipeline+signal strip → flat workbench → timeline section. (~ src/tabs/enquiries/components/ProspectHeroHeader.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-25 / Prototype Matter Overview command centre / Enabled all locked matter detail tabs (Activities, Documents, Communications, Billing). Enhanced Overview with dynamic Next Steps chips (CCL status, Open Client Portal, Push to Portal, Matter Closed), replaced sidebar Quick Info with Portal & Connections section (portal link, CCL status indicator, key dates, quick reference IDs). Added tab panel content: Activities (time metrics + timeline roadmap), Documents (CCL card + portal docs + template library roadmap), Communications (client contact + portal messages + email history roadmap), Billing (WIP/Outstanding/Funds metrics + transaction history roadmap). New tab panel styles in matterOverview.styles.ts. (~ src/tabs/matters/Matters.tsx, ~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/matters/styles/matterOverview.styles.ts)
2026-02-25 / Redesign Prospect hero to two-column layout / Rewrote ProspectHeroHeader as a clean two-column card: left column holds the hero name, vertical metadata stack (Area, ID, Ref, Date, PoC, Expiry), and case line items; right column holds contact details (email/phone with copy), CTA buttons (Build Pitch, Workspace), and status badge with next action. Removed the rejected ProspectStatusBar signal-card strip (5 noisy boxes). Cleaned up ProspectOverview.css by removing status-bar classes and statusFadeIn animation. Tightened hero→pipeline→workbench vertical rhythm with connecting side borders for a single cohesive surface. (~ src/tabs/enquiries/components/ProspectHeroHeader.tsx, ~ src/tabs/enquiries/styles/ProspectOverview.css, - src/tabs/enquiries/components/ProspectStatusBar.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Rebrand active Resources modal surface / Updated the actual rendered resources modal component to Helix tokens (dark/light surface palette, border + header shell, panel/card styling, action controls, and selected-resource header) and removed legacy slate styling that caused washed-out visuals in the live Resources view. (~ src/components/ResourcesModal.tsx)
2026-02-23 / Deep purge of washed-out colours and broken CSS in Resources / Fixed ResourceCard.css tab styles using non-existent CSS variables (--surface-muted, --surface-elevated, --border-subtle) — replaced with actual design-tokens.css vars (--surface-card, --surface-card-hover, --border-base) with fallbacks. Replaced all 34 borderRadius violations (6/8/10/12) with 0 across Resources.tsx modal operations. Upgraded all body text from washed-out tertiary tokens (subtleGrey #A0A0A0 / greyText #6B6B6B) to proper body-text hierarchy (#d1d5db dark / #374151 light). Strengthened ResourceCard icon button idle colour from grey to primary text. (~ src/tabs/resources/Resources.tsx, ~ src/tabs/resources/ResourceCard.tsx, ~ src/app/styles/ResourceCard.css)
2026-02-23 / Remove off-brand shades from Resources surfaces / Replaced remaining hardcoded hex and rgba colours in Resources modal flows/cards/CSS with canonical Helix tokens and theme variables (error states→`cta`, neutral text→`subtleGrey/greyText`, light surfaces→`light.cardBackground/sectionBackground`, icon accents→`highlight`) to fully align the Resources UI with brand palette rules. (~ src/tabs/resources/Resources.tsx, ~ src/tabs/resources/ResourceCard.tsx, ~ src/tabs/resources/ResourceDetails.tsx, ~ src/app/styles/ResourceCard.css)
2026-02-23 / Fix ResourceActionCard className typing / Corrected style helper return types to class-name strings (`mergeStyles` output) so `className` props compile cleanly and Resources build errors are resolved. (~ src/tabs/resources/ResourceActionCard.tsx)
2026-02-23 / Rebrand Resources tab to Helix surface language / Updated Resources look-and-feel to match the Helix reference composition: flattened card/panel geometry (zero-radius), token-based dark/light surfaces and borders, reduced legacy shadowing, and brand-consistent hover/focus treatments across resource cards, action cards, details forms, and section/footer containers. (~ src/tabs/resources/Resources.tsx, ~ src/tabs/resources/ResourceCard.tsx, ~ src/tabs/resources/ResourceActionCard.tsx, ~ src/tabs/resources/ResourceDetails.tsx, ~ src/app/styles/ResourceCard.css)
2026-02-23 / Switch navigator dark-mode accents to white / Updated navigator surfaces (Overview, Pitch Builder, Matters, Reports navigators) to use white instead of teal accent in dark mode for active text, underline indicators, hover fills, and back-button icon/hover states so contrast matches non-websiteBlue navigator backgrounds. (~ src/components/NavigatorDetailBar.tsx, ~ src/app/styles/CustomTabs.css, ~ src/app/styles/NavigatorPivot.css)
2026-02-23 / Re-anchor custom tab underline to inner edge / Tuned CustomTabs underline position from `bottom: 5px` to `bottom: 1px` so the indicator no longer floats and now sits against the inner bottom edge of the tab bar. (~ src/app/styles/CustomTabs.css)
2026-02-23 / Move custom tab underline inside nav bar / Adjusted main CustomTabs underline indicator from edge-aligned to in-bar placement (`bottom: 5px`) so active/hover underlines sit visibly within the tab strip instead of appearing on or below the bar boundary. (~ src/app/styles/CustomTabs.css)
2026-02-23 / Revert custom tab control to phased-out default-off flag / Corrected Session Filters and App tab wiring to use `showPhasedOutCustomTab` (default OFF) instead of `showClientsTab`, with nav label restored to `Custom (phased out)` and `navigateToInstructions` falling back to Prospects when the phased-out tab is disabled. (~ src/components/UserBubble.tsx, ~ src/app/App.tsx)
2026-02-23 / Add Clients tab toggle to session filters / UserBubble Session Filters now includes a persisted `Show Clients tab` toggle (default ON), and App tab rendering/navigation now honours it by showing or hiding the Clients tab and safely routing `navigateToInstructions` to Prospects when disabled. (~ src/components/UserBubble.tsx, ~ src/app/App.tsx)
2026-02-23 / Group nav tabs with centred separators / Added centred `|` separators in CustomTabs after `Matters` (before `Forms`) and, when `Reports` is present, after `Resources` (before `Reports`) to visually group the tab strip like the existing Home/Prospects split. (~ src/app/styles/CustomTabs.tsx)
2026-02-23 / Restore Clients tab for all users in production / Reverted phased-out custom-tab gating: nav label is now `Clients`, visible to all users (including production), `navigateToInstructions` always opens it, and instruction fetch no longer blocks non-legacy users; removed the temporary UserBubble session toggle tied to phased-out custom tab visibility. (~ src/app/App.tsx, ~ src/components/UserBubble.tsx)
2026-02-23 / Add session toggle for phased-out custom tab and reorder user bubble controls / UserBubble now places Admin controls and Local dev clusters above Session Filters, and Session Filters includes a new local toggle to show/hide the `Custom (phased out)` tab; tab visibility in App now honours this persisted toggle while still respecting local/prod-preview and legacy-access gates. (~ src/components/UserBubble.tsx, ~ src/app/App.tsx)
2026-02-23 / Redesign enquiry + pitch context as hero cards / Rebuilt the enquiry context and pitch context sections in InlineWorkbench to match ProspectHeroHeader's intentional design language: darkBlue gradient card surface with AoW left accent border, 40px AoW icon badge, hero name (15px/700), inline label/value meta tags (9px uppercase labels, 11px values), dividers between sections, copyable email/phone buttons, ActiveCampaign + Teams integration chips, rating badge with click-to-rate, structured key info strip (Claimed By, Value, Method, Source). Pitch card adds status badge with colour coding, pitched datetime chip, amount highlight, deal/ref/passcode inline tags, service description, and expandable pitch email preview. Both cards use shared surface tokens (textPrimary, textMuted, textBody, dividerColour) for dark/light mode consistency. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-23 / Hide Clients nav in production and localise phased-out custom tab / Main nav now hides the Clients surface in production (and in local Production Preview), exposes it locally as `Custom (phased out)`, and preserves legacy deep-link access for existing instruction-triggered flows while migration to Prospects Overview continues. (~ src/app/App.tsx)
2026-02-23 / Standardise Matter Overview to dashboard look and feel / Aligned the Matter detail/overview page to the Management Dashboard canonical card pattern: darkBlue surfaces, borderRadius 0, 0.5px borders with borderColor66 token, Raleway font, no heavy shadows. Updated all 11 style functions in the extracted styles file (container, header, metricCard, sectionCard, sectionTitle, leftColumn, rightColumn, clientActionButton, metricLabel, SURFACE_RADIUS, BADGE_RADIUS). Fixed inline styles for PipelineSection wrapper, Next Steps bar, Fetch from Clio button, audit toggle, and pipeline placeholder. Updated skeleton loading state in Matters.tsx. (~ src/tabs/matters/styles/matterOverview.styles.ts, ~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/matters/Matters.tsx)
2026-02-23 / Brand-align InlineWorkbench claimed + pitch containers / Replaced all raw rgba() colours with brand tokens in the enquiry context and pitch context panels: chip backgrounds→`${colours.highlight}18`, labels→`colours.subtleGrey`/`colours.greyText`, text→`colours.dark.text`/`colours.light.text`, separators→`colours.dark.border`/`colours.grey`, body text→`#d1d5db`/`#374151`. borderRadius→0 throughout. Fixed `resolveAowAccent` to use canonical `colours.` AoW tokens instead of raw RGB. Pipeline tabs background→`colours.dark.sectionBackground`. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-23 / Replace daysOpen with expiry + instruct portal link / Removed unclear "4d open" stamp from hero ref tags. Added Expiry tag showing live workspace countdown (e.g. "Expires in 12d 3h" or "Expired" in CTA red). Added Portal link tag that opens the client's instruct workspace in a new tab. (~ src/tabs/enquiries/components/ProspectHeroHeader.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Redesign case chips as inline tab strip / Replaced chunky multi-line card chips with sleek single-line tab buttons: AoW colour dot + "Type · £Value" text, bottom-border underline for active (not left-border block), subtle AoW-tinted background on active, no off-brand blues. Added "Cases" micro label. (~ src/tabs/enquiries/components/ProspectHeroHeader.tsx)
2026-02-23 / Fix hero surface to Helix brand composition / Replaced cardBackground (#081c30) with darkBlue (#061733) + UserBubble left-edge gradient (highlight at 10% fading to 0%), inset shadow structure, 0.5px subtle border. Fixed borderRadius to 0 on card, icon badge, and status pill. Active case chip now uses helixBlue instead of cardHover. (~ src/tabs/enquiries/components/ProspectHeroHeader.tsx)
2026-02-23 / Refine hero ref tags + redesign pipeline as connected stepper / Hero: ID now shows acid (enquiry DB ID) in Raleway, added Ref tag for InstructionRef, Opened→Touchpoint, PoC shows full name resolved from teamData. Pipeline: replaced flat button cards with horizontal stepper — circular icon nodes connected by progress lines, active node elevated with glow, labels centered below, connector fills green between complete stages. (~ src/tabs/enquiries/components/ProspectHeroHeader.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Brand-align prospect banner + integrate case chips / Fixed dark mode surface tokens to use brand depth ladder (cardBackground, cardHover, grey) instead of hardcoded hex. Replaced all font declarations with Raleway/Segoe UI/sans-serif stack matching MatterPortal. Integrated ProspectCaseChips into the banner card as a bottom extension with left-accent active state and highlightBlue selection, removing standalone render. (~ src/tabs/enquiries/components/ProspectHeroHeader.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Rebuild prospect overview to MatterPortal banner-card pattern / Complete rework of ProspectHeroHeader using instruct-pitch MatterPortal design language: elevated card with left AoW accent border, 48px area icon, large hero name, ref tags (Area · ID · Opened · PoC · days open), portal status pushed right, subordinate contact row + CTAs below divider. Removed inline portal strip (Tier 2.5) — info now in banner. Pipeline tabs cleaned: flex-grow, left accent border on active, subtle shadow, 2px radius. (~ src/tabs/enquiries/components/ProspectHeroHeader.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Amalgamate prospect identity, contact, and CTAs into one strip / Rebuilt Tier 1 as a single unified menu/header strip containing client name, email chip, phone chip, Build Pitch, and Request Docs/Workspace controls in one consistent horizontal control surface with existing behaviour preserved. (~ src/tabs/enquiries/components/ProspectHeroHeader.tsx)
2026-02-23 / Shift prospects workbench to page-canvas layout / Removed boxed separator framing from header/case/portal/pipeline bands so the page acts as the canvas, then reworked pipeline header pills into consistent tab-style cards with unified label + status descriptor hierarchy across all stages for clearer strategic scanning. (~ src/tabs/enquiries/EnquiryTimeline.tsx, ~ src/tabs/enquiries/components/ProspectHeroHeader.tsx, ~ src/tabs/enquiries/components/ProspectCaseChips.tsx)
2026-02-23 / Fix squashed prospects header buttons / Added no-shrink sizing rules and minimum dimensions for contact chips and CTA buttons in the Tier 1 header so controls keep consistent modern proportions under tighter widths. (~ src/tabs/enquiries/components/ProspectHeroHeader.tsx)
2026-02-23 / Rework prospects header to modern control layout / Rebuilt the Tier 1 header into a cleaner modern split layout: larger name focus, inline contact chips with copy affordances, and stronger right-aligned CTA hierarchy (Build Pitch primary, Request Docs/Workspace secondary). Removed “Prospect Header Contract” text and preserved all existing interactions. (~ src/tabs/enquiries/components/ProspectHeroHeader.tsx)
2026-02-23 / Revamp prospects header hierarchy and token styling / Updated Tier 1 prospects header to a visibly cleaner Helix control band: token-based dark/light surfaces and borders, clearer name hierarchy, neutralised contact chips, and stronger Build Pitch / Request Docs CTA emphasis while preserving all existing click behaviour and workspace routing. (~ src/tabs/enquiries/components/ProspectHeroHeader.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-23 / Simplify prospects case chips to core meaning / Reduced Tier 2 case selector chips to a cleaner two-line hierarchy (Type of Work + concise area/value metadata), removing tertiary date/POC detail and decorative rail/chevron elements so selection intent is clearer and scanning is faster in both themes. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-22 / Reframe prospects overview to matter-portal concept / Reworked the overview strip between case chips and pipeline pills to reflect the actual client-portal contract: “Client View” (No Portal Yet / Instruction Intake / Pending Review / Your Matters), “Next Action” for fee earners, and compact contract keys (`/pitch/<passcode>`, InstructionRef, Matter). Replaces technical badge clutter with purpose-led journey state. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-22 / Build portal-readiness overview band / Redesigned the prospects overview control band for purpose (prospects → instruct → matter portal): added a compact “Matter Portal” readiness strip showing stage state, InstructionRef, clean portal link readiness (`/pitch/<passcode>`), and matter-open status; unified it with the same darkBlue/grey banner surface and Helix token borders for case chips + pipeline context. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-22 / Align case-and-pipeline banner surface / Unified the shared banner behind prospects case chips and workbench pipeline pills to a single on-brand surface (`darkBlue` in dark mode, `grey` in light mode) and matched separator hairlines to `dark.borderColor`/`greyText` alpha for consistent visual framing. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-22 / Correct case chip off-brand colours / Tightened prospects case chips to flat Helix tokens: removed raw white backgrounds and alpha-heavy highlight treatments, switched to grey/card backgrounds, darkBlue active fill, neutral metadata/value text, and transparent chevron disc for cleaner brand-consistent hierarchy. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-22 / Simplify case chip colour hierarchy / Prospects overview case chips now use a cleaner, clearer palette: removed multi-colour area tints and stage micro-pips, switched active state to single highlight border/rail, normalised metadata text to subtleGrey/greyText, and kept one emphasis colour for value. Result is simpler scanning and less visual noise. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-22 / Purposeful case chip redesign / Case selector chips now communicate purpose: primary label shows Type_of_Work (e.g. "Contract Dispute") instead of generic "Case 1", area name appears as a colored uppercase tag only when different from type, enquiry Value renders as £-formatted amount in accent colour, and 4 micro stage pips (enquiry→pitch→instruction→matter) show pipeline progress per case — active case derives from stageItemsState, inactive uses Matter_Ref heuristic. Replaces previous cosmetic-only token pass. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-22 / Restyle TIER 2 case chips to brand tokens / Case selector cards in the prospects click-through overview now use canonical Helix palette: container background → sectionBackground/grey, borders → dark.border hairlines, active chip → darkBlue with borderColor and inset shadow, inactive → cardBackground, metadata text → subtleGrey/greyText tokens, chevron indicator → highlight (not accent/teal), borderRadius → 0, transition curve unified to style guide 0.2s ease pattern. Eliminates ~20 raw rgba values. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-22 / Remove horizontal line from matters day separators / Removed the gradient horizontal rule from matters date-range separator rows to match the cleaner prospects pattern (dot + label + count only, no spanning line). (~ src/tabs/matters/MatterTableView.tsx)
2026-02-22 / Match page background to table surface / App root background changed from websiteBlue (#000319) to dark.background (#020617) in dark mode, matching the table scroll container so there's no colour shift where content ends. (~ src/app/App.tsx)
2026-02-22 / Fix colour bleed and padding after table end / Parent wrapper background changed from transparent to dark.background so websiteBlue (#000319) no longer bleeds through below the table. Infinite scroll loader divs switched from visibility:hidden to conditional rendering so they occupy zero space when all items are loaded — removes the 20px gap after the last row. Applied to both card and table view loaders. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-22 / Timeline dot: smaller + highlight colour / Day separator dots reduced from 6px to 4px and colour changed from teal accent to highlight-blue (rgba(highlight-rgb, 0.78)) so dots visually connect with the date label. Hover glow also switched from accent-rgb to highlight-rgb. (~ src/app/styles/Prospects.css)
2026-02-22 / White headers and action button tint fix / All table headers (enquiries + matters) now use colours.grey (white) as default text colour instead of accent (teal). Active sort columns use colours.highlight (brand blue) for contrast. Matters header background aligned to darkBlue and border style matched to prospects. Action button surfaces switched from cardBackground/cardHover to darkBlue/helixBlue across ActionsCell, GroupedEnquiryCard, Enquiries child rows, and MatterTableView to eliminate green tint on certain displays. Action button hover accent changed from teal to brand blue highlight. Matters row striping, hover intensity (0.16), and border-bottom aligned to prospects CSS pattern. (~ src/tabs/enquiries/Enquiries.tsx, ~ src/tabs/enquiries/components/ActionsCell.tsx, ~ src/tabs/enquiries/GroupedEnquiryCard.tsx, ~ src/tabs/matters/MatterTableView.tsx)
2026-02-22 / Matters table full Helix visual overhaul / Replaced entire slate-grey colour palette (rgba(148,163,184,...), rgba(203,213,225,...)) with brand tokens throughout MatterTableView. Surfaces now use colours.dark.background/cardBackground/cardHover. Row striping flattened to near-invisible (matching enquiries table). Copy button borderRadius fixed from 5 to 0. Action button surfaces switched to solid brand tokens with highlight hover. Timeline dots/lines use highlight channel instead of generic grey. Day separator label/count/gradient moved to brand tokens. Sort indicator, practice area, and date text use subtleGrey/greyText tokens. Row hover uses highlight-tinted rgba for consistency. (~ src/tabs/matters/MatterTableView.tsx)
2026-02-22 / Pipeline chip hover: individual label reveal only / Removed row-level staggered label+box expansion so only the specific chip being hovered reveals its label. Eliminates width accounting conflicts and feels more intentional. POC claimed chip refactored to use standard pipeline-chip-reveal/chip-box/chip-label pattern (Teams icon always visible, initials reveal on hover). Header labels now show full text (INSTRUCTION, EID CHECK, PAYMENT) in full+short modes, abbreviated only in icon mode. Initial label mode changed from 'short' to 'full' to prevent flash. (~ src/tabs/enquiries/Enquiries.tsx, ~ src/app/styles/Prospects.css)
2026-02-22 / Fix row hover green tint and action button fills / Pipeline row hover switched from accent-rgb (teal/green) to highlight-rgb (brand blue) so hover no longer looks green. Action button backgrounds switched from semi-transparent rgba to solid brand surface tokens (cardBackground/cardHover) across ActionsCell, grouped child rows, and GroupedEnquiryCard. GroupedEnquiryCard button borderRadius fixed from 8 to 0. (~ src/app/styles/Prospects.css, ~ src/tabs/enquiries/components/ActionsCell.tsx, ~ src/tabs/enquiries/Enquiries.tsx, ~ src/tabs/enquiries/GroupedEnquiryCard.tsx)
2026-02-22 / Fix pipeline chip cramping on page shrink / The measurement formula was undercounting by ~32px (missing the always-present 24px nav column + its gap) and a false 10px fit tolerance masked it. Unified to a single widthNeeded formula that matches the actual CSS grid, so chips now downgrade to fewer/icon mode promptly when width shrinks. (~ src/tabs/enquiries/Enquiries.tsx, ~ src/tabs/enquiries/components/useProspectTableState.ts)
2026-02-22 / Adjust instructed header chip label to Instr / Updated Prospects pipeline stage metadata so the instructed stage uses `Instr` in compact header chips, improving readability when width is constrained without changing stage behaviour. (~ src/tabs/enquiries/Enquiries.tsx, ~ src/tabs/enquiries/components/pipeline/types.ts)
2026-02-22 / Improve pipeline width recognition and carousel triggering / Tuned pipeline chip width thresholds and layout fit logic to use available column space more smoothly: reduced conservative short/full chip minimums, added fit tolerance, and introduced icon-mode full-fit fallback before forcing carousel. Applied in both active Enquiries table path and shared measurement hook for consistency. (~ src/tabs/enquiries/Enquiries.tsx, ~ src/tabs/enquiries/components/useProspectTableState.ts)
2026-02-22 / Differentiate date separators with subtle highlight hue / Shifted Prospects date-separator divider, timeline line, date label, and count badge from neutral grey to low-opacity highlight-blue channels so separators stay lightweight but no longer blend with other neutral line/bar cues. (~ src/app/styles/Prospects.css)
2026-02-22 / Remove intra-day row separators in prospects table / Eliminated border dividers between line items within the same day across both regular and grouped table rendering paths, keeping visual separation only on the date separator rows. (~ src/tabs/enquiries/components/ProspectTableRow.tsx, ~ src/tabs/enquiries/Enquiries.tsx)
2026-02-22 / Make date separator strip lighter and subtler / Rebalanced Prospects day-separator colours to avoid reading as its own bar by reducing divider/line intensity, muting label and count badge tones, softening hover tint, and removing the separator fade band. (~ src/app/styles/Prospects.css)
2026-02-22 / Restore date separator clarity in prospects table / Increased day-separator legibility with stronger divider and timeline line opacity, clearer date label hierarchy, and subtle highlight-tinted count badges while keeping flattened row striping intact. (~ src/app/styles/Prospects.css)
2026-02-22 / Flatten prospects row parity contrast further / Reduced alternate-row tint in both dark and light themes to near-whisper opacity so distinction is visible but no longer visually dominant. (~ src/app/styles/Prospects.css)
2026-02-22 / Soften grouped enquiry table contrast / Reduced grouped-table harshness by moving expanded child rows to website-blue base surfaces, toning child hover/muted states to subtle highlight-tinted overlays, and lowering dark-mode alternate stripe intensity so line separation stays visible but understated. (~ src/tabs/enquiries/Enquiries.tsx, ~ src/app/styles/Prospects.css)
2026-02-22 / Soften prospects table striping and separators / Refined Prospects table dark/light styling to match Management Dashboard’s cleaner visual rhythm by removing strong alternating bars, reducing day-separator contrast, muting separator count badges, and switching row hover emphasis to subtle highlight-tinted overlays with restrained borders. (~ src/app/styles/Prospects.css)
2026-02-22 / Correct prospects table canvas background path / Updated Prospects table view to use the page-level dark canvas in table mode and rethemed day-separator plus base row parity backgrounds to the current Helix surface ladder so the whole table plane no longer inherits the legacy section background look. (~ src/tabs/enquiries/Enquiries.tsx, ~ src/app/styles/Prospects.css)
2026-02-22 / Align enquiries table visual language with Home and Reporting / Applied a second composition pass to Prospects table controls by retheming sticky header carousel/action-lock states, pipeline connector/chip reveal CSS, mini pipeline chip inactive/next-action colours, and pipeline hover tooltip surfaces/text hierarchy to the same Helix accent/highlight-neutral balance used by Management Dashboard. (~ src/tabs/enquiries/components/ProspectTableHeader.tsx, ~ src/tabs/enquiries/components/pipeline/MiniPipelineChip.tsx, ~ src/tabs/enquiries/components/pipeline/PipelineHoverTooltip.tsx, ~ src/app/styles/Prospects.css)
2026-02-22 / Retheme extracted enquiries table row components / Updated the actual rendered Prospects table row components (ProspectTableRow, ActionsCell, PipelineCell) to remove legacy dimmed greys, unify row opacity and borders with Helix composition, and retune action/pipeline controls to token-based neutral plus accent/highlight behaviour in dark/light themes. (~ src/tabs/enquiries/components/ProspectTableRow.tsx, ~ src/tabs/enquiries/components/ActionsCell.tsx, ~ src/tabs/enquiries/components/PipelineCell.tsx)
2026-02-22 / Retheme enquiries table line items to Helix composition / Updated grouped child rows in Prospects table view (inside Enquiries.tsx) to use Helix dark/light surface ladder and token-driven borders, replaced legacy #061733/#0c2440 and grey-heavy action states, and restyled notes expansion panel plus icon controls to brand-consistent accent/highlight behaviour. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-22 / Redo prospects and matters tables to Helix composition / Rethemed Prospects and Matters table surfaces to the UserBubble-aligned dark/light ladder, removed off-brand action toggle blues and success greens, aligned sticky headers/rows/day groups to brand borders and accent states, and updated prospects row/date/value accents for theme-correct highlight vs accent behaviour. (~ src/tabs/enquiries/components/ProspectTableHeader.tsx, ~ src/tabs/enquiries/components/ProspectTableRow.tsx, ~ src/tabs/matters/MatterTableView.tsx, ~ src/app/styles/Prospects.css)
2026-02-22 / Fix EnquiryTimeline compile break from duplicate style keys / Removed duplicate `background` and `color` keys in timeline item badges and document-request button styles that caused TS1117 and blocked frontend compilation. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-22 / Align click-through prospects overview to brand tokens / Updated the clicked enquiry overview strip in EnquiryTimeline to use canonical Helix palette for stage pills and controls: pipeline strip background/border now uses dark.sectionBackground and light.background/grey, active pill light-mode fill moved from highlightBlue tint to highlight token alpha, inactive pill and docs badge surfaces/borders now use dark card/neutral greys, and timeline count/clear-filter controls now use tokenized subtleGrey/greyText instead of ad-hoc rgba values. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-28 / Fix off-brand colours across prospects table / Comprehensive colour audit and fix: replaced Tailwind slate/blue (rgba(100,116,139), rgba(96,165,250), rgba(59,130,246)) and non-brand rgba values with brand tokens from colours.ts. Table container bg now uses colours.dark.sectionBackground / colours.light.background. Header bg uses colours.darkBlue / colours.grey. Copy button borderRadius 5→0. All inline #20b26c→colours.green, #f3f4f6→colours.dark.text, value tiers→colours.highlight+alpha. POC dropdown bg→colours.dark.cardBackground, borderRadius 4→0. Added --accent-rgb + --highlight-rgb channel tokens to design-tokens.css. Prospects.css now uses rgba(var(--accent-rgb), opacity) for hover/border tints. Pitch CTA pulse amber→brand yellow. PipelineCell.tsx Tailwind slate→colours.greyText/subtleGrey. Zero compilation errors. (~ src/tabs/enquiries/Enquiries.tsx, ~ src/tabs/enquiries/components/ProspectTableRow.tsx, ~ src/tabs/enquiries/components/PipelineCell.tsx, ~ src/app/styles/Prospects.css, ~ src/app/styles/design-tokens.css)
2026-02-28 / Wire extracted components into Enquiries.tsx / Replaced ~1,960 lines of inline code in Enquiries.tsx with extracted components. Individual row rendering (~1,401 lines) now delegates to <ProspectTableRow />. Inline modal JSX (~558 lines) replaced with <SuccessMessageBar />, <RatingModal />, <PipelineTooltipPortal />, <EditEnquiryModal />, <ReassignmentDropdown />. Prop bundles (RowPipelineHandlers, RowActionHandlers, RowDisplayState, RowHoverHandlers, RowDataDeps) constructed before render and passed through. File reduced from 11,319 → 9,378 lines. Zero TypeScript errors. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-28 / Prospects page Phase 1 component extraction / Extracted ~2,500 lines of self-contained logic from the 11,252-line Enquiries.tsx god-component into 11 new files under src/tabs/enquiries/components/. Components: ProspectTableRow (row wrapper), PipelineCell (7-stage pipeline carousel), ActionsCell (6-button actions column), ProspectModals (RatingModal, EditEnquiryModal, ReassignmentDropdown, PipelineTooltipPortal, SuccessMessageBar). Hooks: useRowHover, useDayCollapse, useToast, useRating, useEditModal, usePipelineMeasurement, useReassignment. Shared: prospectDisplayUtils (16 display helpers), rowTypes (6 typed interfaces), barrel index.ts. Fixed borderRadius 12→0 and off-brand #3b82f6→colours.highlight in modals. All files compile clean. (+ src/tabs/enquiries/components/ProspectTableRow.tsx, + src/tabs/enquiries/components/PipelineCell.tsx, + src/tabs/enquiries/components/ActionsCell.tsx, + src/tabs/enquiries/components/ProspectModals.tsx, + src/tabs/enquiries/components/useProspectTableState.ts, + src/tabs/enquiries/components/prospectDisplayUtils.ts, + src/tabs/enquiries/components/rowTypes.ts, + src/tabs/enquiries/components/index.ts)
2026-02-22 / Add check-first option to submodule sync gate / Session-start sync flow now includes option 4 to run a position check before syncing, with clearer multi-line choices and `--sync-choice=check` support in sync-context. (~ tools/sync-context.mjs, ~ .github/copilot-instructions.md)
2026-02-22 / Require explicit submodule sync choice every context refresh / sync-context now prompts with a mandatory numbered choice on every interactive run so submodule sync intent is explicit each time. (~ tools/sync-context.mjs)
2026-02-22 / Prompt submodule sync scope during context refresh / sync-context now asks both whether to sync submodules and which specific submodules to sync (all or selected indexes), then reports exactly which were selected and updated. (~ tools/sync-context.mjs)
2026-02-22 / Add opt-in submodule sync prompt and explicit sync summary / sync-context now asks whether to sync submodules, confirms per-submodule updated/unchanged/failed status, and prints clear post-sync next-step guidance. (~ tools/sync-context.mjs)
2026-02-22 / Simplify submodule context refresh behaviour / Updated sync-context submodule refresh to stop performing implicit parent-repo staging cleanup so the tool only refreshes context mirrors. (~ tools/sync-context.mjs)
2026-02-22 / Advance instruct-pitch submodule pointer / Updated the parent repository to point at the latest `workspace` commit already checked out in instruct-pitch. (~ submodules/instruct-pitch)
2026-02-22 / Remove tab-app-clone submodule / Removed tab-app-clone from submodule registry and repository tree so only active submodules remain. (~ .gitmodules, - submodules/tab-app-clone)
2026-02-22 / Fix Outstanding Office Balances showing £0 / Two root causes: (1) Race condition — a useEffect fetching user-specific balances from /api/outstanding-balances/user/:entraId would overwrite richer firm-wide data delivered by the SSE stream, often replacing 127 records with 0. Removed the competing useEffect; the stream + client-side myOutstandingBalances filter is sufficient. (2) Premature zero — when normalizedMatters hadn't loaded yet, outstandingTotal returned 0 instead of null, so the card displayed £0 instead of the skeleton loading cue. Now returns null until matters are available, and isOutstandingLoading stays true until both data and matters are ready. Added ref guard (streamOutstandingReceivedRef) and diagnostic console logs. (~ src/tabs/home/Home.tsx)
2026-02-27 / Standardise all reports to Management Dashboard look / Aligned all report pages to use the Management Dashboard's canonical card pattern: darkBlue surface (#061733), borderRadius 0, 0.5px subtle border, no heavy shadows, gap 8, Raleway font. Replaced gradient backgrounds (rgba(15,23,42) blends), reportingFoundation tokens, borderRadius 10-12, and heavy box-shadows across 6 reports. Each report now uses a consistent surface() function matching the dashboard's summaryChipStyle. (~ src/tabs/Reporting/EnquiriesReport.tsx, ~ src/tabs/Reporting/AnnualLeaveReport.tsx, ~ src/tabs/Reporting/MetaMetricsReport.tsx, ~ src/tabs/Reporting/SeoReport.tsx, ~ src/tabs/Reporting/PpcReport.tsx, ~ src/tabs/Reporting/LogMonitor.tsx)
2026-02-27 / Add commit sanity guard to data syncs / Both syncCollectedTime and syncWip now check insert-vs-delete ratio before committing. If Clio returned less than 30% of what was deleted (>50 rows), the transaction rolls back and preserves existing data instead of committing a net loss. Prevents data loss from partial Clio API responses, timeouts, or auth failures. (~ server/routes/dataOperations.js)
2026-02-27 / Wrap data sync DELETE+INSERT in SQL transactions / Both syncCollectedTime and syncWip now run DELETE + batch INSERT + dedup inside a single SQL transaction. If the process crashes mid-insertion (e.g. Azure App Service restart), the transaction rolls back and existing data is preserved instead of being permanently deleted. Previously DELETE committed immediately and partial INSERT left the table with missing rows. (~ server/routes/dataOperations.js)
2026-02-21 / Replace agenda leave view with swimlane calendar / Replaced noisy per-day agenda list in AwayInsight expanded view with a compact calendar swimlane: person rows × working-day columns with continuous accent-tinted bars spanning each absence. Day header shows single-letter day name + date number. Week boundaries get a subtle separator. Month labels appear when days span multiple months. Much less repetitive than showing each person's name on every date row. (~ src/tabs/home/AwayInsight.tsx)
2025-02-23 / Clean Home page dead code and fix overlay / Removed ~100 lines of unused style constants (headerStyle, mainContentStyle, quickLinksStyle, tableAnimationStyle, versionStyle, subLabelStyle, actionsMetricsContainerStyle, favouritesGridStyle, peopleGridStyle, sectionContainerStyle, ACTION_BAR_HEIGHT, calculateAnimationDelay) and dead upcomingLeaveSummary/openUpcomingLeaveModal functions (leave view now in AwayInsight). Fixed isSwitchingUser overlay: borderRadius 10→0, replaced off-brand colours (#E2E8F0, rgba(125,211,252), rgba(15,23,42)) with composition tokens (websiteBlue rgba, accent-tinted border, #f3f4f6 text). Aligned AwayInsight wrapper margin to match TimeMetricsV2 padding (10px horizontal). (~ src/tabs/home/Home.tsx)
2026-02-22 / Restyle Operations dashboard to composition / Redesigned TimeMetricsV2 and EnquiryMetricsV2 to adopt UserBubble composition palette: websiteBlue container with accent left-border, accent-tinted card backgrounds (rgba 135,243,243,0.04), accent-tinted borders/hovers, white/opacity text hierarchy (0.5 labels, 1.0 values), flat hover (no translateY lift or box-shadow), accent-tinted progress bars and skeleton shimmers. Renamed header "Time Metrics" → "Operations" with helix-section-title class. Removed heavy blue fills and inset shadows. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-21 / Brand-align filter chips and compact date pickers / Replaced gradient active state on all filter chips with solid UserBubble composition (helixBlue dark / highlightBlue light, blue border, dark.text / helixBlue text). Compacted DatePicker inputs from 36px to 32px height with inline From/To labels. Aligned toolbar actions to top of date row. Removed drop shadows from active chips. (~ src/tabs/Reporting/ManagementDashboard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)
2026-02-21 / Purge teal accent from filter chips / Active border, hover text, and hover shadows in all three chip style functions (range, team, role) changed from accent teal (#87F3F3 / rgba 135,243,243) to highlight blue (#3690CE / rgba 54,144,206). Filter section label margin fixed from -2px to 4px so buttons no longer touch labels. (~ src/tabs/Reporting/ManagementDashboard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)
2026-02-21 / Unify filter chip and label styles / All four chip groups (date range, active members, role filter, inactive members) now share identical visual treatment: 12px font, 600/700 weight, gradient active state, subtle border, websiteBlue resting bg, no translateY lift, unified 0 10px padding. "Inactive people" label switched from inline styles to the shared filter-section-label CSS class. (~ src/tabs/Reporting/ManagementDashboard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)
2026-02-21 / Move toolbar controls inline and label filter sections / Dissolved standalone toolbar strip — status chip, refresh, disbursement toggle, and dataset info now sit in the date range row; role filter toggle moved next to team member buttons. Added uppercase section labels: "Date range", "Active members", "Filter by role". (~ src/tabs/Reporting/ManagementDashboard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)
2026-02-21 / Restructure Management Dashboard layout / Moved summary metric boxes to top of dashboard, extracted toolbar actions (status chip, disbursement toggle, refresh, role filter, info) into a new standalone toolbar strip, and unified all filter sections (date pickers, range presets, team slicer, role slicer) into a single flush panel — removed separate sub-container backgrounds, padding, and hover shadows so all rows align consistently inside one visual box. (~ src/tabs/Reporting/ManagementDashboard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)
2026-02-21 / Collapse area filter picker on entry / UserBubble Session Filters now keeps the Areas of Work picker collapsed by default with a header toggle (matching the collapsible Profile pattern), and it resets to collapsed each time the bubble opens. (~ src/components/UserBubble.tsx)
2026-02-21 / Fix UserBubble command centre off-screen open position / Rendered the UserBubble modal/backdrop via a portal to document.body so fixed positioning is anchored to the viewport instead of transformed parent containers, preventing top-middle off-screen opening. (~ src/components/UserBubble.tsx)
2026-02-21 / Fix report card section labels and hover tints / Production section label now uses subtleGrey (matching UserBubble sectionTitle pattern) instead of accent teal. Report card header hover and chevron hover changed from accent-teal tint to highlight-blue tint, eliminating the green-blue flash. Left border on Production section also normalised to subtleGrey to match other sections. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-21 / Fix Reporting navigator background to match brand / Reporting navigator was using sectionBackground (#051525) instead of darkBlue (#061733) — the canonical brand colour used by FilterBanner in Enquiries. Fixed background, border-bottom, and removed off-brand boxShadow/borderTop. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-21 / Fix fee earner and role button all-selected visual state / When no specific filter is active (all team members/roles implicitly selected), buttons now show a subtle "included" treatment — faint accent-tinted border and slightly elevated background — so the default state no longer looks like nothing is selected. Both team slicer and role slicer buttons receive the treatment, including inactive members. (~ src/tabs/Reporting/ManagementDashboard.tsx)
2026-02-21 / Purge non-brand shades and refine table rows / Replaced every remaining rgba approximation in toolbar controls (buttons, chips, icon buttons, preset groups) with solid canonical brand hex tokens from the dark surface ladder (#051525, #081c30, #0D2F60, #F4F4F6). Merged standalone reassurance row into the status chip so sync/countdown info sits inline with all other 32px toolbar controls. Normalised all toolbar element heights to 32px (icon buttons, status chip, disbursement toggle). Table rows: muted name column at rest (neutral grey, weight 500), name highlights to accent on hover only, added subtle even-row alternation for both themes, added brand-tinted row hover backgrounds, softened inactive left border from 3px solid to 2px at 40% opacity. (~ src/tabs/Reporting/ManagementDashboard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)
2026-02-21 / Correct toolbar hover palette and contrast to Helix brand / Replaced non-brand hover shades in the reporting toolbar with canonical Helix tones and fixed dark-mode hover contrast issues that produced dark-on-dark text. Converted role/info icon state colouring to class-driven styling so hover/active states are consistently accent-highlighted, aligned date/status/icon/tool surfaces to the brand dark ladder, and tuned glows to highlight/accent only. (~ src/tabs/Reporting/ManagementDashboard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)
2026-02-21 / Redesign reporting toolbar into unified control system / Rebuilt the Management Dashboard header/tool area to behave like one coherent Helix control surface (date stamps, status chip, disbursement toggle, refresh/role/info icons, reassurance strip). Removed border-heavy treatment and replaced with consistent soft-surface controls, shared motion profile, and aligned state design (idle/hover/active/refreshing) across all header tools. Eliminated inline date-hover handlers in TSX, introduced class-based toolbar control hooks, and made disbursement toggle visually stateful while keeping interactions consistent with the rest of the toolbar. (~ src/tabs/Reporting/ManagementDashboard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)
2026-02-21 / Comprehensive reactivity pass across Management Dashboard / Standardised all interactive surfaces to 0.18s cubic-bezier(0.4,0,0.2,1) transitions. Every element now reacts on hover: summary metric boxes lift with themed glow, filter preset/team/role buttons gain subtle shadow on hover even when inactive, metric table border glows on hover, header sort columns lift with shadow, status chip lifts, icon buttons gain themed glow, filter group containers glow on hover. Removed all remaining row-level hover backgrounds (light-theme row hover, last-child hovers). Added `summary-chip` CSS class for metric box reactivity. Added Total/empty-state rows to per-cell hover system. Expanded `prefers-reduced-motion` media query to cover all new reactive elements. Created Prospects.css stub to unblock build (original lost from uncommitted work). (~ src/tabs/Reporting/ManagementDashboard.css, ~ src/tabs/Reporting/ManagementDashboard.tsx, + src/app/styles/Prospects.css)
2026-02-21 / Migrate Prospects overview to brand design tokens / Replaced all raw hex values in Prospects.css §14 with `var(--surface-*)`, `var(--text-*)`, `var(--border-*)`, `var(--helix-*)` custom properties so light/dark theme switching works from CSS alone. Extended portal-style CSS classes to the timeline section (card container, header, count badge, clear filter), view toggle group (Table/Timeline buttons), filter bar (kicker accent bar, all-activity button, 9 activity type buttons with icon/label/badge, collapse/expand, last-activity label), loading status panel, and workbench wrapper. Removed ~200 lines of inline `isDarkMode ? x : y` ternaries from EnquiryTimeline.tsx, replaced with CSS classes that auto-switch via `[data-theme]`. (~ src/app/styles/Prospects.css, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-21 / Refine Management Dashboard table micro-interactions / Removed row-wide hover wash and moved interaction feedback to individual table components for smoother, realtime feel: header sort chips now use brand-correct hover colours (light `#d6e8ff`, dark accent tint), row hover no longer tints the whole strip, and member/value cells now react independently with subtle lift and brand-surface hover feedback via new `metrics-cell` classes. (~ src/tabs/Reporting/ManagementDashboard.css, ~ src/tabs/Reporting/ManagementDashboard.tsx)
2026-02-21 / Redesign Prospects overview to MatterPortal design language / Rebuilt TIERs 1-3 of the Prospects overview to match the MatterPortal's clean, professional visual language. TIER 1 hero: portal-style card with "PROSPECT" kicker, 1rem 700w name, clean split-button contact actions, and CSS-driven hover effects (removed inline onMouseEnter/Leave handlers). TIER 2 case selector: converted horizontal scroll pills to vertical folder grid rows (CSS grid with 3px left accent bar, staggered riseIn animation, handler/date columns, hover arrow) matching mp-folder pattern. TIER 3 pipeline: replaced heavy darkBlue/grey background strip with clean white/dark card, added CSS classes for stage pills, connectors, badges. All three tiers now render inside bordered cards with subtle shadow (light) or dark surface (dark mode). Removed dead `hoveredCaseId` state. ~170 lines of inline styles replaced by ~280 lines of CSS classes. (~ src/tabs/enquiries/EnquiryTimeline.tsx, ~ src/app/styles/Prospects.css)
2026-02-21 / Fix Management Dashboard JSX parent wrapper regression / Resolved build-breaking JSX parse error introduced in skeleton branch by wrapping adjacent non-skeleton sections in a fragment, restoring successful Babel/TypeScript compilation for Reporting dashboard. (~ src/tabs/Reporting/ManagementDashboard.tsx)
2026-02-21 / Add Management Dashboard trust UX and responsive loading polish / Added visible reassurance status copy (live refresh state + auto-refresh countdown), introduced initial-load skeleton experience for summary cards and table rows, and improved responsive behaviour for filter toolbar/actions/table scrolling on tablet/mobile. Also aligned date-stamp hover restore to deep dark base for consistent dark-mode composition. (~ src/tabs/Reporting/ManagementDashboard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)
2026-02-21 / Match Management Dashboard to deep dark info-box composition / Updated dark-mode surface recipe to mirror the approved deep composition: switched core shells and controls to `websiteBlue` base (`#000319`) with stronger neutral borders (`#4b556366`), including glass containers, metrics table shell, filter preset groups, filter status chips, filter icon buttons, group containers, date picker fields, and team/role button bases; aligned inline TSX style helpers (`getDatePickerStyles`, `getRangeButtonStyles`, `getTeamButtonStyles`, `getRoleButtonStyles`, `summaryChipStyle`, `dateStampButtonStyle`) to the same dark base. (~ src/tabs/Reporting/ManagementDashboard.css, ~ src/tabs/Reporting/ManagementDashboard.tsx)
2026-02-21 / Remove residual dark-mode blue cast in Management Dashboard / Neutralised remaining blue-tinted dark composition cues after visual QA: changed dark container top sheen from blue to subtle white, switched inactive row shading to neutral border-grey tint, and replaced dark-mode inactive/hover/pressed preset button blues with neutral surface ladder (`darkBlue`/`dark.cardBackground`/`dark.cardHover`). Also removed hardcoded blue gradient shades (`#2f7cb3`, `#266795`, `#1e5a7a`) in team/role/range button states in favour of brand tokens only. (~ src/tabs/Reporting/ManagementDashboard.css, ~ src/tabs/Reporting/ManagementDashboard.tsx)
2026-02-21 / Fix Management Dashboard blue-tint border overshoot / Corrected structural dark-mode borders from rgba(54,144,206) blue tint back to neutral grey (colours.dark.borderColor #4b5563 with hex alpha). Previous pass incorrectly applied blue tint to ALL borders; UserBubble reference shows structural containers use grey (#4b556330 containers, #4b556340 inputs/buttons/tooltips), with blue tint reserved for row separators and interactive hover only. Fixed 9 CSS selectors (glass container, date pickers, filter groups, chips, icon buttons, tooltips, metrics table) and 13 TSX locations (getDatePickerStyles, getRangeButtonStyles, getTeamButtonStyles, getRoleButtonStyles, summaryChipStyle, dateStampButtonStyle, disbursement button, 3 info tooltips, period/member hover tooltips, processing modal). (~ src/tabs/Reporting/ManagementDashboard.css, ~ src/tabs/Reporting/ManagementDashboard.tsx)
2026-02-21 / Enforce UserBubble dark-mode vocabulary on Management Dashboard / Strict compliance pass: eliminated all off-brand rgba patterns per UserBubble's exact composition. Replaced every rgba(75,85,99) border/separator with rgba(54,144,206) blue tint borders at matched opacity; converted Tailwind reds (#ef4444, #dc2626, #10B981, #EF4444) to colours.cta/colours.green; replaced Tailwind slate-50 (#f8fafc, rgba(248,250,252)) with brand grey (#F4F4F6); converted light-mode shadows from Tailwind slate-900 rgba(15,23,42) to websiteBlue-based rgba(0,3,25); fixed text colours (rgba(226,232,240) → #f3f4f6, rgba(160,160,160) → #A0A0A0, #1f2937 → #061733, #6b7280 → #6B6B6B); skeleton shimmer gradient aligned to blue tint; processing modal and progress bar borders/backgrounds aligned. Total: 36 replacements across TSX style helpers, inline JSX (tooltips, hovers, chart cards, modal), and CSS (glass containers, date pickers, filters, metrics table, skeleton). (~ src/tabs/Reporting/ManagementDashboard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)
2026-02-21 / Unify pipeline pill bars + add client portal link / Unified all three pipeline pill bar implementations (Prospects, Clients, Matters) to one consistent visual language: InlineWorkbench getStagePalette complete status now uses green (#20b26c) instead of highlight blue; connectors light up green; EnquiryTimeline TIER 3 pills changed from borderRadius 999px to 0 with aligned bg/border tokens; MatterOverview's 350-line PipelineSection removed — now delegates directly to shared InlineWorkbench with enableTabStages/enableContextStageChips. Added "Client Portal" link chip to the matter tab in InlineWorkbench, bridging Hub to the instruct-pitch client portal via passcode URL. Cleaned up unused react-icons import and dead useState/useMemo destructuring in MatterOverview. (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx, ~ src/tabs/matters/MatterOverview.tsx)
2026-02-21 / Rebrand Management Dashboard to UserBubble composition / Replaced entire Tailwind Slate palette across ManagementDashboard with brand tokens: CSS glass containers, metrics table, filter toolbar, date pickers, team/role slicers, status chips, icon buttons, tooltips all now use darkBlue-based surfaces, 0.5px hairline borders, rgba(75,85,99) brand grey, and borderRadius:0; TSX style helpers (getDatePickerStyles, getRangeButtonStyles, getTeamButtonStyles, getRoleButtonStyles, summaryChipStyle, dateStampButtonStyle) all restyled; inline JSX fixed across date stamp hovers, disbursement button, filter icon colours (#60a5fa→colours.accent), all six tooltip popovers (WIP/WIP value/Collected/Period/Member/Dataset), inactive row separators, premium hover tooltips (gradient→darkBlue/helixBlue), and processing modal; also fixed ReportingHome chevron hover (opaque borderColor→rgba accent). (~ src/tabs/Reporting/ManagementDashboard.css, ~ src/tabs/Reporting/ManagementDashboard.tsx, ~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-21 / Rework Reporting Home report cards — sections + brand styling / Split report card grid into Production, Reports, and Coming Soon sections; moved Meta Metrics to disabled/coming-soon; stripped outermost section box to transparent; replaced heavy card wrappers with 0.5px hairline borders and lighter rgba backgrounds; shrunk icon boxes from 44→36 with 0.5px borders; changed status badge from pill (borderRadius 999) to sharp (borderRadius 2) with 0.5px borders and tighter padding; replaced hex-appended alpha values with explicit rgba colours throughout cards; fixed off-brand dependency dot colours (#4ade80/#15803d → colours.green). (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-21 / Unified navigation redesign — frosted glass surface / Apple-inspired overhaul of the three navigation bars (CustomTabs, QuickActionsBar, ImmediateActionsBar) into one cohesive system: both sticky bars now share a frosted glass background with backdrop-filter blur for premium scroll-under vibrancy; replaced heavy 1px borders with 0.5px hairlines; moved tab active indicator flush to bottom edge (2px, full-width, spring-curve easing); removed the hard separator between Home and tabs (spacing replaces chrome); added subtle hover backgrounds on all tab/home interactive elements; made Navigator transparent so children own their surface; refined QuickActionsBar toggle to uppercase 11px "ACTIONS" label with borderless chips; tightened ImmediateActionChip borders/shadow and reduced left accent from 2px to 1.5px; unified transition curves to 0.2s ease throughout. (~ src/app/styles/CustomTabs.tsx, ~ src/app/styles/CustomTabs.css, ~ src/tabs/home/QuickActionsBar.tsx, ~ src/tabs/home/ImmediateActionsBar.tsx, ~ src/tabs/home/ImmediateActionChip.tsx, ~ src/components/Navigator.tsx)
2026-02-21 / Align quick actions and tabs to brand interaction tokens / Updated Quick Actions bar interaction colours to use theme-correct accent logic (`accent` in dark mode, `blue` in light mode) for expanded toggle, active chips, icon hovers, and unread dot; increased right-side icon button legibility with token-based resting colour. Also removed hardcoded light background from CustomTabs container in favour of canonical token usage. (~ src/tabs/home/QuickActionsBar.tsx, ~ src/app/styles/CustomTabs.tsx)
2026-02-21 / Match upcoming-leave rows to UserBubble composition / Reworked Upcoming Leave modal row surfaces to use the same UserBubble composition stack in dark mode (darkBlue base, subtle blue gradient wash, lighter border tier, and inset edge) so the list reads with the same layered palette language instead of flat boxed cards. (~ src/tabs/home/Home.tsx)
2026-02-21 / Correct playground highlight-blue token mapping / Updated Brand playground layer options so `Highlight Blue` now uses the true brand highlight token (`colours.blue` / `#3690CE`), and relabelled `highlightBlue` as `Light Highlight Blue` to avoid confusion. Also updated the `Light Nav` preset to use true highlight blue. (~ src/components/UserBubble.tsx)
2026-02-21 / Add local Brand combination playground / Added a local-only Brand playground inside UserBubble with quick presets and live selectors for Base, Layer, and Accent colours so combinations can be previewed instantly (including `darkBlue` base + `helixBlue` second-layer stack). (~ src/components/UserBubble.tsx)
2026-02-21 / Re-align leave strip to UserBubble dark + accent palette / Updated Away strip and Upcoming Leave modal styling to match house dark-mode composition: dark surface ladder (darkBlue/cardBackground/sectionBackground) with accent used only as anchor highlight (segment label + initials). Removed residual off-brand blue emphasis from this flow. (~ src/tabs/home/AwayInsight.tsx, ~ src/tabs/home/Home.tsx)
2026-02-21 / Rework Away strip into upcoming-leave quick view / Redesigned the Away strip to be calmer and purpose-led: removed hover flyout/lift jitter, softened icon + segment label emphasis, and adjusted spacing around the strip. Clicking the strip now opens a subtle `Upcoming Leave` modal (compact list of who is away and date ranges) instead of the full Team Leave portal. Added configurable bespoke panel width so this modal opens at a compact width and resets for other actions. (~ src/tabs/home/AwayInsight.tsx, ~ src/tabs/home/Home.tsx)
2026-02-21 / Hard-disable Home dark back-layer gradients / Fixed persistent layered background behind Home metrics by adding a stable `home-root` class and enforcing dark/contrast-mode `background-image: none !important` + `background-attachment: scroll !important` in global styles, preventing runtime Fluent class gradients from leaking through. (~ src/tabs/home/Home.tsx, ~ src/app/styles/index.css)
2026-02-21 / Flatten deep metrics tile layer to page base / Removed the deeper dark-mode artifact under the Home metrics by replacing tile gradient fills with the true base page colour (`websiteBlue`) in both Time and Conversion metric cards (including hover states), so the metrics region no longer shows a lighter underlying layer. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-21 / Remove dark backing behind Time Metrics panels / Eliminated the residual dark slab visible behind the metrics area by flattening dark-mode wrapper backgrounds in `TimeMetricsV2` (unified container + Time/Conversion section panels now transparent in dark mode while retaining borders and tiles). (~ src/components/modern/TimeMetricsV2.tsx)
2026-02-21 / Restructure compositions to base mode + intent / Simplified Brand compositions to `DARK` and `LIGHT` base tabs, then added nested intent controls (`NAV`, `ACTION`, `POSITIVE`) inside the preview so each intent can be evaluated in both light and dark contexts. Removed standalone action/positive composition tabs and their download suppression logic. (~ src/components/UserBubble.tsx)
2026-02-21 / Deepen DARK composition base to match accent family / Updated Brand `DARK` composition to use `websiteBlue` base with accent cueing (instead of lighter `darkBlue` + highlight blue), aligning dark-mode composition with the deeper accent-led navigation palette and removing the complementary lighter-shade feel. (~ src/components/UserBubble.tsx)
2026-02-21 / Match mode/profile hover exactly to download pattern / Added dedicated inset-hover helpers and applied them to the top mode selector and Profile field rows so they now match Brand download interactions exactly: transparent base, 3px inside left accent reveal, subtle blue wash, and `translateX(2px)` inward shift (no lift/shadow drift). (~ src/components/UserBubble.tsx)
2026-02-21 / Match row hover motion to Brand downloads / Updated shared UserBubble row hover animation from vertical lift to inward horizontal nudge (`translateX`) so mode selector, profile rows, and other toggle rows now shift right on hover like the logo/mark download rows. (~ src/components/UserBubble.tsx)
2026-02-21 / Match Profile rows to logo cue and collapse by default / Updated Profile field rows to use the same sharp-corner, 3px left-accent hover geometry as Brand downloads (no rounded corners, same cue width), and converted Profile into a collapsible section that defaults to collapsed for a cleaner command-centre surface. (~ src/components/UserBubble.tsx)
2026-02-21 / Roll out left accent hover cue across interactive rows / Extended the Brand download row left-accent hover pattern to shared `toggleRow` interactions in UserBubble by adding a transparent 3px left border at rest and accent/blue reveal on hover via central row hover helpers. This makes interactive affordance more consistent across controls. (~ src/components/UserBubble.tsx)
2026-02-21 / Improve Brand swatch spacing and copy clarity / Added top spacing between Brand header and swatch row to prevent hover overlap, reduced swatch hover scale for cleaner separation, increased swatch name text size for readability, and added visible hex labels under each swatch so users can clearly see what will be copied. (~ src/components/UserBubble.tsx)
2026-02-21 / Move mode selector to top of panel / Relocated dark/light mode toggle to the top of UserBubble content (immediately under active-state messaging), removed the duplicate toggle from the lower Appearance section, and tightened Brand panel spacing to keep layout compact. (~ src/components/UserBubble.tsx)
2026-02-21 / Unify role and rate header colour / Updated UserBubble header metadata line so role and rate now use the same muted text colour instead of mixed muted/accent styling, improving visual cohesion and reducing false hierarchy between the two values. (~ src/components/UserBubble.tsx)
2026-02-21 / Realign header identity and rate layout / Refactored UserBubble header identity block to a two-row layout for cleaner alignment: top row now shows initials + full name, second row shows role + aligned rate (single baseline with separator). Removed floating rate from the side cluster so role/rate read as one coherent line. (~ src/components/UserBubble.tsx)
2026-02-21 / Align top initials and Local badge styling / Updated UserBubble header initials to use primary text (instead of blue-highlight body cue) for readability consistency, and refined environment ribbon badge colouring so Local uses accent tint/border in dark mode while Production/Staging retain green/orange status colours. (~ src/components/UserBubble.tsx)
2026-02-21 / Align dark-mode Commercial AoW cue to accent / Updated UserBubble Areas-of-Work colour mapping so Commercial uses accent in dark mode (instead of highlight blue), matching the canonical dark-mode AoW accent guidance while preserving light-mode Commercial blue. (~ src/components/UserBubble.tsx)
2026-02-21 / Add positive demo cue + POSITIVE composition tab / Changed active-state banner styling to use green success treatment when Demo mode is enabled (instead of warning red), while retaining red for other warning-state combinations. Added a new `POSITIVE` Brand composition preview tab (green accent on navy) for tuning positive/enablement visuals. `ACTION`, `POSITIVE`, and `ACCENT` compositions continue to hide mark/logo downloads. (~ src/components/UserBubble.tsx)
2026-02-21 / Add logo inset padding and remove duplicate rate/role cards / Added horizontal inset padding inside Brand logo contrast boxes so logo edges no longer touch container borders; renamed download labels to `Helix Mark` and `Helix Logo`. Moved rate sourcing into the header cluster (falls back to details rate when `user.Rate` is absent) and removed duplicate Rate/Role summary cards from the modal body. (~ src/components/UserBubble.tsx)
2026-02-21 / Move Areas filter to top and restore tab-style rows / Repositioned the Session Filters (Areas of Work) block to the top of UserBubble content (directly under active warnings) and reverted the compact chip treatment back to the previous on-brand row/tab design with left accent borders, gradient wash, and clear-all action. (~ src/components/UserBubble.tsx)
2026-02-21 / Correct logo variant/background contrast in Brand downloads / Fixed invisible logo previews in UserBubble by swapping composition logo asset mapping and enforcing opposite backgrounds: `HLRwhite72` now previews on Helix Blue for `DARK`, and `HLRblue72` previews on Helix Grey for `LIGHT`. Mark mapping unchanged. (~ src/components/UserBubble.tsx)
2026-02-21 / Tie brand downloads to composition tabs / Brand downloads in UserBubble now follow Brand composition tabs instead of theme mode: `DARK` shows light mark/logo on dark/opposite backgrounds, `LIGHT` shows dark mark/logo on light/opposite backgrounds, and `ACTION`/`ACCENT` show no mark/logo downloads. This removes mixed-state confusion and keeps logo contrast correct. (~ src/components/UserBubble.tsx)
2026-02-21 / Fix brand asset toggle + logo preview overflow / Brand downloads in UserBubble now hard-switch between light/dark asset sets on theme toggle and force re-render to prevent stale rows. Enlarged logo preview box and applied contain-fit with overflow clipping so full logos no longer spill outside thumbnail bounds; light variants remain on dark backgrounds and dark variants on light backgrounds for visibility. (~ src/components/UserBubble.tsx)
2026-02-21 / Compact AoW filters + fix brand downloads / Replaced 5 full-height AoW filter rows with a compact horizontal chip row (coloured dot, bottom-border accent, single-line layout) — dramatically reduces vertical space. Added CLEAR link in header. Updated Brand downloads section: replaced instruct-pitch submodule logo paths with correct mark assets (HLRblue72.png, HLRwhite72.png, grey helix mark.png) alongside existing SVG marks — now 5 download items. (~ src/components/UserBubble.tsx)
2026-02-21 / Remove dark-mode Home background glow layer / Cleaned up the global Home root background so components are no longer sitting over a lighter gradient/watermark layer in dark mode. Disabled dark-mode radial background image and dark-mode watermark overlay at `containerStyle`, keeping a flat `websiteBlue` canvas behind all Home sections (including Away strip). (~ src/tabs/home/Home.tsx)
2026-02-21 / Remove oversized Away strip container footprint / Cleaned up Away strip parent/layout so it no longer presents as a large full-width box: converted strip to compact inline-flex (`fit-content`, `max-width: 100%`) and constrained wrapper to inline-block; updated Home wrapper to left-aligned flex container. Result: NEXT WEEK/away chips sit in a compact branded strip rather than a stretched bar. (~ src/tabs/home/AwayInsight.tsx, ~ src/tabs/home/Home.tsx)
2026-02-21 / Brand-align Away strip label box and icon row / Updated AwayInsight strip container/chip styling so the NEXT WEEK label and leave icon row use Helix brand surfaces/tokens in dark mode: strip base now `darkBlue`, hover `helixBlue`, chip borders use `dark.borderColor`, loading bars use `dark.border`, and segment labels use brand accent/blue. Also updated strip hover chip treatment to accent + helixBlue for consistent brand feedback. (~ src/tabs/home/AwayInsight.tsx)
2026-02-21 / Enforce leave-only Team Leave modal and remove green/blue fills / Removed attendance semantics from Team Leave modal flow: switched row status language to leave-only (`Away`, `Upcoming`, `None booked`), removed attendance/office-days data from the modal, and stopped attendance API usage for this view. Normalised dark-mode line-item treatment by replacing residual green/blue fills (`approved/booked/half-day/done/none-booked`) with neutral dark surfaces while keeping away signal orange. Also toned down Away strip segment label accent to neutral in dark mode. (~ src/tabs/home/AttendancePortal.tsx, ~ src/tabs/home/AttendancePortal.css, ~ src/tabs/home/AwayInsight.tsx)
2026-02-21 / Remove dark-mode blue fills from Team Leave surfaces / Eliminated remaining legacy greeny-blue fills in Team Leave dark mode: Away strip row and strip chips now use neutral dark surfaces/borders (no cyan gradient wash), and dark-mode leave list chips (`Upcoming`, `half-day`, `booked`) now render with neutral grey fills for cleaner brand alignment. No TypeScript/CSS errors. (~ src/tabs/home/AwayInsight.tsx, ~ src/tabs/home/AttendancePortal.css)
2026-02-21 / Rebuild Away strip modal as leave-first / Shifted the Away strip click path from attendance-centric to leave-centric: Home now opens Team Leave view, and AttendancePortal is reweighted to leave outcomes (away + upcoming + future leave details, with recent history secondary). Added admin-only allowance confirmation in the person sidebar (`Allowance confirmed` / `Low allowance`) while retaining entitlement/used/remaining. Updated AwayInsight strip to include explicit per-person away date ranges for confirmation (both chip tooltip and flyout detail) plus return labels. Normalised modal shell branding in BespokePanel modal variant: removed off-brand slate tint/rounding, switched to Helix surfaces, brand overlay, and border radius 2. Reduced greeny-blue line-item treatment in the portal (neutral hover borders/backgrounds, no forced blue name-hover). (~ src/tabs/home/Home.tsx, ~ src/tabs/home/AttendancePortal.tsx, ~ src/tabs/home/AttendancePortal.css, ~ src/tabs/home/AwayInsight.tsx, ~ src/app/functionality/BespokePanel.tsx)
2026-02-21 / Fix floating elements in workbench enquiry pipeline pills / Adjusted the Prospects overview workbench pipeline pill renderer in InlineWorkbench so stage content no longer floats or drifts vertically: normalized pill height/line-height, centered icon slot, fixed-width status indicator slot for check/warn icons, and consistent badge shrink behaviour. Applies directly to the Enquiry/Pitch/Instructed pill strip shown from EnquiryTimeline in Prospects overview. No TypeScript errors. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-21 / Migrate Prospects table shells to CSS classes / Continued Prospects-first CSS isolation in Enquiries table rendering by replacing inline style blocks with `Prospects.css` classes for both grouped and ungrouped list paths: day separators now use `.prospect-day-sep*`; row shells now use `.prospect-row` with `data-row-parity`; timeline/date cells now use `.prospect-timeline-cell*` and `.prospect-date*`. Kept dynamic behaviour/state (collapse, hover keys, tooltip visibility, area-colour line) while removing per-render style mutation for row backgrounds. No TypeScript errors. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-20 / Refocus AttendancePortal from audit to presence / Rewrote AttendancePortal to answer "who's off, when are they back?" instead of auditing leave history. Overview grid reduced from 5 columns (Name, Status, Balance, Next Leave, Arrow) to 4 presence-focused columns (Name, Status, Back/Next, Arrow) — balance bars removed from the overview entirely. Detail view restructured: leads with current-status snapshot and upcoming leave, not full audit trail (history/declined sections removed). Balance ring retained as admin-only sidebar card. Dark surface ladder corrected: grid header now uses darkBlue (control surface), rows at cardBackground, container at sectionBackground — eliminating the flat header/row sameness. Text hierarchy fixed: body text uses warm grey #d1d5db, not brand blue. Title changed from "Team Attendance" to "Who's In Today". Badge labels shortened ("In" / "Away" / "WFH"). CSS grid-template-columns updated to 4-column layout with responsive breakpoint fix. (~ src/tabs/home/AttendancePortal.tsx, ~ src/tabs/home/AttendancePortal.css)
2026-02-20 / Build CSS design token foundation + Prospects stylesheet / Created `design-tokens.css` (300+ lines) — comprehensive CSS custom properties mapped 1:1 to colours.ts with [data-theme] selectors for dark/light/high-contrast. Covers brand palette, semantic surfaces/text/borders, typography scale (Raleway), spacing, shadows, transitions, z-index, component tokens (helix-panel, helix-input, helix-btn-primary, helix-btn-danger, helix-toast-*, helix-dropzone, helix-spin), and area-of-work tokens. Created `Prospects.css` (400+ lines) — CSS classes for the Prospects table: .prospect-row (alternating via data-row-parity), .prospect-day-sep (BEM), .prospect-pipeline (chip grid with --empty/--active/--complete/--pulse states), .prospect-contact/.prospect-id (hover-reveal), .prospect-copy-btn, .prospect-aow, .prospect-view-toggle. Removed 9 old :root CSS variables from index.css (misaligned values) and replaced with design-tokens import. Refactored BrandingSettingsPanel as proof-of-concept: replaced ~270 lines of inline styles with CSS utility classes, fixed greenish cardBackground → sectionBackground. (+ src/app/styles/design-tokens.css, + src/app/styles/Prospects.css, ~ src/app/styles/index.css, ~ src/tabs/enquiries/Enquiries.tsx, ~ src/tabs/matters/components/BrandingSettingsPanel.tsx)
2026-02-20 / Add AttendancePortal (MatterPortal-inspired team attendance view) / New full-screen AttendancePortal component with two-view design: Overview (team grid with folder-card rows showing status, leave balance bars, next leave) and Detail (person drill-down with leave history sections, balance ring, info card). Self-contained data fetching with preloaded data pass-through from Home.tsx. Features: search by name/initials/AOW, filter chips (All/Away/In Office), away-first sorting, skeleton loading, staggered entrance animations, AOW colour accents, responsive breakpoints. Integrated via handleActionClick — AwayInsight strip click now opens the portal; portal's "Request Leave" button chains to existing AnnualLeaveModal. (+ src/tabs/home/AttendancePortal.tsx, + src/tabs/home/AttendancePortal.css, ~ src/tabs/home/Home.tsx)
2026-02-20 / Deliver Phase 3: document management + portal branding / Two deliverables: (1) Hub-side document management — upload (POST) and delete (DELETE) routes added to documents.js with multer multipart handling, blob storage upload, App Insights telemetry, and blocked-extension validation. New DocumentUploadZone component (drag-drop upload zone, file list with View/Delete, error toast, file type/size validation) wired into InlineWorkbench documents tab with API-driven fetch replacing the old read-only table. MatterOverview inherits via InlineWorkbench's instructionRef-based fetch. (2) ClientBranding CRUD — new server/routes/client-branding.js with GET/PUT(upsert)/DELETE per ClientID + logo upload to blob storage. Service layer (clientBrandingService.ts) and BrandingSettingsPanel component (company name, welcome message, colour pickers with preview swatches, logo upload zone) wired into MatterOverview for pipeline-linked matters with clientId. (+ src/components/DocumentUploadZone.tsx, + server/routes/client-branding.js, + src/services/clientBrandingService.ts, + src/tabs/matters/components/BrandingSettingsPanel.tsx, ~ server/routes/documents.js, ~ server/index.js, ~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/matters/MatterOverview.tsx)
2026-02-20 / Brand-normalise Enquiries.tsx table colours / Systematic sweep of ~293 off-brand colour values across the 11,500-line Enquiries.tsx prospects table. Replaced all Tailwind slate rgba (148,163,184 / 100,116,139 / 71,85,105 / 203,213,225) with brand subtleGrey/greyText equivalents; #E5E7EB/#e5e7eb → #f3f4f6 (dark.text); #1F2937/#1f2937 → #061733 (darkBlue); zebra row backgrounds from custom rgba to brand surface ladder (cardBackground/sectionBackground/cardHover); timeline dot borders from slate-900 to darkBlue; Tailwind green (#22c55e/#10B981) → brand green (#20b26c); Tailwind red (#ef4444/#EF4444/#F87171) → brand cta (#D65541); emerald/red rgba variants normalised. Also fixed MatterOpeningCard.css dark-mode CSS variables from Tailwind (gray-800, gray-900, slate-700, emerald-500) to brand surface ladder tokens. Zero TS errors. (~ src/tabs/enquiries/Enquiries.tsx, ~ src/app/styles/MatterOpeningCard.css)
2026-02-20 / Wire inline matter editor + opponent editing + portal auto-seed / Three deliverables: (1) MatterEditPanel — inline 6-field editor in Matter Details section for description, practice area, solicitor, value, status, close date, calling existing PUT /api/matter-operations/matter/:matterId. Admin-gated toggle with dirty tracking, Ctrl+S/Esc shortcuts, team dropdown. (2) OpponentEditPanel — auto-fetches opponent + solicitor records via new GET /api/opponents/by-matter/:matterId route (LEFT JOIN), inline edit form per party via new PUT /api/opponents/:id route with dynamic SET clause. Expandable section in MatterOverview. (3) Portal auto-seed — new "Portal Space Initialised" step in matter opening pipeline (processingActions.ts) that seeds 6 default checklist items, default snapshot narrative, and initial recovery stage 'a' immediately after matter creation, so the client portal works out of the box. (+ src/tabs/matters/components/MatterEditPanel.tsx, + src/tabs/matters/components/OpponentEditPanel.tsx, ~ src/tabs/matters/MatterOverview.tsx, ~ server/routes/opponents.js, ~ src/tabs/instructions/MatterOpening/processingActions.ts, ~ .github/instructions/ROADMAP.md)
2026-02-20 / Add Matter Control Panel (Command Centre Phase 2) / New write-path from Hub to client-facing Matter Portal. Backend: 10 CRUD routes for CurrentSnapshot, MatterChecklist, and RecoveryStage with pooled SQL, parameterised queries, and full App Insights telemetry. Frontend: typed service layer and MatterControlPanel component with snapshot editor, interactive checklist (optimistic updates, add/delete custom items, progress bar, auto-seed), and 6-stage recovery selector. Embedded in MatterOverview for pipeline-linked active matters. (+ server/routes/matter-control.js, + src/services/matterControlService.ts, + src/tabs/matters/components/MatterControlPanel.tsx, ~ src/tabs/matters/MatterOverview.tsx, ~ server/index.js, ~ server/server.js, ~ .github/instructions/ROADMAP.md)
2026-02-20 / Document pipeline architecture / Comprehensive review of the full prospect-to-portal pipeline, documented in PIPELINE_ARCHITECTURE.md. Covers all 7 stages (arrival → claim → instruct → matter opening → matter management → CCL → portal), cross-space connections, shared data tables, and the command centre gap analysis. Added Command Centre roadmap section with phased plan. (+ .github/instructions/PIPELINE_ARCHITECTURE.md, ~ .github/instructions/ROADMAP.md)
2026-02-20 / Remove active fills from key timeline controls / Final pass in EnquiryTimeline dark mode: active Table/Timeline buttons and active All activity chip now use transparent backgrounds with border/text emphasis only, eliminating residual coloured fills while keeping state clarity. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-20 / Remove residual tinted fills from timeline controls / Replaced remaining dark-mode `cardHover` fills on active Table/Timeline toggles and active All activity chip with flat neutral surfaces (`darkBlue`/`sectionBackground`), and adjusted the inner count badge to neutral inset styling to eliminate the last washed colour cast. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-20 / Hard-override timeline toggle and count chip styling / Finalised Prospects Overview timeline control treatment in EnquiryTimeline by replacing remaining legacy look on the View toggle buttons, top item-count badge, All activity chip, and chip count badge with neutral dark surfaces, explicit borders, and subdued inactive text to remove the old implementation feel. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-20 / Retheme empty prospects timeline shell / Updated the zero-activity Prospects Overview timeline block in EnquiryTimeline to neutral dark surfaces (outer shell, view toggle container, filter row, active filter chip, and empty-state strip) and removed teal-wash accents that made the panel look like the legacy implementation. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-20 / Neutralise prospects timeline washed tint / Rebalanced EnquiryTimeline dark-mode filter chips, icon boxes, and ledger zebra rows to the Helix dark surface ladder (background/card/cardHover) with accent used only for active borders, removing the washed green-blue cast from the prospects overview timeline block. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-20 / Strengthen prospects timeline control contrast / Applied a stronger visual shift in EnquiryTimeline prospects overview: view-toggle group moved to solid dark section surface with explicit border, active toggle buttons to darkBlue, filter ribbon to section surface with stronger border token, and ledger header to darkBlue + neutral text hierarchy for clearer separation from the old glass treatment. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-20 / Align enquiry timeline controls to brand dark surfaces / Updated EnquiryTimeline view toggles, filter ribbon chips, and ledger table header to remove legacy glassy blue treatment and use Helix neutral dark surfaces/borders with accent reserved for active emphasis. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-20 / Refresh timeline dark-mode surfaces / Reworked remaining old-style dark-mode timeline rows/cards in EnquiryTimeline to house palette surfaces (darkBlue/cardBackground/cardHover) with neutral Helix borders, reduced blue-glow overlays, and cleaner hover states while preserving stage/status and direction cues. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-20 / Restyle enquiry overview pipeline chips / Updated the prospects overview pipeline chip strip to use Helix house tokens and cleaner pill treatment (brand surfaces, accent-highlight active state, neutral inactive borders/text, and tokenised document count badge) while keeping existing navigation behaviour unchanged. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-20 / Remove outer InlineWorkbench shell frame / Cleared the root InlineWorkbench container frame (background, border, drop shadow, clipped overflow) so the enclosing ancestor card shown in inspector no longer renders as a boxed panel around the enquiry-stage content. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-20 / Remove enquiry-stage nested cards in InlineWorkbench / Flattened the enquiry-stage detail block that remained boxed in the inspector capture by removing background and border from the Client/Entity header wrapper, key-info strip, and notes panel surfaces so this section no longer renders nested dark cards. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-20 / Remove EnquiryTimeline command bar frame / Removed the remaining framed wrapper around the integrated workbench command bar in EnquiryTimeline by clearing background, border, radius, and shadow so the panel no longer appears as a separate boxed container in dark or light mode. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-20 / Remove inner InlineWorkbench content box wrapper / Removed the separate tab-content container box treatment in InlineWorkbench (no border, no border transition) so the details panel no longer renders as an extra nested framed box inside the workbench shell. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-20 / Remove remaining rounded timeline and workbench container corners / Set timeline section wrapper to square corners (`borderRadius: 0`) and removed remaining rounded corners from inline workbench structural containers (outer shell + tab content wrapper). Also de-pill'ed pipeline stage buttons and replaced remaining sky-tint active state with Helix blue. Verified no TypeScript errors. (~ src/tabs/enquiries/EnquiryTimeline.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-20 / Remove greeny gradients from workbench and timeline header / Reworked InlineWorkbench enquiry header surfaces and chips to Helix tokens, then ran a full-file brand normalisation pass in InlineWorkbench (889 replacements): removed Tailwind slate palette literals, replaced off-brand reds with CTA, and normalised borderRadius 4/6 to 2 throughout. Updated EnquiryTimeline timeline-section wrapper to a flat Helix surface with neutral border (no gradient). Verified no TypeScript errors. (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-20 / Align EnquiryTimeline to house style / Systematic remediation of 941 off-brand colour and borderRadius violations across the 10,016-line EnquiryTimeline.tsx. Replaced all Tailwind sky-blue (rgba(56,189,248), #7DD3FC, #0284c7) with brand blue (#3690CE / rgba(54,144,206)); Tailwind greens (#4ADE80, #22C55E, #16A34A, #10B981, rgba(34,197,94), rgba(134,239,172)) with brand green (#20b26c); Tailwind amber (#f59e0b, #d97706, #fbbf24, rgba(253,230,138), rgb(180,83,9)) with brand orange (#FF8C00); Tailwind reds (#ef4444, #f87171, #dc2626) with brand cta (#D65541). Replaced entire Tailwind slate/gray palette (slate-50 through slate-900 in hex and rgba) with brand surface tokens (darkBlue, cardBackground, dark.text, subtleGrey, greyText, bodyText). Fixed gradients (#2563EB→#0D2F60, #0D1B38→#061733, #F8FAFC→#F4F4F6). Replaced violet (#c4b5fd→accent, #7c3aed→blue), blue-500 (#3B82F6→#3690CE), blue-800 (#1e40af→#3690CE). Normalised all borderRadius from 3–999px pills/rounds to 2px (preserving 999 on circular status indicators only). Zero TypeScript errors. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-19 / Align PasscodeLinkRow panel to UserBubble tokens / Removed local sectionAccent (#87F3F3 teal) and bodyText (#d1d5db warm grey) tokens from PasscodeLinkRow. Section titles ("Activate passcode link", "Deal details") now use textMuted (#A0A0A0) at 10px/600 matching every other section. Body/label text uses component-level textSecondary (subtleGrey). Interactive accents (radio dots, active link, toggle icons) use the component-level accent token. Toned down top gradient bar from 2px teal to 1px brand-blue. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-02-19 / Align ProspectHeader surfaces to UserBubble depth ladder / Remapped all surface, border, and text tokens to match UserBubble exactly: outer card bg from gradient to solid websiteBlue (#000319), section bg from sectionBackground (#051525) to darkBlue (#061733), inner borders from blue-tinted rgba(54,144,206,0.12) to neutral dark.border (#374151), section titles from accent teal (#87F3F3) to textMuted (#A0A0A0) at 10px/600, secondary text from warm grey (#d1d5db) to subtleGrey (#A0A0A0), removed blue-tinted inset box-shadow from outer card, neutralised passcode panel border. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-02-19 / Fix blue-on-blue and greeny-blue across ProspectHeader / Redefined component-level textSecondary from brand blue (#3690CE) to neutral warm grey (#d1d5db dark / #374151 light) to eliminate blue-on-blue contrast throughout Section headers, DataRow labels, ContactInline icons, and Notes buttons. Replaced all off-palette rgba(125, 211, 252) sky-blue with rgba(54, 144, 206) brand-blue for ContactInline buttons, Tag chips, outer card shadow, View Prefill button, and Whiteboard toggle. Replaced all Tailwind emerald rgba(16, 185, 129) and raw #10B981 with brand colours.green (#20b26c / rgba(32, 178, 108)). Changed Section headers and Contact sub-heading to accent colour. Fixed borderRadius 3–4px → 2 in Section, SkeletonSection, Tag, ContactInline, prefill button, and whiteboard toggle. Bumped section title to 11px, DataRow labels to 12px. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-02-19 / Passcode modal readability & blue-on-blue fix / Increased all text sizes (body 13px, labels 12px, inputs 13px, buttons 13px), replaced brand-blue body text with neutral greys to fix blue-on-blue contrast issue, added SVG icon cues to all radio options (send/bolt) and toggle rows (ID card/shield), enlarged toggle switches to 40×20 with 16×16 knobs, increased padding throughout. Documented the text hierarchy rules in copilot-instructions and COMPONENT_STYLE_GUIDE §1b/§1c so future agents don't repeat the pattern. (~ src/tabs/enquiries/components/ProspectHeader.tsx, ~ docs/COMPONENT_STYLE_GUIDE.md, ~ .github/copilot-instructions.md)
2026-02-19 / Restyle passcode generator modal to brand 2.0 / Replaced raw hex tokens, native radio/checkbox inputs, and borderRadius: 4 with the UserBubble brand 2.0 design system. Now uses: colours.ts tokens exclusively, custom radio row selectors with gradient backgrounds and hover lift, toggle switches (36×18, 2px radius), accent top-bar gradient, accented section titles (10px uppercase, 0.5px tracking), SVG icons, brand error/success colours, borderRadius: 2 throughout. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-02-19 / Require practice area before matter opening / The inline "Review" button on the matter opening form had no validation gate, allowing submission with an empty practice_area (which caused Clio matter creation to fail). Fixed: Review button now disabled until matterStepComplete (includes practice area). Added pre-validation guard in simulateProcessing that blocks with a clear error if practice_area is missing. Added inline "Required" warning below the practice area dropdown when empty. (~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx)
2026-02-19 / Add no-amount (ID only) pitch link generation / Added "No amount — ID verification only" checkbox to the manual link activation panel in pitch builder. When checked, amount is bypassed (set to £0), and the deal is created with CheckoutMode 'ID_ONLY' so the instruct-pitch app skips Stripe payment and collects identity only. Server-side dealCapture route updated to resolve ID_ONLY status. (~ src/tabs/enquiries/components/ProspectHeader.tsx, ~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx, ~ server/routes/dealCapture.js)
2026-02-18 / QA bar brand alignment + theme bg fix / Replaced off-brand Tailwind slate hex values and raw rgba colours in QuickActionsBar with brand tokens from colours.ts (textPrimary → dark.text/light.text, textSecondary → subtleGrey/greyText, icon colours → token+alpha, skeleton/border/hover backgrounds → brand-derived). Fixed page background not toggling on theme switch: added semanticColors.bodyBackground: 'transparent' to Fluent ThemeProvider customTheme (prevents static white .body-XXX wrapper), and set document.documentElement.style.backgroundColor alongside body to cover the <html> element. (~ src/tabs/home/QuickActionsBar.tsx, ~ src/index.tsx, ~ src/app/App.tsx)
2026-02-18 / AwayInsight — badge-centric, quieter strip / Removed names and return labels from rendered output — initials badges are now the focal element. Full name + return info available on hover via native tooltip. Badges enlarged (24×24), get a subtle highlight border on hover. Segment labels demoted to muted text (no accent colour, no chip background) so badges stand out. Dark-mode palette harmonised: row gradient, border, badge, and shadow tokens all from UserBubble system so elements complement each other. Unused FaUmbrellaBeach icon removed. (~ src/tabs/home/AwayInsight.tsx)
2026-02-18 / Migration Tool — modular per-record field collection / Redesigned the review phase of LegacyMigrationTool from static client card + flat pipeline config into toggleable per-record modules. Each pipeline record (enquiry, deal, instruction, matters, idVerification) is a module the user can enable/disable. When enabled, the module expands to show all required fields pre-populated from discovery with orange indicators for empty required fields. Confirm phase now shows per-module field summaries. Backend execute endpoint updated to use modules + moduleData from request body with mf() helper for field resolution (moduleData → intake → prefill fallback chain). Discovery grid preserved at top. (~ src/components/LegacyMigrationTool.tsx, ~ server/routes/legacyMigration.js)
2026-02-18 / Quality audit — fix migration route schemas / Recreated legacyMigration.js with production-verified column names after audit found critical schema mismatches: Deals (PitchedBy not FeeEarner, DealId IDENTITY via OUTPUT INSERTED), Instructions (Title not Prefix, DOB not DateOfBirth, HouseNumber not HouseBuildingNumber, added SubmissionDate/Time/LastUpdated), Matters (added ClientName/ResponsibleSolicitor/OriginatingSolicitor/SupervisingPartner), IdVerifications (complete rewrite to EID-prefixed columns — ClientEmail, EIDOverallResult, EIDCheckId). Removed non-existent CreatedAt from all tables. Frontend: replaced raw hex (#e5e5e5, #d0d0d0) with brand tokens (highlightNeutral, subtleGrey), added Escape key handler. Documented Deals table, IdVerifications table, and Legacy Migration flow in DATABASE_SCHEMA_REFERENCE.md. Added legacyMigration.js to ARCHITECTURE_DATA_FLOW.md route listing. (~ server/routes/legacyMigration.js, ~ src/components/LegacyMigrationTool.tsx, ~ .github/instructions/DATABASE_SCHEMA_REFERENCE.md, ~ .github/instructions/ARCHITECTURE_DATA_FLOW.md)
2026-02-18 / QuickActions auto-compact on zoom / Added ResizeObserver to QuickActionsBar that measures the bar's own rendered width. When ≤640px (whether from viewport resize OR browser zoom), the toggle button hides, chip labels hide, and all action icons show directly — always visible, always tappable, no expand/collapse. Inline styles driven by JS isCompact state so the switch is instant; CSS media queries remain as a pre-paint fallback. (~ src/tabs/home/QuickActionsBar.tsx)
2026-02-18 / Mobile QuickActions: icon-only, always visible / On viewports ≤640px the "Quick Actions" toggle button is hidden and action chips are shown directly as icon-only buttons — no expand/collapse, no labels, no greeting. Chips always visible and tappable. At ≤420px further compacted. Breakpoints aligned to 640px to match the rest of the responsive system. (~ src/tabs/home/QuickActionsBar.tsx)
2026-02-18 / Mobile scroll-through layout / On viewports ≤640px, CustomTabs, QuickActionsBar (Navigator), and ImmediateActionsBar now scroll with page content instead of staying sticky at the top. Root container becomes the scroll surface; sticky positions and overflow are overridden via media queries. Enquiries infinite-scroll updated to detect the correct scroll container on mobile. Breakpoint aligns with existing responsive tier. (~ src/app/App.tsx, ~ src/app/styles/index.css, ~ src/app/styles/Navigator.css, ~ src/app/styles/CustomTabs.css, ~ src/tabs/enquiries/Enquiries.tsx)
2026-02-18 / Pipeline Migration Tool v2 — full backend + auto-populate / Complete rewrite of LegacyMigrationTool from v1 shell to production-ready pipeline migration tool. New server route with two endpoints: POST /api/migration/discover (smart search — auto-detects display number, email, or name, queries all 7 tables across Core Data + Instructions DB, returns structured results with auto-populated prefill) and POST /api/migration/execute (creates missing records: enquiry → deal → instruction → matters → idVerification). Frontend rebuilt from 816 lines to lean 350-line component with 5-phase flow: search → discover → review → confirm → done. Auto-populates client info, fee earner, practice area from POID/matters. Toast feedback at every step via UserBubble showToast. Additive-only migration — never modifies existing records. (~ src/components/LegacyMigrationTool.tsx, + server/routes/legacyMigration.js, ~ server/index.js, ~ src/components/UserBubble.tsx)
2026-02-18 / Add responsive breakpoints across dashboard / Three-tier responsive system (640px, 420px) across QuickActionsBar, ImmediateActionsBar, ImmediateActionChip, AwayInsight, TimeMetricsV2, and EnquiryMetricsV2. At 640px: QA bar tightens padding/font sizes, action chips shrink, immediate action chips go 2-column with smaller icon/text, AwayInsight badges/labels scale down, metric grids go single-column. At 420px: QA chip labels hidden (icon-only), action chips go full-width, AwayInsight hides initials badges to save space. EnquiryMetricsV2 now has standalone responsive CSS (previously depended on TimeMetricsV2 being co-rendered). All via className hooks + media queries — no JS layout thrashing. (~ src/tabs/home/QuickActionsBar.tsx, ~ src/tabs/home/ImmediateActionsBar.tsx, ~ src/tabs/home/ImmediateActionChip.tsx, ~ src/tabs/home/AwayInsight.tsx, ~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-18 / AwayInsight v6 — responsive UserBubble-referenced strip / Rewrote AwayInsight with UserBubble design tokens: solid darkBlue surface (no alpha wash), branded borders, hover gradient lift. Added flexWrap for small screens — segments wrap gracefully with rowGap instead of clipping. Initials badges (20×20, helixBlue bg, borderRadius 2) give visual identity to each person. Segment labels styled as subtle tag chips. Bumped font sizes (12px names, 10px labels/return dates) for zoom readability. Smooth cubic-bezier hover transition with translateY lift. Removed old metric-tile gradient that produced washed-out greeny-blue appearance. (~ src/tabs/home/AwayInsight.tsx)
2026-02-18 / Redesign AwayInsight v3 — branded visual with avatars / Complete rewrite of AwayInsight component from basic text strip to branded card-based layout. Person chips with initials badges (28×28, borderRadius:2, tinted bg + branded border), first names, return dates ("Back Mon", "Back Thu 3 Jul"), and FaUmbrellaBeach leave icons. Section hierarchy with coloured accent bars (CTA red for away today, accent/highlight for later this week, subtleGrey for next week). Each person appears only in their most urgent bucket (dedup across sections). Clickable chips open Request Annual Leave panel via new onManageLeave prop. "Manage Leave →" header link wired to handleActionClick. Loading skeleton matches chip dimensions. Hover effects with lift + shadow transitions. Tooltips with full leave details. (~ src/tabs/home/AwayInsight.tsx, ~ src/tabs/home/Home.tsx)
2026-02-18 / Add CFA checkout mode across pipeline / Implemented proper CFA (Conditional Fee Agreement) support as a first-class checkout mode. Backend: added CFA to CHECKOUT_MODES in instructionDb.js, deriveCheckoutMode now recognises CFA status, server.js handles cfa-complete stage with deal close and email notifications. Frontend: HomePage.tsx and StripeContext.tsx recognise CFA mode — skips Stripe, hides payment step, sends cfa-complete on identity completion. PitchBuilder: CFA scenario now auto-sets Amount=0, bypasses positive-amount validation, sends checkoutMode='CFA' to deal capture API. dealCapture.js accepts checkoutMode param and writes Status='CFA' on deals. Updated Bizcap deal 1170 to CFA status. (~ submodules/instruct-pitch/apps/pitch/backend/instructionDb.js, ~ submodules/instruct-pitch/apps/pitch/backend/server.js, ~ submodules/instruct-pitch/apps/pitch/client/src/structure/HomePage.tsx, ~ submodules/instruct-pitch/apps/pitch/client/src/context/StripeContext.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx, ~ server/routes/dealCapture.js)
2026-02-18 / Replace attendance with away/leave insight / Swapped full EnhancedAttendance section on Home for a lightweight AwayInsight component showing who's away today, later this week, and next week. Uses existing annualLeaveRecords + futureLeaveRecords (approved/booked only). Compact avatar rows with initials, first name, and date range. Grouped by "Away today" / "Later this week" / "Next week" with section labels and counts. Empty state shows "No one away" message. Full attendance tracking remains available via Quick Actions but no longer occupies the homepage. (+ src/tabs/home/AwayInsight.tsx, ~ src/tabs/home/Home.tsx)
2026-02-18 / Sequence greeting → icon animation in QuickActionsBar / Greeting and utility icons now occupy the same right-side zone and are mutually exclusive: time-of-day greeting ("Good morning/afternoon/evening, Name") slides in on mount, fades out after 4s, then pipe separator + notes/theme icons drop in with staggered spring animation. Greeting styled on-brand (Raleway 500, accent/highlight colour, 12px). Restored vertical pipe separator between chip area and control icons. Removed old absolute-positioned greeting that overlapped icons. Forced previous-period always-on (removed toggle state entirely, `const showPreviousPeriod = true`). Compact icon-only notes + theme buttons (28x28, no labels). (~ src/tabs/home/QuickActionsBar.tsx, ~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-18 / Add Pipeline Migration tool to UserBubble / Built LegacyMigrationTool v1 modal with multi-phase flow: search client → discover across all systems (Clio, Core Data, Instructions DB) → review findings → intake missing fields → confirm → execute. Reworked Admin and Local sections in UserBubble to be always visible in production (collapsed by default) with disabled visual treatment (opacity 0.35, grayscale, pointer-events none) for non-eligible users — power flex showing locked capabilities. Added chevron expand/collapse with smooth max-height transition. Pipeline Migration tool appears as last item in Local section. (+ src/components/LegacyMigrationTool.tsx, ~ src/components/UserBubble.tsx)
2026-02-18 / Migrate Bizcap Limited into new pipeline / Legacy migration of Bizcap Ltd (3 debt recovery matters opened directly in Clio by AC) into full Instructions DB pipeline. Created enquiry, deal, instruction, 3 matters, and IdVerification records. Pipeline verified with zero warnings. Documented process in LEGACY_MIGRATION_TOOL.md for replication. (+ docs/LEGACY_MIGRATION_TOOL.md, + scripts/temp-migrate-bizcap.mjs)
2026-02-18 / Show previous period by default / Changed previous-period comparison from hold-to-peek to always-visible toggle (defaults on). Converted button from mousedown/mouseup hold interaction to simple click toggle. Removed window-level mouseup/touchend/blur auto-release. Both Time and Conversion tiles now show trend deltas on load. (~ src/components/modern/TimeMetricsV2.tsx)
2026-02-18 / Distinguish metric tiles from section panels / Applied UserBubble-inspired gradient wash, whisper border, inset highlight + drop shadow, and hover lift (translateY -1px) to all metric tiles in both Time and Conversion grids. Replaced flat transparent tiles and border-right dividers with individually styled tiles with 4px gap. Dark mode uses diagonal blue gradient over deeper surface; light mode uses white-based variant. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-18 / Section-first dashboard layout / Consolidated Time and Conversion metrics from split first-row/second-row grids into single unified section grids. Each section now has a compact "Time" or "Conversion" label inside its rail, with all metrics in one `repeat(3, 1fr)` grid (index >= 3 get compact treatment). Removed ~200 lines of duplicated second-row JSX. Removed redundant Conversion divider from TimeMetricsV2 since EnquiryMetricsV2 now carries its own section label. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-18 / Restore progress bar colour contrast / Fixed low-contrast progress fills after compact pass. Time and Conversion progress bars now use stronger brand gradients (highlight→accent in dark mode, highlight→highlightBlue in light mode) with adjusted glow so bars remain clearly visible against dark tracks. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-18 / Compress metrics to Clio-like dashboard density / Tightened Time + Conversion metric layout for faster scan: reduced rail/background weight, reduced block padding, reduced grid gaps (4→3), reduced label/value typography, and slimmed progress bars/skeleton geometry for a denser motherboard dashboard feel. Header and previous-period control also compressed for calmer, less dominant chrome. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-18 / Soften previous-period control tone and reveal motion / Renamed header control copy to "Show previous period" (from hold-style phrasing), reduced visual intensity (sentence case, lighter weight, lower contrast) and removed shouty all-caps feel. Previous-period rows now reveal/hide with smooth opacity + height + translate transition instead of abrupt mount/unmount in both Time and Conversion cards. Also softened metric label typography from uppercase micro-labels to calmer semibold sentence-style labels for a cleaner Helix dashboard tone. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-18 / Add hold-to-peek previous period mode / Added a press-and-hold control in Time Metrics header (`Hold: Previous`) that reveals previous-period figures only while held, keeping default cards clean. Wired this state through to Conversion metrics so previous comparison rows are hidden by default and appear only during hold. Stabilised card labels during hold (no title swapping) and upgraded metric labels to faster dashboard style (uppercase, tighter tracking, stronger weight) for clearer scan hierarchy. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-18 / Restore dashboard hierarchy and loading parity / Reintroduced clear metric hierarchy with section rails and structured metric blocks (title → value → comparison → progress) so Time and Conversion areas are visually resolvable again. Added subtle rail containers and block surfaces with left accent edge in both TimeMetricsV2 and EnquiryMetricsV2 to avoid the undivided "sea" effect while keeping a compact dashboard density. Rebuilt Conversion skeletons to mirror loaded layout (same block hierarchy, spacing, and progress geometry) so loading/loaded states no longer feel like different UIs. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-02-18 / Strip card chrome for dashboard layout / Dissolved card backgrounds, borders, shadows, and hover lift — metric cells are now transparent on the container surface. Removed icon header row and Details chip from all metric cells (both Time and Conversion, first and second rows). Container background changed from darkBlue to websiteBlue so it matches the page canvas with no visible panel. Hover shows subtle background tint only. Fixed second-row Conversion Details chip not hiding in view-as-prod mode. Removed minHeight:100vh from Home.tsx to eliminate bottom gap. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx, ~ src/tabs/home/Home.tsx)
2026-02-18 / Replace period toggle with inline faded comparison / Removed Current/Previous toggle from metrics dashboard — previous period values now show as faded secondary text (60% opacity) below each metric's main value, with trend arrow and % change. Applied consistently across both TimeMetricsV2 and EnquiryMetricsV2, both first-row and second-row cards. Removed PeriodToggle JSX, simplified getDisplayTitle, hardcoded showPreviousPeriod=false. Tightened card density toward dashboard/CRM feel: card padding 12→10px, first-row values 22→18px, second-row values 20→16px, title font 12→11px, icon sizes 13→11/14→12, header margins 6→4px, content padding 8/12→6/10, progress bars 8→6px height. Removed bottom separator div from Home.tsx that caused unnecessary page scroll. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx, ~ src/tabs/home/Home.tsx)
2025-07-20 / Unify metrics into single motherboard dashboard / Merged Time Metrics and Conversion Metrics into one unified container. Removed toggle between views — both metric sets always visible. Added `embedded` prop to EnquiryMetricsV2 so it renders card grids only (no container/header) when inside TimeMetricsV2. Flattened entire visual language: containers use flat darkBlue (no gradient, no shadow), cards use flat websiteBlue (no gradient, no shadow), icon plates transparent, header backgrounds transparent. Grid gaps tightened to 4px for tetris fit. Added "Conversion" section divider between time and enquiry cards. Removed pointless wrapper div in Home.tsx. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx, ~ src/tabs/home/Home.tsx)
2026-02-18 / Darken Time Metrics to websiteBlue base / Container background switched from darkBlue to websiteBlue so the section flows seamlessly from the page canvas. Metric cards now use a subtle gradient from darkBlue→transparent (flat, not layered) with brand-tinted shadows (0,3,25). Borders lowered to rgba(54,144,206,0.06) whisper level. Hover uses translateY(-1px) with deepened shadow instead of -2px. Icon plates at helixBlue 35% for visibility on deeper base. Progress bar track uses helixBlue 30%. Accent top-line softened to 0.06/0.08 opacity. All dark-mode card/container shadows now use rgba(0,3,25,...) consistently. (~ src/components/modern/TimeMetricsV2.tsx)
2026-02-18 / Apply UserBubble calm to Home page stack / Re-darkened surfaces from grey (dark.border+hex) to navy-derived rgba (darkBlue/helixBlue/websiteBlue). Borders now use UserBubble whisper pattern rgba(54,144,206,0.08). Accent lines switched to subtle highlight gradient. Shadows use brand-tinted rgba(0,3,25,...). Eliminated all teal/accent from dark-mode Attendance — replaced colours.accent with colours.highlight in PersonalAttendanceConfirm submit, today border, hover states; replaced sky-blue rgba(125,211,252) with whisper-highlight across WeeklyAttendanceView, EnhancedAttendanceNew, AttendanceCompact; replaced Tailwind grey (#1F2937, rgba(31,41,55)) with brand sectionBackground/darkBlue. Toggle buttons use highlight-blue instead of teal gradient. (~ src/tabs/home/SectionCard.tsx, ~ src/components/modern/TimeMetricsV2.tsx, ~ src/tabs/home/WeeklyAttendanceView.tsx, ~ src/tabs/home/PersonalAttendanceConfirm.tsx, ~ src/tabs/home/EnhancedAttendanceNew.tsx, ~ src/tabs/home/AttendanceCompact.tsx)
2026-02-17 / Strengthen Home page visual presence / Replaced glass/blur with solid brand surfaces across SectionCard, ImmediateActionChip, and Home canvas. SectionCard now uses dark.sectionBackground with a Helix accent gradient top-line and stronger shadows. ImmediateActionChips use dark.cardBackground/cardHover with removed blur for clearer presence on websiteBlue navigator. Home canvas switched to brand token dark.background with deeper radial gradients and stronger watermark. Fixed all off-brand Tailwind colours in ImmediateActionsBar sub-components (EmptyState, Spinner, SuccessCheck, CollapseChevron) to brand tokens: colours.green, colours.highlight, colours.accent, colours.subtleGrey, colours.greyText. Urgent chip colours fixed to CTA (#D65541) instead of Tailwind red. (~ src/tabs/home/Home.tsx, ~ src/tabs/home/SectionCard.tsx, ~ src/tabs/home/ImmediateActionChip.tsx, ~ src/tabs/home/ImmediateActionsBar.tsx)
2026-02-17 / Soften banner separators and remove double-border tension / Standardised top-stack bars to a single subtle bottom rule only: removed top borders from Quick Actions and FilterBanner, removed CustomTabs shadow, and aligned dark-mode separator tone to `dark.border66` for a lighter, consistent rhythm between banner layers. (~ src/app/styles/CustomTabs.tsx, ~ src/tabs/home/QuickActionsBar.tsx, ~ src/components/filter/FilterBanner.tsx)
2026-02-17 / Force darkBlue filter bars on Prospects Clients Matters / Removed `seamless` mode from list-view FilterBanner call sites in Enquiries (Prospects), Instructions (Clients), and Matters so bars render their own darkBlue surface instead of transparent websiteBlue bleed-through. Keeps clean separator line and UserBubble hierarchy consistency. (~ src/tabs/enquiries/Enquiries.tsx, ~ src/tabs/instructions/Instructions.tsx, ~ src/tabs/matters/Matters.tsx)
2026-02-17 / Simplify UserBubble palette naming for users / Updated Helix Palette swatches in UserBubble to user-facing names (Dark Blue, Blue, Light Blue, Highlight Blue, Accent, Red) and added Helix Grey. Removed highlightBlue token swatch (#d6e8ff) from the main displayed palette to reduce confusion; copy-to-clipboard behaviour remains unchanged. (~ src/components/UserBubble.tsx)
2026-02-17 / Align navigator and Quick Actions to UserBubble hierarchy / Removed glass overlay from navigator wrapper and set dark mode base to websiteBlue for clean handoff from tabs. Updated QuickActionsBar to flat darkBlue section surface with dark.border separators (top, bottom, right-cluster divider), removed blur treatment, and removed navigator stack gaps so bars flow continuously with a single clean line separation. (~ src/components/Navigator.tsx, ~ src/app/styles/Navigator.css, ~ src/tabs/home/QuickActionsBar.tsx)
2026-02-18 / Fix demo CCL generation failing silently / Demo CCL used matterId '3311402' but the matters endpoint only shortcutted 'DEMO-3311402' — real Clio API was called and failed. Expanded demo guard to also catch raw '3311402'. Added top-level ok/displayNumber fields to match what mergeMatterFields expects. Hardcoded instructionRef to 'HELIX01-01' so ccl-ai/fill can find the seeded instruction record. (~ server/routes/matters.js, ~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx)
2026-02-18 / Restyle FilterBanner with Helix design system / Background: colours.darkBlue (matching UserBubble bgSecondary). Separator: borderTop uses colours.dark.border for clean line from websiteBlue tabs. Removed gradient bg, backdropFilter blur, sky-blue border, heavy box-shadow. Replaced off-brand hex with brand tokens. borderRadius 0 on all buttons. (~ src/components/filter/FilterBanner.tsx)
2026-02-18 / Fix CCL_date lost on VNet merge / VNet (Instructions DB) matters overwrote legacy (Core Data DB) matters without preserving fields the VNet source lacked — CCL_date was silently dropped. mergeMattersFromSources now shallow-merges, keeping legacy field values where VNet is falsy. Fixes "Prepare Client Care Letter" showing on matters that already have a CCL date. (~ src/utils/matterNormalization.ts)
2026-02-17 / Rewrite CustomTabs with Helix design system / Full rework — removed Fluent Pivot/PivotItem/IPivotStyles, replaced with native tab buttons using inline brand tokens. Stripped gradient background (raw rgba) for flat darkBlue/white. Removed off-brand colours (#7dd3fc, #f8fafc). Active tabs use accent (dark) / blue (light) with 2px underline. CSS reduced from 356→120 lines — removed all .ms-Pivot-link overrides and !important spam. Kept responsive icon-only collapse, home icon fill swap, notification dot, enquiry sub-tabs. (~ src/app/styles/CustomTabs.tsx, ~ src/app/styles/CustomTabs.css, ~ src/app/App.tsx)
2026-02-17 / Gate Dev Dashboard to local dev only / Added isLocalDev guard to both the Dev Dashboard button and modal render so it never appears in production — button and component only mount when running locally. (~ src/components/UserBubble.tsx)
2026-02-17 / Rewrite AdminDashboard with Helix design system / Full rewrite — replaced Fluent UI Nav sidebar, mergeStyles, Icon, Text, IconButton, Stack, Separator with inline React.CSSProperties and horizontal tab strip. Swapped off-brand colours (#ef4444, #4ade80, #fbbf24, #15803d, #b45309) for brand tokens (colours.cta, colours.green, colours.orange). borderRadius: 0 everywhere. websiteBlue header strip. All 7 sections preserved (overview, inspector, ops, files, dataflow, health, diagnostics). 1678 → ~480 lines. (~ src/components/AdminDashboard.tsx)
2026-02-17 / Establish UserBubble as canonical design reference / Rewrote COMPONENT_STYLE_GUIDE.md with AoW visual system (canonical colours, icons, getAreaColor pattern), accent/highlight usage guide, readiness dot pattern, and known brand violations table (15 files catalogued). Updated copilot-instructions.md to define \"Helix look and feel\" as UserBubble-driven standard with AoW colour table and expanded design rules (accent pairing, highlightBlue surfaces, modal rules, off-brand hex blacklist). Added accent/highlight cues to UserBubble: section title accent colouring, AoW colour dots in session filters with left-border indicator, accent-tinted rate stat in dark mode. (~ src/components/UserBubble.tsx, ~ docs/COMPONENT_STYLE_GUIDE.md, ~ .github/copilot-instructions.md)
2026-02-17 / Expand UserBubble command centre with navigation and awareness / Added environment ribbon (colour-coded env badge, hostname, session elapsed timer), active state warnings (amber strip when demo mode, production view, or user-switch active), and Quick Navigate grid (4 cards jumping to Enquiries, Instructions, Matters, Reporting via CustomEvent dispatch). All new sections follow house-style patterns (rowBaseBackground gradients, applyRowHover/resetRowHover, toast feedback). Updated COMPONENT_STYLE_GUIDE.md with Command Centre Anatomy section documenting layout order. (~ src/components/UserBubble.tsx, ~ docs/COMPONENT_STYLE_GUIDE.md)
2026-02-17 / Strengthen Data Hub header hierarchy and remove duplicate lane control / Removed `Choose lane` button so lane switching is handled only by the segmented Collected/WIP toggle. Updated page header so `Data Hub` and active lane are visually distinct (lane pill as header extension), and increased Refresh/Exit action prominence with stronger contrast and weight. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Remove coverage filters and enforce complete lane ledger / Removed status/source filter controls from Coverage and switched to an always-on lane-scoped ledger model so month windows show complete attributed events without filter inversion confusion. Fallback month sync entries remain when no attributed ops-log row exists, and expanded windows now render all available events (no truncation), preserving a “nothing missing” audit trail per lane. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Fix status filtering and improve per-window audit readability / Normalised ops log statuses into stable filter buckets (`completed/error/started`) so status chips behave consistently (including `progress` and message-derived states). Replaced current-week exclusion lightning marker with an info icon, and strengthened expanded window readability with explicit audit-event counts, stronger event cards, clearer status labels, and higher-contrast message text. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Make coverage filters effective and promote lane control hierarchy / Fixed status/source filter behaviour by preventing fallback month audit rows when filters are active (so chip selections now materially change visible audit entries). Reworked lane controls to make the Collected/WIP segmented toggle the primary visual anchor, replaced arrow-heavy wording with calmer labels (`Choose lane`, `Open lane`), and tightened filter bar labels for alignment (`Status:`, `Source:`). (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Simplify Data Hub top bar and filter labels for orientation clarity / Removed duplicate top descriptors and condensed the header to one clear location title (`Data Hub · <lane>`). Replaced verbose lane controls and filter prose with compact labels (`Lanes`, `Scheduler on/off`, `Status`, `Source`) so users can immediately understand where they are without scanning stacked text blocks. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Expand coverage into window sections with clear audit stamps and hub navigation / Refactored coverage from compact row list into expandable month windows (recent→oldest) with separated action cluster, clearer SYSTEM vs USER audit stamps, timestamp/details moved into expanded content, and per-window SQL preview action. Added show-more guard for compute/UI load and strengthened month attribution/filter parsing (supports entry start/end dates, broader date-range patterns, and source detection via triggeredBy/invokedBy). Clarified Data Hub navigation with breadcrumb context and explicit exit/back labels. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Amalgamate coverage and ops audit into one lane view / Removed duplicate top audit timeline and merged operation logging directly into each coverage month row, attributing events to month windows (with fallback to month lastSync when range parsing is unavailable). Added Clio-style Coverage Audit header with status/source filters (`all/completed/error/started`, `all/auto/user`) scoped to the active lane so unrelated operations are filtered out. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Reframe Data Centre as early Data Hub lanes / Updated Reporting Data Centre to present as an Early Data Hub with two explicit lanes (Collected and WIP), clearer lane purpose copy, lane-switch controls in drilled view, and stronger lane-first navigation language while preserving coverage + custom sync flow. Also fixed legacy compile break by replacing invalid `colours.dark.cta` references in RiskAssessment.old button styles. (~ src/tabs/Reporting/DataCentre.tsx, ~ src/components/RiskAssessment.old.tsx)
2026-02-17 / Split OperationValidator: activity log top, validation in custom sync / Added `mode` prop to OperationValidator — `timeline` renders a simplified two-column audit trail + live feed (always visible at top), `full` renders the confidence strip, metrics, action buttons, and explain panel (now inside the Custom Sync accordion). Timeline mode skips validation fetch, uses compact dot+status layout, capped at 8 entries. (~ src/tabs/Reporting/components/OperationValidator.tsx, ~ src/tabs/Reporting/DataCentre.tsx, ~ .github/instructions/ARCHITECTURE_DATA_FLOW.md)
2026-02-17 / Add UserBubble house-style interactions and toasts / Introduced a cohesive interaction layer for UserBubble: shared row hover motion (lift + shadow), subtle gradient row surfaces, and app-native toast feedback for key actions (copy, theme toggle, demo mode, production view, release notes, tracker/debug opens, replay, user switch). Modal now renders animated tone-based toasts (info/success/warning) and rows use unified hover/reset helpers for consistent behaviour. (~ src/components/UserBubble.tsx, ~ src/app/styles/UserBubble.css)
2026-02-17 / Wire demo CCL to real endpoints / Demo matter opening success path now calls real CCL AI Fill + Draft CCL Generation endpoints against form data, producing an actual .docx. "Preview CCL" button appears on the success card when the CCL URL is available, linking directly to the generated document. Non-blocking — if server is down, demo still completes with a warning in logs. (~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx)
2026-02-17 / Auto-fire CCL at end of matter opening pipeline / Removed manual CCL pill and tab from Prospects pipeline — CCL now fires invisibly as two final steps in processingActions (AI Fill + Draft generation). Reduced pipeline noise by hiding disabled stages from prospect pills and replaced off-brand Tailwind colours (#22c55e, #ef4444, sky-blue) with brand tokens (colours.green, colours.cta, colours.highlight). (~ src/tabs/instructions/MatterOpening/processingActions.ts, ~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-17 / Bring CCL into Prospects pipeline / Added CCL as a 9th stage pill in the Prospects Overview pipeline and a new tab in InlineWorkbench. CCL editor (CCLEditor.tsx) now launches inline from the workbench via a portalled modal — no more bouncing to the legacy Instructions tab. Stage shows disabled until matter opened, then pending/complete based on CCLSubmitted/CCL_date. Builds NormalizedMatter from raw instruction/matter data with normalizeMatterData fallback shim. (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-17 / Restructure Data Centre hierarchy: integrity → coverage → custom sync / Moved coverage month grid directly below OperationValidator (integrity) as primary compliance view. Demoted custom sync accordion to bottom with subtler styling (borderless, smaller text, fainter colour). Removed Team + 12m toolbar buttons. Fixed two orphan closing div tags from previous refactor. Removed duplicate coverage block. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Align Profile rows with control-box styling / Updated Profile section rows to use `controlRowBg` (darkBlue in dark mode) instead of sectionBg, with helixBlue hover and proper reset on mouse leave. This matches Dark Mode / View as Production / Replay / Todo row behaviour. (~ src/components/UserBubble.tsx)
2026-02-17 / Deepen UserBubble control boxes to darkBlue / Unified control-row resting surfaces to darkBlue (#061733) via shared `controlRowBg`, including Dark Mode, View as Production, Replay Animations, Todo List, and Select User. Updated all row mouse-leave resets to return to darkBlue, preserving helixBlue hover only as interaction state. (~ src/components/UserBubble.tsx)
2026-02-17 / Remove final green-tint surfaces in UserBubble / Replaced remaining dark hover and avatar surfaces that still read as washed green-blue: `bgHover` now uses helixBlue (#0D2F60) instead of dark.cardHover (#0c2440), and avatar tiles now use darkBlue (#061733) instead of dark.cardBackground (#081c30). This affects Release Notes, Demo mode, Select User, Rate Change Tracker, and other toggle rows through shared styles. (~ src/components/UserBubble.tsx)
2026-02-17 / UserBubble structural cleanup and depth alignment / Removed Asana integration section (masked secrets, no user value). Replaced raw Profile Fields dump with curated darkBlue container matching admin/local pattern. Collapsed separate Actions section into inline footer buttons. Removed 12 unused tokens (bgCard, shadowLg, primaryBtn, borderFocus, textSubtle, accentLight, successLight, warningLight, warning, legacy aliases). Fixed all toggle row and action button backgrounds from cardBg (#081c30) to sectionBg (#051525) — eliminating the off-brand greeny-blue. Quick Stats upgraded to darkBlue containers with accent-coloured rate value. Copy buttons now minimal icon-only. (~ src/components/UserBubble.tsx)
2026-02-17 / UserBubble to centered command-center modal / Converted from floating anchor-positioned popover to viewport-centered modal with backdrop blur. Removed drag-to-position, added close button, wider layout (600px max), entrance animation (scale + fade). App-native control-panel feel. (~ src/components/UserBubble.tsx, ~ src/app/styles/UserBubble.css)
2026-02-17 / UserBubble swatch chips + admin/local containers to brand depth / Swatch palette chips evenly spaced (flex: 1), hex codes shown as labels, click-to-copy. Admin and local section containers now darkBlue (#061733) bg matching AoW pattern — replaced rgba-tinted backgrounds with solid brand navy. (~ src/components/UserBubble.tsx)
2026-02-17 / Areas of Work filters to brand navy stack / Container darkBlue (#061733) on websiteBlue canvas for clear lift. Checked area items now helixBlue (#0D2F60) — the proper mid-navy — with blue-tinted borders. Unchecked items transparent, checked items pop with purpose. (~ src/components/UserBubble.tsx)
2026-02-17 / UserBubble dark depth hierarchy from websiteBlue / Remapped dark-mode depth ladder: popover shell now websiteBlue (#000319) as absolute base, header darkBlue (#061733) for clear lift, cards sectionBg/cardBg for visible separation. Replaced Tailwind slate swatch borders (rgba 226,232,240) with brand-derived borderColor tokens. Swatch container uses darkBlue to stand distinct from the websiteBlue canvas. Five clear depth stops instead of three indistinguishable ones. (~ src/components/UserBubble.tsx)
2026-02-17 / Align UserBubble palette to brand strip / Purged all off-brand hex values: Material amber (#FFB74D, #E65100, rgba 255,183,77/255,152,0) → brand orange (colours.orange #FF8C00); Tailwind blue (#1d4ed8) → colours.helixBlue; invented hover blues (#2a7ab8) and CTA hover (#B04535) → CSS brightness(0.85) filter derived from base palette colour; slate-grey swatch bg (rgba 241,245,249) → colours.grey. Every colour in the component now traces back to colours.ts. (~ src/components/UserBubble.tsx)
2026-02-17 / Drive Matter Opening CCL flag from backend completion event / Added server-emitted `cclQueuedAt` timestamp on matter-request patch completion and wired Matter Opening wizard status flag to this backend signal (instead of local inferred completion), making the visual completion state easier and safer to test. (~ server/routes/matterRequests.js, ~ src/tabs/instructions/MatterOpening/processingActions.ts, ~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx)
2026-02-17 / Add IDVerification and Payment schema guards in demo seed / Hardened Part A seeding to handle required `IDVerifications.ClientEmail` and `Payments.id` variants, and wrapped both inserts in TRY/CATCH so output clearly reports real failures instead of false success prints. (~ tools/db/seed-demo-matter.sql)
2026-02-17 / Harden Instructions seed for required Deals and PitchContent fields / Updated Part A demo seed to populate `Deals.AreaOfWork` variants and to include `PitchContent.DealId` when required (resolved dynamically from Deals). Added explicit failure prints so insert messages only indicate success when writes actually complete. (~ tools/db/seed-demo-matter.sql)
2026-02-17 / Fix Core Data demo enquiry datetime seed / Updated Part B of demo seed script to populate required `enquiries.datetime` / `DateTime` values for all legacy enquiry inserts, preventing NULL constraint failures during Core Data seeding. (~ tools/db/seed-demo-matter.sql)
2026-02-17 / Surface backend CCL status in Matter Opening wizard / Added a lightweight Matter Opening banner flag that reflects backend CCL automation state from instruction data (`CCL generated`, `CCL queued`, `CCL pending`) so users can see status without entering the CCL builder. (~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx)
2026-02-17 / Soften ops log and rebrand OperationValidator / Replaced terminal-style monospace live log with clean activity feed (brand-token dots, no pulsing animation, HH:MM timestamps). Swapped all off-brand Tailwind colours (#22c55e, #ef4444, #3b82f6, #f59e0b) with brand tokens (colours.green, colours.cta, colours.blue, colours.orange). Simplified Reconciliation summary entries — removed redundant status text, reduced dot size, toned down label weight. (~ src/tabs/Reporting/components/OperationValidator.tsx, ~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Simplify CCL modes to Preview vs Edit only / Replaced the three-state toolbar behaviour (`Preview` + `Review` + separate `Edit` button) with a single two-mode toggle (`Preview` / `Edit`). `Preview` is the clean final-view alternative; `Edit` opens editing workflows and sidebar. Removed redundant standalone Edit button. (~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-17 / Remove editable section header chrome in CCL review / Replaced collapsible/editable blue section header bars (chevrons + inline edit icon) on the A4 document surface with plain heading text rows so Review stays clean and document-like. (~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-17 / Add true Preview vs Review mode in CCL / Introduced toolbar toggle (`Preview` / `Review`) in CCL preview. `Preview` now locks the document to final-output view (no inline editing, sidebar closed), while `Review` enables click-to-edit and field navigation/editor flows. Edit button now auto-switches to Review. (~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-17 / Remove inline markup chrome from CCL preview / Changed CCL preview field rendering to plain final-document text (no provenance borders/background highlights/placeholder labels), while keeping click-to-edit behaviour. Preview now reads like the finished letter output. (~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-17 / Unify Origin and CCL spaces to Helix blue palette / Removed remaining hardcoded green and purple accents from Origin/InlineWorkbench and CCL Preview surfaces, mapping success/provenance/ops-toggle/chip states to Helix blue tokens (`colours.highlight`, `colours.blue`, `colours.missedBlue`) for consistent dark-mode branding across Matter Overview + CCL flows. (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-17 / Separate Origin section and remove border seam overlap / Replaced the top separator above Origin with clean spacing so it no longer touches the card, and removed InlineWorkbench seam hacks (`marginTop: -1`, `translateY(-1px)`, inner top border overlap) to stop nested border collisions inside the Origin box. (~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-17 / Rebrand MatterOverview to UserBubble depth palette / Fixed card hierarchy: metricCardStyle and sectionCardStyle now use cardBackground (#081c30) instead of sectionBackground, giving visible lift against both left column (dark.background) and right sidebar (sectionBackground). Removed data source badge gradient (replaced with flat cardBackground). Fixed Clio button to use brand cardBackground/border/text tokens. Fixed doc count pill and Next Steps border to brand tokens. Eliminated all remaining Tailwind greens, sky-blues, slates, and gradients across both .tsx and styles file. (~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/matters/styles/matterOverview.styles.ts)
2026-02-17 / Fix Data Centre JSX regression / Removed orphaned Coverage Audit Trail JSX fragment that caused cascading TSX parse errors in DataCentre. Type-check now passes. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Promote reconciliation and simplify coverage UI / Removed duplicate Coverage Audit Trail panel, elevated Reconciliation (formerly Integrity Checks) as top signal with concise live operation entries, and simplified coverage rows into checkbox-style compliance items with reduced log clutter. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Extend smart auto-sync to archive months / Coverage auto-sync now includes older/archive windows at a slower cadence (120-day threshold) while prioritising recent months first; removed explicit archive/locked freshness labels to keep this low-noise in UI. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Add smart month auto-sync for coverage / Data Centre coverage now auto-syncs only actionable month windows (recent unsynced or stale months), caps automatic runs to avoid overkill, and treats older windows as locked/archive instead of repeatedly refreshing immutable history. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Rebalance Reporting Home visual hierarchy / Refined dark-mode Reporting Home surfaces to reduce playful contrast and improve critical-data readability: calmer stroke/border system, reduced saturated blue fills on report cards and feed chips, unified panel backgrounds via reportingFoundation tokens, and smoother card/status transitions while keeping sharp geometry. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Correct Reporting dark canvas to Website Blue / Updated Reporting page-level dark backgrounds from `colours.dark.background` to `colours.websiteBlue` so the hero (`#061733`) renders with proper brand contrast and no longer appears washed/light in context. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Align colour tokens with brand palette / Added `helixBlue` (#0D2F60) as canonical brand name in colours.ts. `missedBlue` retained as legacy alias. Updated brand palette in copilot-instructions.md with official 6-colour brand hierarchy (Website Blue → Helix Dark Blue → Helix Blue → Helix Highlight → Helix CTA → Helix Grey) with RGB values. Hero box background now uses `colours.darkBlue`. (~ src/app/styles/colours.ts, ~ .github/copilot-instructions.md, ~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Rebrand MatterOverview to Helix palette / Replaced all Tailwind green (#22c55e, #86efac, #15803d, #16a34a, #10B981), sky-blue (rgba(125,211,252), rgba(56,189,248)), and slate (#94a3b8, #64748b) colours with brand tokens (colours.highlight, colours.cta, colours.missedBlue, colours.subtleGrey, colours.greyText). Pipeline pills, status badges, progress bar, copy chip feedback, rating colours, audit dots, team dots, data source badge all now use colours.ts exclusively. (~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/matters/styles/matterOverview.styles.ts)
2026-02-17 / Remove Quick Thoughts box from Reporting Home / Deleted the dev-only Notes & Suggestions section and its NotesAndSuggestionsBox component entirely. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Fix Activity Monitor for production / Rewrote LogMonitor with SSE-first strategy and automatic polling fallback. Tries SSE 3 times (8s timeout each), then falls back to polling /api/logs/recent every 2.5s. Fixes stale closure on isPaused, adds mounted guard, deduplicates entries, and shows connection mode (Live/Polling/Offline) in header badge. Also added /api/logs/stream to setupProxy SSE routes for dev. (~ src/tabs/Reporting/LogMonitor.tsx, ~ src/setupProxy.js)
2026-02-17 / Match CCL page to ops panel navy / Replaced washed-out gradient backgrounds with solid #061733 navy (matching CCL Ops Panel) for paper area, toolbar, and sidebar. Paper itself uses #0a1e3a for depth contrast. Light mode tightened to branded steel-blue tones. Section heading and outline opacity strengthened. (~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-17 / Fix user bubble to use actual brand tokens / Replaced all invented hex blues (#bfdbfe, #7da8d4, #4a7fb5, #0b2444) with actual colours.ts values: dark.background, dark.sectionBackground, dark.cardBackground, dark.cardHover, dark.border, dark.borderColor, dark.text, dark.subText, subtleGrey, greyText. No more made-up colours. (~ src/components/UserBubble.tsx)
2026-02-17 / Rebrand user bubble to Helix blue hierarchy / Replaced all purply slate-based dark-mode tokens (backgrounds, borders, shadows, text) with Helix blue stack (websiteBlue base, darkBlue surfaces, blue accents). Moved colour swatch from header name line to a dedicated lightweight section with labelled chips and hover magnify. Popover shell, overlay, avatar, local/admin badges all now use brand-consistent values. (~ src/components/UserBubble.tsx)
2026-02-17 / Add lightweight Helix swatch to user bubble / Added a compact five-colour swatch strip (websiteBlue, darkBlue, blue, accent, cta) beside user initials in the user bubble header so brand palette tuning can be visualised quickly in-context. (~ src/components/UserBubble.tsx)
2026-02-17 / Remove explicit AOW legend treatment in Reporting Home / Removed the area-of-work colour chip legend from the Reporting Home hero to avoid over-explicit key styling while keeping the broader Helix brand colour direction in place. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Remove purple-leaning dark tint from Reporting Home / Corrected Reporting Home dark-mode palette to follow Helix blue hierarchy (website blue base, dark blue lifts, Helix blue signal) by replacing cyan/slate accents and residual slate overlays with brand-blue values across cards, callouts, controls, navigator chips, and feedback panel states. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Start Helix brand colour pass in Reporting Home / Re-themed Reporting Home toward Helix CRM language: true dark base with blue-lifted panels, mode-aware signal colour usage (accent in dark, highlight in light), CTA red on primary actions, and added area-of-work colour legend chips (Commercial/Property/Construction/Employment) in the hero for brand-consistent context. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Soften Reporting Home shadows for CRM flatness / Reduced heavy depth effects in Reporting Home by softening global surface shadow and removing card/panel/button hover shadows, with lighter callout elevation only where needed for focus. Preserves hierarchy and interactions while matching flatter Helix CRM visual language. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Remove Reporting Home gradients for CRM clarity / Flattened Reporting Home visual treatment by removing gradient backgrounds from shell, hero, report cards, data-window callout, progress bar accent, and feedback panel, replacing them with clean CRM-style flat surfaces and existing reporting panel tokens. This keeps hierarchy and functionality unchanged while reducing visual noise. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Standardize SEO and PPC report context headers / Aligned SEO and PPC internal report headers to the shared reporting shell style with compact context chips (range + sync freshness), reducing top-of-report noise while keeping existing controls and report-specific data source details intact. (~ src/tabs/Reporting/SeoReport.tsx, ~ src/tabs/Reporting/PpcReport.tsx)
2026-02-17 / Deepen CCL A4 and section brand contrast / Updated the main CCL preview surface to feel less washed out and more aligned with the dark operations modal: strengthened paper-shell backgrounds for light/dark modes, upgraded dark-mode paper to a richer navy gradient, increased branded outline contrast, and applied Helix-blue section header containers (background, border, left accent) for clearer structure on the A4 document area. (~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-17 / Align main CCL palette with ops modal dark brand / Removed green-leaning status/completion accents across the core CCL flow and shifted them to Helix blue for consistency with the CCL Operations modal. Updated AI provenance styling, AI complete status chip, Clio availability dot, questionnaire completion accents, and editor-ready badge to use the same blue family. (~ src/tabs/matters/ccl/PreviewStep.tsx, ~ src/tabs/matters/ccl/QuestionnaireStep.tsx, ~ src/tabs/matters/ccl/CCLEditor.tsx)
2026-02-17 / Clarify CCL version audit blocks + preview errors / Simplified expanded history cards by removing duplicated Situation/meta blocks and consolidating around Delivery Audit + Letter Snapshot for clearer CRM-style readout. Delivery Audit now includes client/handler/ref/expiry in one place, and Letter Snapshot uses broader field fallbacks (including long-form captured text) to avoid empty snapshots. Also hardened one-click reconstruct client handling to surface real server/status errors instead of generic "Network error" when preview fails. (~ src/tabs/matters/ccl/CclOpsPanel.tsx, ~ src/tabs/matters/ccl/cclAiService.ts)
2026-02-17 / Rebrand CCL Fed Data and strengthen audit readability / Replaced purple Fed Data styling with Helix blue, made the feed explicitly hideable with Show/Hide + Refresh controls, and made key context snippets (`initialCallNotes`, `enquiryNotes`, `instructionNotes`) always render with clear fallback text when absent. Reduced top-strip badge noise and upgraded version detail cards with explicit Delivery Audit fields (status, who, when, to, where, doc refs) plus a concise Letter Snapshot excerpt for CRM-style reconstruction clarity. (~ src/tabs/matters/ccl/CclOpsPanel.tsx)
2026-02-17 / Surface CCL situation state clearly / Improved CCL Ops readability by adding explicit situation flags in the header (client missing, no AI trace, not assessed), always showing tab counts including zero, and adding a per-version "Situation" block with core state (client/handler/area/trace) plus a concrete next action. This makes sparse records understandable at a glance instead of metadata-heavy. (~ src/tabs/matters/ccl/CclOpsPanel.tsx)
2026-02-17 / Align CCL ops header with tab intent / Reduced top-level CCL Ops noise by replacing the duplicated summary metrics strip (latest version / last AI run / coverage chips) with a single contextual line that reflects the active tab, while keeping only essential global identity signals (latest status and client). This removes overlap between header metrics and History/Traces/Assessments tabs and makes panel hierarchy coherent. (~ src/tabs/matters/ccl/CclOpsPanel.tsx)
2026-02-17 / Enforce true CCL operator attribution / Fixed CCL audit identity so saved versions and AI traces resolve `CreatedBy` from authenticated/requested operator context (req.user initials, payload/header initials, then trusted email) instead of weak header fallback. Frontend CCL generate/save/AI-fill requests now send `initials`, middleware now enriches `req.user` from headers too, and architecture instructions now codify attribution precedence to prevent regressions. (+ server/utils/requestActor.js, ~ server/routes/ccl.js, ~ server/routes/ccl-ai.js, ~ server/middleware/userContext.js, ~ src/tabs/matters/ccl/CCLEditor.tsx, ~ src/tabs/matters/ccl/PreviewStep.tsx, ~ src/tabs/matters/ccl/cclAiService.ts, ~ .github/instructions/ARCHITECTURE_DATA_FLOW.md)
2026-02-17 / Simplify CCL history card signal and fix hooks order / Moved HistoryTab hook state declarations above early return to satisfy React hook ordering, normalized unknown creators to "AI Pipeline", and reduced versioning noise by removing collapsed trace/source/field-count chips and the dense trail strip in expanded cards while retaining key sent/expiry confirmation. (~ src/tabs/matters/ccl/CclOpsPanel.tsx)
2026-02-17 / Add one-click CCL sent-letter reconstruction / Added ops workflow to reconstruct any saved CCL version into a previewable .docx from the exact snapshot payload, with sent confirmation metadata (finalised/uploaded IDs) and expiry status (explicit field date or inferred 30-day window). Also expanded version-history payload to include full snapshot fields so history cards can reliably show client/provenance and support one-click preview. (~ server/routes/ccl-ops.js, ~ server/utils/cclPersistence.js, ~ src/tabs/matters/ccl/cclAiService.ts, ~ src/tabs/matters/ccl/CclOpsPanel.tsx)
2026-02-17 / Fix CCL quick-edit jump-to-document flow / Reworked PreviewStep quick-field navigation so the jump icon now reliably takes users to editable letter content: expands relevant collapsed document sections first, resolves field aliases for clause placeholders, enters inline edit mode on target fields, and falls back to section scroll + field focus when exact placeholders are absent. Also replaced dynamic sidebar/input IDs with data attributes to avoid duplicate-ID diagnostics. (~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-17 / Remove EID fields from Instructions seed / Dropped `EIDStatus` and `EIDOverallResult` from `Instructions` inserts in seed-demo-matter.sql to avoid invalid-column failures on environments where EID state lives only in `IDVerifications`. Keeps EID pipeline coverage intact via dedicated IDVerifications seed rows. (~ tools/db/seed-demo-matter.sql)
2026-02-17 / Improve CCL high-level panel context / Refined CclOpsPanel high-level UX for sparse records: added top snapshot client chip (derived from latest content fields/trace context), switched version-card fallbacks to loose key matching across CCL field variants (including insert_clients_name and handler keys), and now resolves client/handler/practice from trace ContextFieldsJson when content columns are null. Reduces "Client not captured" false negatives and preserves trail readability. (~ src/tabs/matters/ccl/CclOpsPanel.tsx)
2026-02-16 / Remove compile-time seed column traps / Reworked seed-demo-matter.sql to avoid SQL parser failures on optional columns: Instructions inserts no longer hard-reference ProspectId, Deals inserts now dynamically include ProspectId/prospect_id only when present, and Core Data enquiries inserts are now fully dynamic for name/email/date/notes variants. This prevents Invalid column name aborts during initial parse. (~ tools/db/seed-demo-matter.sql)
2026-02-16 / Strengthen CCL version trail visibility / Upgraded CCL history cards to avoid "Unknown" dead-ends: derive client, fee earner, and practice area fallbacks from saved FieldsJson; normalize creator initials so UNKNOWN/System values render as concise badges; and surface per-version provenance chips (trace id, model, status, duration, source count, instruction ref) so trail context remains visible even when top-level columns are sparse. (~ src/tabs/matters/ccl/CclOpsPanel.tsx)
2026-02-16 / Harden demo seed for schema variants / Updated seed-demo-matter.sql to tolerate environment column drift: Instructions inserts now handle missing ProspectId, Payments insert resolves instruction/payment/date/status column variants dynamically, and instructions dbo.enquiries inserts now use adaptive column detection (acid/notes/date/email) instead of hard-coded first_name/last_name fields. Prevents seed aborts on mismatched SQL schemas. (~ tools/db/seed-demo-matter.sql)
2026-02-16 / Tighten CCL ops nav and modal brand / Removed summary-strip duplication of tab categories by switching chips to operational metrics (latest version, last AI run, assessment coverage). Upgraded assessment modal chrome with stronger brand shell, metadata subheader, section cards, and refined footer actions for closer alignment with CCL panel styling. (~ src/tabs/matters/ccl/CclOpsPanel.tsx)
2026-02-17 / Reports shell standardization pass 1 / Added consistent report context headers (title, purpose, back action) across report views and unified the active-report shell background to the shared reporting foundation. Keeps report separation while improving orientation and reducing visual gradient noise in both light/dark modes. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Establish reporting visual foundation baseline / Added shared reporting surface tokens (shell/panel background, border, shadow) and applied first pass to Data Hub + Reporting Home strip to reduce washed-out look and align with Helix CRM simplicity standards. This sets the style baseline for consistent rollout across all report views. (+ src/tabs/Reporting/styles/reportingFoundation.ts, ~ src/tabs/Reporting/DataCentre.tsx, ~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Simplify reports Data Hub strip hover styling / Removed imperative hover tint handlers from the Reporting Home Data Hub status strip and switched to a neutral, low-noise border/background treatment aligned with the simplified Home look and feel. (~ src/tabs/Reporting/ReportingHome.tsx)
2026-02-17 / Promote integrity checks above custom sync / Reordered drilled-in execution hierarchy so Integrity Checks sits as a separate top block above Custom Sync, reducing confusion with Coverage Audit Trail and making validation-first flow clearer. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / Coverage checklist freshness cues + reduced internal scrolling / Updated Data Hub coverage to behave like a checklist with dynamic freshness badges (Needs sync/Monitor/Overdue/Stale/Archive) based on month recency and last sync cadence, including clearer secondary context (who synced, when, row/value stats). Removed most internal fixed-height scroll containers in coverage/audit sections so panels expand naturally by default. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-16 / Align coverage audit hierarchy + WIP week warning / Moved live DB/server audit streams into Coverage as a dedicated “Coverage Audit Trail” so month status and its operational evidence live together. Reframed sync area as “Custom Sync” with guidance to use coverage month rows for preset/monthly refresh. Added explicit WIP confirmation requirement when selected range touches current week, warning that Mon→today will not be written to SQL. Updated WIP row labels to state dashboards stitch current-week data from Clio API. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-16 / Reintroduce unified live ops console / Added a real-time Execution Console inside the same sync/integrity surface (DB Sync + Server Ops streams) so processing preview remains visible without duplicating coverage content. Kept hierarchy clean: coverage as source of month state, execution panel as active run telemetry. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-16 / Unify Data Hub execution hierarchy / Reworked drilled-in Data Hub layout to reduce noise: moved integrity checks into the same execution surface as sync controls (collapsible), removed the separate narrow integrity column, and removed the duplicate Activity log block under coverage so coverage remains the single source of month-level status. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-16 / Enforce WIP current-week SQL exclusion at source / Added server-side guard in syncWip to cap any overlapping range at last Sunday and skip current-week-only windows, so scheduler and manual syncs cannot write current-week WIP into SQL. Prevents API+SQL double-counting and keeps current week API-only until the following week. (~ server/routes/dataOperations.js)
2026-02-17 / Comprehensive demo pipeline seed / Rewrote seed-demo-matter.sql to cover ALL pipeline tables across both databases and all 3 demo cases. Part A (Instructions DB): Instructions ×3, Deals ×3, PitchContent ×2, IDVerifications ×2, RiskAssessment ×1, Payments ×1, Documents ×4, Matters ×1, dbo.enquiries ×3. Part B (Core Data DB): legacy enquiries ×3 with IDENTITY_INSERT for IDs 90001/90002/99999. Each case has rich initial_call_notes text for CCL AI context gathering. IF NOT EXISTS guards on all rows. (~ tools/db/seed-demo-matter.sql)
2026-02-17 / Data Hub CRM clarity redesign / Restored high-level entry view: two clean summary cards (row count, latest date, staleness) that give position at a glance before drilling into an operation. Replaced tab strip with breadcrumb navigation when drilled in. Stripped visual noise throughout: removed CSS animations (ops-pulse, hover transforms, box-shadow effects), removed glowing status dots, removed uppercase/letter-spacing from micro-labels, bumped minimum font sizes from 6-7px to 9px. Simplified section header (removed collapse chevron, database icon, syncing badge, "Clio → SQL" label). Status banner now hidden when healthy. Sync card headers flattened to single-row stats. Coverage month rows collapsed from 3-row to single-row layout with inline stats. Activity log fonts bumped. Feeds section simplified. Removed dead state variables (opsCollapsed, opsChevronHovered, toggleOpsCollapse, bannerIcon). (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-17 / CCL ops panel visual redesign / Complete visual overhaul of CclOpsPanel to match matter opening brand quality. Dark navy (#061733) header with shield icon and Raleway font. Monospace data values throughout (Consolas). Left-border accent cards coloured by status/score across all tabs. Square 2px border-radius replacing old rounded corners. Avatar component showing user initials. Status chips with icons (Edit/CheckMark/CloudUpload). Content preview with line-clamp in history cards. Proportional field accuracy bar in assessments (green/amber/red/grey). Assessment form modal with dark navy header, branded score buttons, styled issue toggles. FieldGrid now accepts accent prop for coloured keys with arrow separators. Added ContextSection shared component. Stat chip summary strip with monospace counts. Active tab fills navy with white text. (~ src/tabs/matters/ccl/CclOpsPanel.tsx)
2026-02-16 / Data Hub coverage-first redesign / Restructured Data Hub layout: replaced two big operation selector buttons with a slim tab strip (Collected | Recorded, inline row counts + staleness + scheduler dot). Coverage checklist promoted from 300px side panel to primary left column (flex: 2). Sync controls (range presets, date pickers, confirm, sync button) collapsed into a "Custom Sync" accordion on the right. OperationValidator stays in the right column below the accordion. Removed: operation selector screen, Back button, coverage toggle buttons, coverage close button, compact log summary. Auto-loads ops data on mount (no more "Load" prompt). (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-16 / Guard AI fill behind manual invoke / AI fill no longer auto-fires on CCL preview mount — prevents accidental trace/DB clutter. "Generate AI Draft" button added to toolbar when status is idle. New "Show Fed Data" button in ops panel calls context-preview endpoint to dry-run the data gathering pipeline (shows resolved data sources, context fields, snippets, prompt lengths) without calling AI or saving a trace. New POST /api/ccl-ai/context-preview endpoint reuses gatherFullContext/buildUserPrompt/buildDebugContext. (~ src/tabs/matters/ccl/CCLEditor.tsx, ~ src/tabs/matters/ccl/PreviewStep.tsx, ~ src/tabs/matters/ccl/CclOpsPanel.tsx, ~ server/routes/ccl-ai.js, ~ src/tabs/matters/ccl/cclAiService.ts)
2026-02-16 / Seed demo matter for CCL pipeline / Created seed SQL to insert Instructions, Deals, and PitchContent rows for HELIX01-01 demo matter. Provides rich context (commercial retainer notes, pitch email, deal data) so the AI fill pipeline gathers real data sources and generates full traces visible in the ops panel. Enables end-to-end testing of the assessment system. (+ tools/db/seed-demo-matter.sql)
2026-02-16 / Drop CclFeedback table / Removed CclFeedback table entirely — superseded by CclAssessment. Stripped saveCclFeedback/getCclFeedback from persistence, admin API, ccl-ai feedback persist, ccl-ops dual-write, frontend types, and instant-lookup queries. getCclStats no longer returns feedback stats. Original migration commented out. Drop migration created. (+ tools/db/drop-ccl-feedback.sql, ~ server/utils/cclPersistence.js, ~ server/routes/ccl-admin.js, ~ server/routes/ccl-ai.js, ~ server/routes/ccl-ops.js, ~ src/tabs/matters/ccl/cclAiService.ts, ~ tools/instant-lookup.mjs, ~ tools/db/migrate-ccl-persistence.sql, ~ .github/instructions/DATABASE_SCHEMA_REFERENCE.md)
2026-02-17 / CCL assessment system / Built structured quality assessment system for CCL outputs. New CclAssessment table (25+ columns: scores, field accuracy, issue categories, prompt suggestions, applied-to-prompt tracking). Assessment UI in ops panel: 1-5 scoring with colour-coded labels, field accuracy inputs (correct/edited/replaced/empty), 8 issue category toggle chips, free-text notes, prompt suggestion textarea with applied badge. Gated to LZ and AC only. 5 new persistence functions (save, list, corpus query with JOINs, accuracy summary, mark-applied). 5 new admin API endpoints. Assessment corpus endpoint provides filterable prompt engineering context (JOINs to CclContent + CclAiTrace). Dual-write from bug reporter to CclFeedback. Ops panel fully rebuilt: history tab shows "Assess this version" button + checkmark on assessed versions, new Assessments tab replaces Feedback tab with aggregate summary strip. (+ tools/db/migrate-ccl-assessment.sql, ~ server/utils/cclPersistence.js, ~ server/routes/ccl-admin.js, ~ server/routes/ccl-ops.js, ~ src/tabs/matters/ccl/CclOpsPanel.tsx, ~ src/tabs/matters/ccl/cclAiService.ts, ~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-17 / Coverage panel checklist redesign / Coverage panel now auto-opens and syncs to the active operation card (collected or WIP). Month rows redesigned as a human-readable checklist: coloured left border (green/amber/red/grey), status badge (✓ synced / ✗ error / not synced), who synced it, when, and row count. Collected months now show SQL row count + £ value. Added collected stats to month-audit endpoint. Updated ARCHITECTURE_DATA_FLOW.md with current-week boundary rules and coverage panel behaviour. (~ src/tabs/Reporting/DataCentre.tsx, ~ server/routes/dataOperations.js, ~ .github/instructions/ARCHITECTURE_DATA_FLOW.md)
2026-02-17 / WIP sync current-week guard + billable visibility / WIP month coverage sync now caps the current month at last Sunday to prevent overlap with Clio-sourced current-week data (used by Management Dashboard). Coverage panel shows per-month billable/non-billable row counts with warning when all entries are billable. Current month shows ⚡ indicator for excluded current-week dates. (~ src/tabs/Reporting/DataCentre.tsx, ~ server/routes/dataOperations.js)
2026-02-17 / CCL instant-lookup + Key Vault connectivity / Added `ccl` type to instant-lookup.mjs with full query support: stats overview, matterId lookup (versions + AI traces + feedback), InstructionRef lookup, status filter, and name/text search. Updated cclPersistence.js to resolve DB credentials via Key Vault (same pattern as instant-lookup) — works locally and in production. Future-proofed migration tables: added DocumentType, TemplateVersion, SentToClient/SentAt/SentMethod, AiTraceId FK, token usage (PromptTokens/CompletionTokens/TotalTokens), RetryCount, ResolvedBy/ResolvedAt for feedback. (~ tools/instant-lookup.mjs, ~ server/utils/cclPersistence.js, ~ tools/db/migrate-ccl-persistence.sql)
2026-02-17 / CCL telemetry parity / Added full App Insights instrumentation to ccl.js: Generate.Started/Completed/Failed, Save.Started/Completed/Failed, Load events + Duration and FieldCount metrics. Added FieldCount and ContextSources metrics to ccl-ai.js. Added 5 aggregate admin endpoints: by-practice-area, by-fee-earner, timeline, ai-timeline, ops-log (unified event stream). CCL now at operational observability parity with DataOps/reports tab. (~ server/routes/ccl.js, ~ server/routes/ccl-ai.js, ~ server/routes/ccl-admin.js, ~ server/utils/cclPersistence.js)
2026-02-17 / CCL persistence + ops layer / Built full CCL persistence: CclContent (versioned content snapshots), CclAiTrace (full AI audit trail with prompts/outputs/context), CclFeedback (persisted ratings) tables. Server persistence utility auto-saves on every generate/save/AI-fill. Admin-only Ops panel in PreviewStep shows content history, AI traces with expandable prompts/context/output, and feedback timeline. New ccl-admin API route for management queries. (+ tools/db/migrate-ccl-persistence.sql, + tools/db/run-ccl-migration.mjs, + server/utils/cclPersistence.js, + server/routes/ccl-admin.js, + src/tabs/matters/ccl/CclOpsPanel.tsx, ~ server/routes/ccl.js, ~ server/routes/ccl-ai.js, ~ server/index.js, ~ server/server.js, ~ src/tabs/matters/ccl/PreviewStep.tsx, ~ src/tabs/matters/ccl/cclAiService.ts)
2026-02-16 / Release notes modal redesign / Rebuilt modal with category auto-detection (New/Improved/Fixed/Under the hood), month grouping with version labels, filter chips with counts, and collapsible month sections. Removed Pivot tabs (Ideas tab dropped). (~ src/components/ReleaseNotesModal.tsx)
2026-02-16 / QuickActionsBar release notes chip / Added release notes button with unread dot (per-session) to the quick actions bar; tightened bar spacing and styling. (~ src/tabs/home/QuickActionsBar.tsx)
2026-02-16 / CCL Clio upload pipeline / Built 3-step presigned URL upload to Clio matters: generate .docx from live fields → POST /documents → PUT binary to S3 → PATCH confirm. Includes upload menu in PreviewStep sidebar, confirmation dialog, and demo-matter support. (~ server/routes/ccl-ops.js, ~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-16 / CCL word template overhaul / Replaced template with full-preamble professional CCL .docx; word generator now defaults all 40+ template fields to prevent ReferenceError; added preamble paragraphs for regulatory and complaints info. (~ templates/cclTemplate.docx, ~ server/utils/wordGenerator.js, ~ src/tabs/matters/ccl/cclSections.ts)
2026-02-16 / Home tab CSS cleanup / Removed ~1400 lines of unused EnhancedHome.css rules; stripped orphan Home.css and empty HomeAnimations.css. (~ src/tabs/home/EnhancedHome.css, ~ src/tabs/home/Home.css, ~ src/tabs/home/HomeAnimations.css)
2026-02-16 / TimeMetricsV2 responsive layout / Added mobile-responsive CSS grid breakpoints and simplified component styling. (~ src/components/modern/TimeMetricsV2.tsx)
2026-02-16 / Demo matter synthetic data / CCL preview and matter routes return synthetic data for DEMO-3311402 so demo mode doesn't hit Clio. (~ server/routes/matters.js, ~ src/tabs/matters/ccl/PreviewStep.tsx)
2026-02-16 / Resources-core Clio auth consolidation / Replaced inline Key Vault Clio token logic with shared clioAuth utility, removing ~30 lines of duplicated refresh token handling. (~ server/routes/resources-core.js)
2026-02-16 / Risk assessment minor fix / Minor risk assessment component fix. (~ src/components/RiskAssessment.tsx)
2026-02-16 / AML review 12-month runbook / Added operations runbook for periodic AML review follow-up process. (+ docs/AML_REVIEW_12_MONTH_REPORT_RUNBOOK.md)
2026-02-16 / Strengthen changelog logging instruction / Expanded one-line logging rule to a CRITICAL section with format, rules, and examples so agents stop skipping it. (~ .github/copilot-instructions.md)
2026-02-14 / Unified entry gate / Replaced separate PasscodeDialog + UserSelectionDialog with single EntryGate component handling passcode entry, user selection, and offline/error states. (+ src/components/EntryGate.tsx, - src/components/PasscodeDialog.tsx, - src/components/UserSelectionDialog.tsx, ~ src/index.tsx)
2026-02-14 / Form health check / Added FormHealthCheck component + server endpoint to validate form submissions with structured error reporting and retry guidance. (+ src/CustomForms/shared/FormHealthCheck.tsx, + server/routes/formHealthCheck.js, ~ server/index.js)
2026-02-14 / CCL operations route / Added CCL ops route for document lifecycle management (list, status, regenerate). (+ server/routes/ccl-ops.js, ~ server/index.js)
2026-02-14 / Forms cleanup / Removed unused imports across custom form components. (~ src/CustomForms/CounselDirectory.tsx, ~ src/CustomForms/CounselRecommendationForm.tsx, ~ src/CustomForms/ExpertDirectory.tsx, ~ src/CustomForms/ExpertRecommendationForm.tsx, ~ src/CustomForms/TechIdeaForm.tsx, ~ src/CustomForms/TechProblemForm.tsx, ~ src/tabs/forms/Forms.tsx)
2026-02-12 / CCL AI token-mode auto-retry / Added resilient token parameter negotiation in Azure OpenAI client: attempts preferred mode then retries automatically on unsupported-parameter 400s (`max_tokens` ↔ `max_completion_tokens`). This fixes CCL AI failures when deployment names are custom and model-family detection is ambiguous. (~ server/utils/aiClient.js)
2026-02-12 / CCL GPT-5.2 compatibility + autosave stability / Updated AI client default deployment to `gpt-5.2` and added model-aware token parameter mapping (`max_completion_tokens` for GPT-5, `max_tokens` otherwise) to resolve 400 errors on CCL AI calls. Also stopped CCL autosave PATCH from regenerating/writing documents in `public/ccls` (which could trigger app reload-like behaviour during editing); PATCH now saves DB draft + non-public file fallback under `logs/ccl-drafts`. (~ server/utils/aiClient.js, ~ server/routes/ccl.js)
2026-02-12 / CCL Foundry parity hardening / Aligned CCL AI defaults with enquiry-processing-v2 Foundry setup (`AZURE_OPENAI_DEPLOYMENT` default now `gpt-5.1`, supports `AZURE_OPENAI_KEY_SECRET_NAME` alias), hardened Instructions lookup to tolerate missing `ProspectId` by dynamically using available ID columns (`ProspectId`/`id`/`acid`), and added one-time `CclDrafts` table existence detection to suppress repeated SQL warnings and fall back cleanly to file drafts when table is absent. (~ server/utils/aiClient.js, ~ server/routes/ccl-ai.js, ~ server/routes/ccl.js)
2026-02-12 / CCL AI transparency + resilience / Hardened CCL AI context loading against schema drift by removing hard dependency on `CreatedAt` (runtime column detection for ordering), added structured AI trace payloads (trackingId, deployment, options, source snippets, prompt length, fallback reason), surfaced full prompt/context trace in CCL preview sidebar, and stabilised MatterOverview mount by removing forced `key` remount to prevent CCL editor state resets that looked like spontaneous refreshes. (~ server/routes/ccl-ai.js, ~ src/tabs/matters/ccl/cclAiService.ts, ~ src/tabs/matters/ccl/CCLEditor.tsx, ~ src/tabs/matters/ccl/PreviewStep.tsx, ~ src/tabs/matters/Matters.tsx)
2026-02-12 / Prospects realtime EID + risk convergence / Fixed prospects overview/workbench state lag where EID/risk cues could stay stale until full refresh. Added optimistic local overrides for EID trigger results and risk save payloads, merged riskAssessments from local instruction overrides into effective instruction data, and wired/awaited risk-save + refresh callbacks through Enquiry line/timeline workbench wrappers so stage cues settle immediately. (~ src/tabs/enquiries/Enquiries.tsx, ~ src/tabs/enquiries/EnquiryLineItem.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-12 / Matter opening traceability hardening / Expanded App Insights coverage for prospects → overview → workbench matter-opening pipeline by instrumenting sync-instruction-client endpoints (started/completed/failed + duration metrics), adding start/config/duration signals to opponents and matter-request patch routes, and propagating a per-run `x-matter-trace-id` from processing actions for end-to-end correlation across API steps. (~ server/routes/sync-instruction-client.js, ~ server/routes/opponents.js, ~ server/routes/matterRequests.js, ~ src/tabs/instructions/MatterOpening/processingActions.ts, ~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx)
2026-02-12 / Matter opening one-off tool / Added reusable one-off replay command to run the matter-opening endpoint chain from an instruction reference without ad-hoc script hunting. New script hydrates minimal payload from Instructions DB and executes: opponents → matter-requests → clio-contacts → clio-matters → instruction link → matter-request patch, with `--dry-run` support. Documented in copilot instructions for future agents. (+ tools/run-matter-oneoff.mjs, ~ .github/copilot-instructions.md)
2026-02-12 / Matter opening pre-validation fallback / Fixed one-off blocker where matter opening failed at pre-validation when requester profile data was missing. `simulateProcessing` now resolves processing initials from assigned fee earner/originating solicitor when `userInitials` is empty, builds richer fallback `workingUserData` from `teamData` (Asana client/secret/refresh + Entra ID), and runs processing actions with resolved initials so Clio/Asana steps can proceed. (~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx)
2026-02-12 / Workbench source mismatch fix / Fixed pipeline source rendering showing synthetic "originalForward" instead of real source values. Changes: (1) stop injecting `originalForward` fallback during enquiry normalization and combined legacy mapping; (2) InlineWorkbench now treats `originalForward` as placeholder and falls back to matter/deal source (e.g. `organic search`); (3) enquiries-unified prospectId matching corrected to use Instructions DB `id` OR `acid` and include `source` in instructions select, preventing cross-space ID collisions from pulling wrong legacy enquiry context. (~ src/utils/normalizeEnquiry.ts, ~ server/routes/enquiries-combined.js, ~ server/routes/enquiries-unified.js, ~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-10 / CCL AI-powered intake fill / Built full AI pipeline for Client Care Letters: user opens CCL → lands on A4 preview → AI generates all 26 intake fields (scope, costs, action points, timescales) from matter context via Azure OpenAI. Includes: (1) server/utils/aiClient.js — Azure OpenAI singleton with Key Vault auth, chatCompletion helper with App Insights telemetry. (2) server/routes/ccl-ai.js — POST /api/ccl-ai/fill endpoint with system prompt for UK solicitor CCL generation, context gathering from Core Data + Instructions SQL databases, practice area defaults fallback (5 areas). (3) src/tabs/matters/ccl/cclAiService.ts — client-side fetch wrapper. (4) CCLEditor.tsx — defaults to preview step, fires AI fill on mount, merges AI fields with auto-filled handler/client fields. (5) PreviewStep.tsx — AI status banner in sidebar (loading/complete/partial/fallback/error), unfilled fields summary badge. Fallback chain: AI → partial + defaults → practice area defaults → commercial defaults. (+ server/utils/aiClient.js, + server/routes/ccl-ai.js, + src/tabs/matters/ccl/cclAiService.ts, ~ src/tabs/matters/ccl/CCLEditor.tsx, ~ src/tabs/matters/ccl/PreviewStep.tsx, ~ server/index.js, ~ .github/instructions/CCL_ROADMAP.md)
2026-02-09 / Prospects render performance (5 quick wins) / 1) Day separator counts pre-computed in useMemo Map — eliminates O(n²) filter inside .map(). 2) Date-range useEffect replaced with single-pass for-loop + shallow equality guard on setDateRange. 3) Person-initials filter uses existing claimerMap O(1) lookup instead of teamData.find() per enquiry. 4) POC dropdown options extracted to useMemo (pocOptionsMemo) — removes O(n²) findIndex dedup from every render. 5) userAOW + currentUserEmail hoisted before displayedItems.map() — identical values no longer recomputed per card. Zero behaviour change; tsc --noEmit passes. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-08 / Lazy-load reporting datasets / Removed auto-trigger refresh that streamed all 13 datasets on Reporting tab entry. Reports now load data on-demand: clicking a report card lazy-loads only its required datasets via handleReportCardClick. "Refresh all" no longer force-navigates to Data Centre. Dashboard CTA always clickable, delegates to handleOpenDashboard which lazy-loads if stale. Subtitle shows "Click a report or refresh to load data" when idle. Data Hub also defers its ops-status/log/month-audit fetches behind a Load button. (~ src/tabs/Reporting/ReportingHome.tsx, ~ src/tabs/Reporting/DataCentre.tsx)
2026-02-09 / Prospects loading optimisation / Mine+Claimed no longer blocks on a full team-wide fetch (5000-row dual-DB query). Uses prop data immediately; team-wide data loads lazily 3s later in background. Loading overlay suppressed during background prefetch when user already has visible data. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-09 / Pipeline filter cycle fix / Filter buttons now loop: none → has (green) → missing (red) → clear. Previously stuck on red with no reset. Added coloured dot indicators and descriptive tooltips showing current state + next action. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-09 / Prospects Phase 1a+1b: normalizeEnquiry extraction / Extracted normalizeEnquiry() and detectSourceType() to src/utils/normalizeEnquiry.ts; replaced all inline Enquiry & { __sourceType } patterns with NormalizedEnquiry type alias; fixed missing source field mapping in fetchAllEnquiries path; removed inline detectSourceType from component body; changed loading text to "Loading prospects…". (+ src/utils/normalizeEnquiry.ts, ~ src/tabs/enquiries/Enquiries.tsx, ~ .github/instructions/ROADMAP.md, ~ .github/instructions/WORKSPACE_OPTIMIZATION.md)
2026-02-07 / Matter opening workflow redesign / Replaced checkbox toggle pattern with modern clickable expandable sections (chevron indicators); added section header with guiding copy matching ConflictConfirmationCard design language; removed dead Checkbox imports + checkboxChipStyles; improved "skipped state" message with reassuring copy + checkmark icon; simplified "Who is the opponent?" heading. ClientInfoStep: added section header, role descriptions for each solicitor role, distinct icons (ContactInfo/AddFriend/AuthenticatorApp), auto-pre-select Responsible Solicitor from requestingUser. FlatMatterOpening: added footer hint below Continue button. (~ src/tabs/instructions/MatterOpening/OpponentDetailsStep.tsx, ~ src/tabs/instructions/MatterOpening/ClientInfoStep.tsx, ~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx, ~ .github/instructions/ROADMAP.md)
2026-02-06 / Matter opening email + data fixes / Email now sends to fee earner (primary) with LZ + CB in CC instead of hardcoded LZ-only test mode; added getTeamEmail to teamLookup; description pre-populated from instruction ServiceDescription; fee_earner_email added to team_assignments payload; instructionRecords enriched with eid/risk/documents/payments for instruction_summary in email template. (~ server/routes/clioMatters.js, ~ server/utils/teamLookup.js, ~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-06 / Matter opening inline in prospects / Portal-wrapped FlatMatterOpening as overlay; Open Matter button wired to local modal; matter pill shows processing state; onMatterSuccess calls onRefreshData + toast; onOpenMatter navigation dispatch removed (no-op). (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/Enquiries.tsx, ~ .github/instructions/ROADMAP.md)
2026-02-06 / ID review inline in prospects / Portal-wrapped EID action picker, approve modal, request docs modal; approve calls onRefreshData + toast; onOpenIdReview navigation dispatch removed. (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/Enquiries.tsx)
2026-02-06 / Demo mode enriched / Added DEMO-ENQ-0002 at proof-of-id with EID Refer + PEP Review for testing; added DEMO-ENQ-0003 fully complete; enriched EID records with realistic fields and isDemo flag. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-06 / Risk assessment inline in prospects / Portal-wrapped risk modal (clipping fix), auto-refresh via onRefreshData on save, processing pill state while modal open, parent toast on save, navigation dispatch removed. (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/Enquiries.tsx)
2026-02-05 / Fix dataOpsLog SQL persistence / Cache resolved connection string, align INSERT with full table schema (jobId, changedRows, triggeredBy, invokedBy), add clear error logging when pool unavailable. (~ server/routes/dataOperations.js)
2026-02-05 / Instant lookup ops range / Add ops mode with natural-language ranges (e.g. "operations this week") to query dataOpsLog. (~ tools/instant-lookup.mjs)
2026-02-04 / Matter metrics processing cue / Show one dot per metric action and surface active action in the toast body. (~ src/tabs/matters/Matters.tsx, ~ src/components/feedback/ToastProvider.tsx)
2026-02-04 / Enquiry timeline initials source / Remove guessed initials expansion; use actual data and prospect full name for inbound emails. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline entry behaviour / Don't auto-select first item on entry; clarify pitch origin label to "Sent by email" / "Sent as link". (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline type category styling / Add category-based icon containers (circle=communication, square=resource, filled=milestone) for visual distinction across filters, table and timeline. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline case chevron cue / Replace "Open ›" with a subtle rotating chevron that glows when active. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline top banner tone / Apply sharper, more serious styling to the hero banner and contact pills. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline POC initials fix / Preserve existing initials (e.g., LZ) and handle email/local-part cases. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline case badge cue fix / Replace chevron icon with text glyph to avoid runtime errors. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline case badge cue / Add a subtle Open cue to show case badges are selectable. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline POC initials / Derive full POC initials for new and legacy data without guessing. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline case badge date/time / Show time for new-space enquiries and drop year unless different. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline case badge meta / Show date only and claimed initials only in case badges. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline case badges quiet / Simplify case badges further while retaining area colour cue. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline case badges simplification / Reduce visual noise for a more serious, minimal case selector. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline case badges / Apply sharper, more serious case badge styling with clearer hover feedback. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline day separators hover / Table day separators now toggle compact/full labels on hover. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline table striping / Add subtle alternating row backgrounds for readability. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline table sorting / Enable header sorting for Date, Type, Description, and By with shared table header colours. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline table headers / Strengthen table header styling for clearer scanability. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline day separators / Soften table day headers so they sit behind the filter banner. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline filter label / Simplify Filter Activity label to just Filter. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline filter hover highlight / Hovering filter chips now subtly highlights matching timeline entries. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline Type column width / Widen the Type column in table view to avoid wrapping labels. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline By column width / Widen the By column in table view to reduce early wrapping. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline table time-only + forward action / Show time only in grouped table rows and restyle forward action as a subtle inline button. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry table day breakdown / Always show table view day groupings without the collapse toggle. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Prospect case cues simplification / Replace heavy case cards with cleaner CRM-style chips. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline filter clarity / Change “View mode” to “View” and enhance filter bar hierarchy/visual grouping. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline table view / Rename Ledger to Table, default to table view, group rows by day, and emphasise the By column. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Matters table headers + legacy fields / Rename headers and enrich legacy worktype + contact details in the table. (~ src/tabs/matters/MatterTableView.tsx, ~ src/tabs/matters/Matters.tsx)
2026-02-04 / Toast loading indicator / Add a subtle pulsing status dot to loading toasts and simplify the metrics loading message. (~ src/components/feedback/ToastProvider.tsx, ~ src/tabs/matters/Matters.tsx)
2026-02-04 / Outstanding balance cache refresh / Version global cache key and force fresh fetch when falling back to global balances. (~ server/routes/outstandingBalances.js, ~ src/tabs/matters/Matters.tsx)
2026-02-04 / Outstanding balance fallback / Include associated_matter_ids globally and fall back when user-scoped balances are empty. (~ server/routes/outstandingBalances.js, ~ src/tabs/matters/Matters.tsx)
2026-02-04 / Outstanding balance 401 retry / Refresh cached Clio token on user-matters 401 to restore outstanding balances. (~ server/routes/outstandingBalances.js)
2026-02-04 / Matters outstanding balance lookup / Harden Entra ID resolution and fallback to team data to avoid "undefined" user lookups. (~ src/tabs/matters/Matters.tsx)
2026-02-04 / Matters data source cue copy / Expand the v1/v2 tooltip text with reassurance and clearer meaning. (~ src/tabs/matters/MatterOverview.tsx)
2026-02-04 / Matters data source cue placement / Move the v1/v2 origin cue into the Data source badge line. (~ src/tabs/matters/MatterOverview.tsx)
2026-02-04 / Matters legacy client hydration / Add Clio client fetch for legacy matters with auto-load and refresh button. (~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/matters/Matters.tsx)
2026-02-04 / Matters all-scope access / Allow All scope to show everyone even for non-admins. (~ src/utils/matterNormalization.ts)
2026-02-04 / Matters client resolution + all scope / Allow All scope for fee earners and resolve missing client names in Matters using instruction/workbench data. (~ src/tabs/matters/Matters.tsx)
2026-02-04 / Matters tab open access / Removed the Matters early-access chip and rollout gating so Matters is visible to everyone. (~ src/app/App.tsx, ~ src/app/styles/CustomTabs.tsx, ~ src/app/admin.ts)
2026-02-04 / Payment receipt + link gating / Integrated receipt action into Transaction Details header and hid Create payment link outside localhost. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-04 / Payment ref copy chip / Moved payment ID under description, added standalone Ref column with copy chip + toast feedback. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-04 / Payment bar columns / Split currency and payment ID into dedicated payment bar columns alongside date. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-04 / Payment row compact meta / Moved currency/payment ID into the date column and removed the product box for a tighter payment detail layout. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-04 / Payment workbench hierarchy alignment / Restructured payment expanded details into consistent cards and spacing; aligned bank confirmation card styling. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-04 / Data ops two-card redesign / Replaced monolithic single-panel with two-card layout (Collected Time + WIP), each self-contained with stats, pill-style range presets, inline validation, and single primary action. Collapsible logs section. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-04 / Instruction context comprehensive data / Expand instruction chip content with instruction-only fields (client ID/type, consent, internal status, ID type, contact, DOB, nationality, notes) and remove pitch-derived data. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-04 / Instruction context rich layout / Redesign instruction chip content panel with header badges (status, ref, passcode, matter), key info strip (client, area, fee earner, stage, amount, matter), and service description section. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-04 / Data ops unified range + auto validation / Default data operations to custom ranges with presets, auto-run validation on operation selection, and add custom-range WIP sync support. (~ src/tabs/Reporting/DataCentre.tsx, ~ server/routes/dataOperations.js)
2026-02-04 / Enquiry timeline active pill colours / Keep status colours for text/icon/tick when a stage pill is selected. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline active pill ticks / Keep completion and issue icons visible when a stage pill is selected. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline connector lighting / Only light connectors when both adjacent stages are complete. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline instruction pill idle style / Match inactive pill styling when no instruction activity exists. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline instruction pill label / Show “Instruction” until there is actual instruction activity. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-04 / Enquiry timeline instructed pill gating / Prevent pitched-only deals from showing Instructed as current unless an instruction exists. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-03 / Timeline icon palette standardised / Shift filter chips and timeline/ledger type icons to a refined monochrome palette. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-03 / Case selector card redesign / Promote case chips into prominent header sub-cards with stronger emphasis and active state treatment. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-03 / Timeline stage entries split / Split pitch into a stage summary entry plus separate outbound email activity, hide inline workbench blocks in timeline cards, strip any embedded workbench markup from email HTML, and ensure stage items render even when dates are missing. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-03 / Workbench lookup fallback / Resolve workbench pipeline data by enquiry ACID or fallback ProspectId/ID when ACID missing. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-03 / Stage entry enrichment / Expand stage metadata and render comprehensive data bars for enquiry, pitch, instruction, ID, payment, risk, and matter entries. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-03 / dataOpsLog schema design / Design persistent SQL table for data operations audit log with support for multi-source sync, bidirectional operations, and job correlation. Add migration script and lean documentation. (+ tools/db/create-dataopslog-table.mjs, ~ .github/instructions/DATABASE_SCHEMA_REFERENCE.md)
2026-02-03 / Data Hub custom sync controls / Add custom sync action selection (delete/insert), abort support, no-data handling, and tighter date picker styling. (~ server/routes/dataOperations.js, ~ server/utils/sqlHelpers.js, ~ server/index.js, ~ src/tabs/Reporting/DataCentre.tsx)
2026-02-03 / SQL VNET fallback / Prefer SQL_CONNECTION_STRING_VNET when core connection is missing or redacted. (~ server/index.js)
2026-02-03 / Data ops manual gating / Disable data operations scheduler unless explicitly enabled, plus refined date picker styling. (~ server/utils/dataOperationsScheduler.js, ~ src/tabs/Reporting/DataCentre.tsx)
2026-02-03 / Data Hub rebranding / Rename "Data Centre" to "Data Hub" and move entry point to primary action area for better visibility. (~ src/tabs/Reporting/ReportingHome.tsx, ~ src/tabs/Reporting/DataCentre.tsx)
2026-02-03 / Data operations scheduler offset / Offset scheduler by 3 minutes (xx:03) to avoid race conditions with existing 30-minute infrastructure. (~ server/utils/dataOperationsScheduler.js)
2026-02-03 / Data operations scheduling / Add server-side collected-time schedules (30m daily + 23:00 rolling), live processing log, and richer progress logging for App Insights. (~ server/utils/dataOperationsScheduler.js, ~ server/routes/dataOperations.js, ~ src/tabs/Reporting/DataCentre.tsx, ~ server/index.js)
2026-02-03 / Data centre streamlining / Remove redundant All feeds section now that grouped feeds cover the same data. (~ src/tabs/Reporting/DataCentre.tsx)
2026-02-03 / Data centre data previews / Add per-dataset data preview buttons (incl. core + instructions tables), clarify collected/recorded fills, and expand preview endpoint table coverage. (~ src/tabs/Reporting/DataCentre.tsx, ~ server/routes/dataOperations.js)
2026-02-03 / Prospects pitch data fetch / InlineWorkbench now fetches pitch content from /api/pitches when pitch context is activated, showing loading and empty states. Uses effectivePitch to merge item data with fetched content. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-03 / Prospects pitch chip redesign / Pitch context in InlineWorkbench now shows rich enquiry-style layout with header (Pitched badge + time + passcode), key info strip (Area, Pitched By, Amount, Service, Client), and pitch content preview. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-02-03 / Data centre expansion / Promote Data centre chip, route refresh to it, and add live inspection view with dataset status and manual refresh actions. (~ src/tabs/Reporting/ReportingHome.tsx, + src/tabs/Reporting/DataCentre.tsx)
2026-02-03 / Collected compare tool / Add Clio vs Hub collected comparison helper with SQL-only option. (+ tools/db/compare-collected.mjs)
2026-02-03 / WIP non-chargeable flag / Add dashboard note that WIP includes non-chargeable time. (~ src/tabs/Reporting/ManagementDashboard.tsx)
2026-02-03 / DB table lookup range mode / Add date-range lookups to the Core Data table tool. (~ tools/db/table-lookup.mjs)
2026-02-03 / DB table lookup tool / Add generic Core Data lookup script for schema and record inspection. (+ tools/db/table-lookup.mjs)
2026-02-02 / Teams link widget alignment / Align Teams widget deep link build with server-style encoding and open links via Teams when available. (~ src/components/TeamsLinkWidget.tsx)
2026-02-02 / Enrichment retry cooldown / Allow visible enquiries with empty enrichment to retry after a short cooldown instead of staying permanently empty after a failure. (~ src/tabs/enquiries/Enquiries.tsx)
2026-02-02 / Pipeline chips status alignment / Pipeline chips now derive status from inline workbench logic (EID, payments, risk, matter, docs) with processing/neutral support. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-02 / Pipeline chips restyled / Connected pill pipeline chips with workbench-aligned status colours. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-02 / Timeline view toggle clarity / Switched to a segmented Cards/Ledger control to match filter banner style. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-02 / Timeline default collapsed / Timeline now starts collapsed by day on initial load. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-02 / Timeline header filters clarified / Merged activity filters into the timeline header (second row) with clearer labels and counts. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-02 / Timeline density toggle removal / Removed compact view toggle; timeline uses comfortable spacing only. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-02 / Timeline filter banner relocation / Moved the timeline activity filter banner to be the timeline header in main content. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-02-02 / Timeline filter banner consolidation / Moved jump/navigation + density controls into the timeline filter header and removed the old filter banner. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-31 / Unified command bar workbench integration / Moved workbench from separate card into the unified command bar as TIER 5 (Integrated Workbench). Collapsible section with status pills when collapsed (instruction status, risk level, matter status). Eliminates duplication between pipeline bar and workbench. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-31 / Timeline filter UX simplification / Changed pitch chip click behavior: now scrolls directly to the first pitch item in timeline instead of showing a separate "Filtered View" section. Filters now only show the Quick Access section when user manually toggles them. Timeline card mode now also respects activeFilters. Removes duplication between workbench and filtered view. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-31 / Enquiry pipeline + hover UX / Extended pipeline bar to full 7 stages (Enq→Pitch→Inst→ID→Pay→Risk→Matter) with status-aware styling. Added comprehensive Apple/MS-style hover effects: pipeline stages scale+glow, action buttons lift+shadow, timeline cards slide, icon buttons scale+press, activity filters highlight. Smooth cubic-bezier transitions throughout. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-31 / NetDocuments search + metadata display / Enhance search results and folder contents UI with extension, modified date, modified by. Increase results limit to 20 with richer layout. (~ src/components/ResourcesModal.tsx)
2026-01-31 / NetDocuments v1/v2 API routes / Add workspace-contents and folder-contents routes using v1 Workspace + v2 container sub endpoints with proper metadata. (~ server/routes/resources-core.js, ~ src/components/ResourcesModal.tsx)
2026-01-31 / NetDocuments browser rework / Replace scattered NetDocuments cards with unified hierarchical browser: workspace lookup → breadcrumb folder navigation → scoped search. Remove broken sub-containers call. (~ src/components/ResourcesModal.tsx)
2026-01-31 / Home metrics count-up stabilisation / Stop TimeMetricsV2 cards remounting on refresh to prevent repeat count-up animations. (~ src/components/modern/TimeMetricsV2.tsx)
2026-01-31 / Metrics animation storage fallback / Disable count-up when sessionStorage is unavailable to avoid repeated animations. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-01-31 / Enquiry comparison ranges / Align previous week/month comparisons to same elapsed days and avoid local recalculation in production. (~ server/routes/home-enquiries.js, ~ src/tabs/home/Home.tsx)
2026-01-31 / Enquiry metric diagnostics / Expand conversion/enquiry details modal with underlying values and comparison windows; add user switch recalculation cue. (~ src/components/modern/EnquiryMetricsV2.tsx, ~ src/tabs/home/Home.tsx, ~ src/app/App.tsx)
2026-01-31 / Enquiry records inspection / Add home-enquiries details endpoint and surface raw records in the metrics details modal. (~ server/routes/home-enquiries.js, ~ src/components/modern/EnquiryMetricsV2.tsx, ~ src/components/modern/TimeMetricsV2.tsx, ~ src/tabs/home/Home.tsx)
2026-01-31 / Enquiry details simplification / Show only underlying records in the metrics details modal for validation. (~ src/components/modern/EnquiryMetricsV2.tsx)
2026-01-31 / Enquiry metrics scope / Remove team inbox from user-scoped home enquiry metrics and records. (~ server/routes/home-enquiries.js)
2026-01-31 / Home enquiries LZ override / Route LZ home enquiry metrics to AC to match demo expectation. (~ server/routes/home-enquiries.js)
2026-01-31 / Metrics skeleton refinement / Keep cards visible while only animating data placeholders during loading. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-01-31 / Resources NetDocuments workbench / Expand NetDocuments operations (user, containers, sub-containers, documents, search) with carry-over inputs. (~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-31 / Resource workbench dark mode / Apply on-brand dark button styling in resource workbench. (~ src/components/ResourcesModal.tsx)
2026-01-31 / Resources chip workbench panel / Open resource chips in a dedicated BespokePanel page instead of inline sections. (~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-31 / Resources workbench overlay z-index / Ensure resource panel opens above the resources modal layer. (~ src/app/functionality/BespokePanel.tsx, ~ src/components/ResourcesModal.tsx)
2026-01-31 / Enquiry case windows / Add enquiry case index and scope timeline/quick access to the active enquiry window. (~ src/tabs/enquiries/EnquiryTimeline.tsx, ~ src/tabs/enquiries/Enquiries.tsx)
2026-01-31 / Demo prospect cases / Demo mode now seeds multiple enquiries for the same prospect so case windows are visible. (~ src/components/UserBubble.tsx, ~ src/tabs/enquiries/Enquiries.tsx)
2026-01-31 / Demo timeline items / Inject demo emails, calls, pitches and documents for demo enquiries in timeline view. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-31 / Demo mode overlay + workbench / Replace demo toast with in-context overlay and seed tabbed workbench data for demo enquiries. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-31 / Prod view hides demo actions / Suppress Resources & Actions when View as Production is enabled. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-31 / Resources NetDocuments lookup / Add NetDocuments workspace lookup operation (Key Vault-backed) in Resources panel. (~ server/routes/resources-core.js, ~ src/tabs/resources/Resources.tsx)
2026-01-31 / NetDocuments auth alignment / Use nd-authurl + Basic auth + scope when fetching NetDocuments access tokens. (~ server/routes/resources-core.js)
2026-01-31 / NetDocuments auth client_id / Build OAuth client_id with repository suffix and default scope full. (~ server/routes/resources-core.js)
2026-01-31 / Resource ops cue / Add subtle ops badge on resource chips with operations. (~ src/tabs/resources/ResourceCard.tsx, ~ src/components/ResourcesModal.tsx)
2026-01-30 / Enquiry timeline workbench context chips / Re-enable enquiry/pitch context chips in timeline + quick access inline workbench for pitch cards. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-30 / Enquiry timeline pitch lookup fix / Fetch pitch content by prospect/acid so timeline shows pitch email instead of checkout-link fallback. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-30 / Resources Asana task lookup / Add Asana task lookup by ID under the Asana resource panel, with a server route to fetch task details. (~ server/routes/resources-core.js, ~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx, ~ logs/changelog.md)
2026-01-30 / Resources Asana lookup identity / Fall back to cached user data for Asana credentials when Teams context is unavailable. (~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-30 / Resources Asana lookup initials / Allow manual initials entry for Asana task lookup when identity is missing. (~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-30 / Resources Asana lookup user data / Use current app user data to resolve Asana credentials (no manual initials required). (~ src/app/App.tsx, ~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx, ~ src/components/ResourcesSidebar.tsx)
2026-01-30 / Resources Asana structure lookups / Add Asana team, user, project, and section lookup operations with dependent selection. (~ server/routes/resources-core.js, ~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-30 / Resources Asana silos UI / Redesign the Asana operations panel and load section tasks for the selected project. (~ server/routes/resources-core.js, ~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-30 / Resources Asana ops selector / Add operation picker, full team user list, gated project selection, and board-style task columns. (~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-30 / Azure box get-user action / Route “Get user” through /api/resources/analytics/graph-user using Key Vault client credentials. (~ server/routes/resources-analytics.js, ~ server/index.js, ~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-30 / Resources Clio lookups / Add Clio contact + matter lookup tools under the Clio resource panel. (~ server/routes/resources-core.js, ~ server/index.js, ~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-30 / Resources modal action panel / Show an on-brand in-app action panel when selecting a resource, instead of navigating to a blank page. (~ src/components/ResourcesModal.tsx)
2026-01-30 / Resources Teams link open / Use Teams `app.openLink` for resource opens to avoid blank pages in Teams webview. (~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-30 / Resources open-link fallback / Add pop-up blocked fallback (navigate current tab) for resource opens, fixing Azure clicks in Teams. (~ src/components/ResourcesModal.tsx, ~ src/tabs/resources/Resources.tsx)
2026-01-30 / Resources local operations panel / Clicking a resource now reveals an inline operations section (open/copy/pin) within the Resources tab. (~ src/tabs/resources/Resources.tsx)
2026-01-30 / Matters user switching cue / Show an in-context “Switching user…” overlay in Matters while data reloads (prevents void feeling on slow switches). (~ src/index.tsx, ~ src/tabs/matters/Matters.tsx)
2026-01-30 / Immediate actions empty-state collapse / Auto-collapse the “All caught up” card shortly after it appears with a smooth transition. (~ src/tabs/home/ImmediateActionsBar.tsx)
2026-01-30 / Teams tab scrolling / Added a dedicated scroll region so tab content can scroll inside Teams without locking the app shell. (~ src/app/App.tsx, ~ src/app/styles/index.css)
2026-01-30 / Instant lookup person name matching / Fix single-token surname searches (e.g. “Bedwell”) to match against last name too; prefer exact full-name matches without dropping near matches. (~ tools/instant-lookup.mjs)
2026-01-30 / Agent lookup guidance / Clarify that pipeline requests must use `instant-lookup pipeline` (not `person`) to reliably resolve legacy-space enquiries. (~ .github/copilot-instructions.md)
2026-01-30 / Lookup flow: drop default --plan / Make `--plan` optional (only when requested) so lookups can be chat-confirmed then executed directly. (~ .github/copilot-instructions.md)
2026-01-29 / AML review report (12 months) / Added scripts/amlReview12Months.mjs to produce a pasteable summary of non-UK ties (POID) and PEP warning counts (IDVerifications + periodic-compliance), with Key Vault-backed SQL connection fallback. (+ scripts/amlReview12Months.mjs)
2026-01-29 / Annual leave auto-book for AC/JW / For Alex (AC) and Jonathan (JW), new annual leave requests now skip approval/booking and are inserted as booked; booked entries create Clio+Outlook calendar events immediately, and approval updates coerce to booked. (~ server/routes/attendance.js, ~ src/CustomForms/AnnualLeaveForm.tsx)
2026-01-29 / Matters tab production rollout / Enabled Matters tab in production for Luke/Alex/Cass only, with a subtle in-tab Production indicator for those users. (~ src/app/admin.ts, ~ src/app/App.tsx, ~ src/tabs/matters/Matters.tsx)
2026-01-29 / AML report runbook / Added a runbook documenting how the AML 12-month report is produced, including data sources, windowing, PEP classification, and coverage gaps. (+ docs/AML_REVIEW_12_MONTH_REPORT_RUNBOOK.md)
2026-01-29 / Non-billable time report / Added scripts/reportNonBillableTime.mjs to report month-to-date non-billable hours per active fee earner using the same Clio activity flags as matter metrics. (+ scripts/reportNonBillableTime.mjs)
2026-01-29 / Non-billable report runbook / Added a runbook documenting how the Clio non-billable report is produced, including prerequisites, logic, and troubleshooting. (+ docs/NON_BILLABLE_CLIO_REPORT_RUNBOOK.md)
2026-01-28 / Instant lookup pipeline lookup / Added pipeline mode to return full pipeline data from any key (enquiry/pitch/instruction/matter). (~ tools/instant-lookup.mjs, ~ .github/copilot-instructions.md)
2026-01-28 / Instant lookup pipeline legacy fix / Removed invalid Matter_Ref selection from legacy enquiries to restore name lookups. (~ tools/instant-lookup.mjs)
2026-01-28 / Instant lookup legacy columns / Remove invalid Area_of_Work selection from legacy enquiries for pipeline name lookups. (~ tools/instant-lookup.mjs)
2026-01-28 / Instant lookup legacy payloads / Switch legacy pipeline lookups to SELECT * for full enquiry payloads. (~ tools/instant-lookup.mjs)
2026-01-28 / Instant lookup flexible legacy search / Build schema-aware name/email/phone/ID filters for legacy/new enquiries in pipeline lookups. (~ tools/instant-lookup.mjs)
2026-01-28 / Instant lookup full-name matching / Add full-name column and first+last concatenation matching for pipeline lookups. (~ tools/instant-lookup.mjs)
2026-01-28 / Instant lookup person schema guard / Use schema-aware filters for person lookups to avoid missing-column errors. (~ tools/instant-lookup.mjs)
2026-01-28 / Instant lookup new enquiries guard / Use schema-aware ID/email columns for new-space enquiries in pipeline lookups. (~ tools/instant-lookup.mjs)
2026-01-29 / Instant lookup column normalisation / Resolve column names case/format-insensitively to prevent invalid-column errors in name matching. (~ tools/instant-lookup.mjs)
2026-01-29 / Instant lookup instruction email guard / Use schema-aware email columns for Instructions lookup to avoid invalid ClientEmail errors. (~ tools/instant-lookup.mjs)
2026-01-29 / Instant lookup full-name filter / When a full name is provided, filter legacy/new enquiries to exact full-name matches before building pipeline keys. (~ tools/instant-lookup.mjs)
2026-01-29 / Instant lookup strict full-name / Use strict full-name matching (first+last AND/concat) for person/pipeline name lookups. (~ tools/instant-lookup.mjs)
2026-01-28 / Instant lookup plan mode / Added --plan to preview operations without executing; documented chat-first confirmation. (~ tools/instant-lookup.mjs, ~ .github/copilot-instructions.md)
2026-01-28 / Instant lookup confirm-first mode / Added --confirm to show the intended operation and require explicit yes before running. (~ tools/instant-lookup.mjs, ~ .github/copilot-instructions.md)
2026-01-28 / Instant lookup person simplification / Person lookups now return enquiries only (legacy + new) and skip deals/instructions joins. (~ tools/instant-lookup.mjs)
2026-01-28 / Instant lookup Key Vault resilience / Auto-resolve SQL connection strings via Key Vault with a fast timeout for instant lookups; document behaviour. (~ tools/instant-lookup.mjs, ~ .github/copilot-instructions.md)
2026-01-28 / Root cleanup: remove dead placeholders / Deleted empty placeholders and orphaned JSON files. (- server/utils/connectionManager.js, - api/update-enquiry.js, - api/deploy.sh, - api/.funcignore, - server/routes/aiden.json, - server/routes/x.json)
2026-01-28 / Root cleanup: remove build artefacts / Removed ignored build outputs from root and appPackage to keep repo clean. (- build/, - appPackage/build/)
2026-01-28 / Root cleanup: remove unused CRA override / Removed legacy CRA override file now unused after the CRACO switch. (- config-overrides.js)
2026-01-28 / Key Vault SQL fallback / Resolve SQL connection strings from Key Vault when env values are missing or redacted, before warming SQL pools. (~ server/index.js)
2026-01-28 / Fluent UI webpack resolution fix / Route CRA builds through CRACO and allow extensionless ESM imports to fix @fluentui/react module resolution errors. (+ craco.config.js, ~ package.json)
2026-01-28 / Database folder cleanup / Removed redundant attendance schema snapshot and rate update note; migrations removed by request (use live schema + changelog). (~ database/attendance-schema.sql, ~ database/migrations/010_2025_rate_update.md, ~ database/migrations/*, ~ .github/instructions/TEAM_DATA_REFERENCE.md)
2026-01-28 / Docs consolidation references / Added consolidated docs (PLATFORM_OPERATIONS, INSTRUCTIONS_REFERENCE, ENQUIRIES_REFERENCE, DOCUMENTS_REFERENCE, EMAIL_REFERENCE, INTEGRATIONS_REFERENCE, AZURE_OPERATIONS) and updated instructions/README links; added product guardrails + roadmap item. (~ docs/*.md, ~ .github/copilot-instructions.md, ~ .github/instructions/ROADMAP.md, ~ .github/instructions/ARCHITECTURE_DATA_FLOW.md, ~ .github/instructions/ENQUIRIES_TABLE_DESIGN_PATTERN.md, ~ README.md, ~ server/utils/logger.js, ~ server/routes/logs-stream.js)
2026-01-28 / Docs consolidation deletions / Removed consolidated legacy docs now covered by new reference files. (~ docs/*.md)
2026-01-28 / Remove one-off lookup scripts / Deleted temporary SQL/Clio lookup scripts and documented no-commit guidance. (~ scripts/dry-run-delete-test-matters.mjs, ~ scripts/dry-run-delete-specific-matters.mjs, ~ scripts/delete-specific-matters.mjs, ~ scripts/find-clio-contacts-for-matters.mjs, ~ .github/instructions/DATABASE_SCHEMA_REFERENCE.md)
2026-01-28 / Remove hardcoded credential scripts / Deleted ad-hoc scripts containing hardcoded SQL credentials. (~ scripts/queryEnquiry.mjs, ~ scripts/check-join.mjs, ~ scripts/cleanup-teresa-test.mjs, ~ scripts/check_prod_scenarios.py)
2026-01-28 / Secret redaction sweep / Removed hardcoded credentials and client-specific scripts; redacted passwords from env/docs; converted analysis scripts to use SQL_CONNECTION_STRING. (~ scripts/queryEnquiry.mjs, ~ scripts/check-join.mjs, ~ scripts/check-matter-refs.mjs, ~ scripts/fix-teresa-deal.mjs, ~ scripts/fix-teresa-prospectid.mjs, ~ scripts/verify-teresa-deal.mjs, ~ scripts/dry-run-delete-test-matters.mjs, ~ scripts/dry-run-delete-specific-matters.mjs, ~ scripts/delete-specific-matters.mjs, ~ scripts/find-clio-contacts-for-matters.mjs, ~ scripts/feeAnalysisDetailed.mjs, ~ scripts/rollingAvgFeePerMatter.mjs, ~ scripts/truePerMatterAvg.mjs, ~ .env, ~ env/.env.dev, ~ prod-settings.txt, ~ docs/SECURITY_FIX_CHECKLIST.md, ~ docs/INSTRUCT_PITCH_PENDING_CHANGES.md)
2026-01-28 / Tools migration + scripts exclusion / Moved reusable ops scripts to tools/ and excluded scripts/ from git; updated agent instructions and lookup guidance. (~ tools/sync-context.mjs, ~ tools/session-start.mjs, ~ tools/update-submodules.mjs, ~ tools/validate-instructions.mjs, ~ tools/instant-lookup.mjs, ~ .github/copilot-instructions.md, ~ .github/instructions/DATABASE_SCHEMA_REFERENCE.md, ~ .gitignore)
2026-01-28 / Docs cleanup / Removed one-off analyses, fix summaries, and non-doc artefacts; moved Key Vault setup script to tools. (~ docs/*, ~ tools/setup-keyvault-secrets.ps1, ~ docs/SECURITY_FIX_CHECKLIST.md)
2026-01-28 / Docs audit continuation / Consolidated Azure/email references and removed legacy UI/design docs to reduce noise. (~ docs/AZURE_CONFIG_REFERENCE.md, ~ docs/EMAIL_SYSTEM_QUICK_REFERENCE.md, ~ docs/MAINTENANCE_GUIDELINES.md, ~ docs/*)
2026-01-28 / Matter pipeline typing fix / Resolve circular memo typing errors after adding enquiry matching fallbacks. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-28 / Matter pipeline enquiry matching / Add instruction-ref + email/name fallbacks so Origin & Pipeline notes resolve when prospect IDs don’t align. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-28 / Matter pipeline ID parsing / Broaden instruction ref parsing so non-HLX refs still resolve prospect IDs for enquiry notes. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-28 / Matter enquiry notes sync / Inject enquiry data into pipeline workbench so notes/value appear for new vs legacy enquiries. (~ src/app/App.tsx, ~ src/tabs/matters/Matters.tsx, ~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-28 / Matter pipeline prospect ID source / Prefer deal ProspectId over instructionRef parsing when matching enquiries for workbench notes. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-28 / Matter enquiry match normalisation / Normalise enquiry keys (including ProspectId) for more reliable workbench note linking. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-28 / Matter enquiry match schema alignment / Match workbench enquiries by legacy ID or new acid only. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-28 / Matters enquiry dataset reuse / Reuse unified team-wide enquiries from Prospects (All) instead of re-fetching for Matters. (~ src/app/App.tsx, ~ src/tabs/enquiries/Enquiries.tsx)
2026-01-28 / Matters targeted enquiry fetch / Fetch single enquiry by prospectId when opening workbench to avoid full dataset load. (~ src/tabs/matters/MatterOverview.tsx, ~ server/routes/enquiries-unified.js)
2026-01-28 / Test matter cleanup dry run / Added dry-run script to preview SQL+Clio deletions for TEST/BENNE matters. (~ scripts/dry-run-delete-test-matters.mjs)
2026-01-28 / Agent DB query guidance / Documented ESM-safe mssql import for terminal scripts. (~ .github/copilot-instructions.md, ~ .github/instructions/DATABASE_SCHEMA_REFERENCE.md)
2026-01-28 / Enquiries linkage clarity / Documented legacy vs new enquiries and ProspectId→acid linkage order. (~ .github/instructions/DATABASE_SCHEMA_REFERENCE.md)
2026-01-28 / Workbench enquiry detail focus / Remove the unified origin summary strip and expand enquiry detail fallbacks/notes visibility. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-28 / Matter detail tabs gating / Disable Activities, Documents, Comms, and Billing tabs in production with a hover hint. (~ src/tabs/matters/Matters.tsx)
2026-01-28 / Matter quick info tone / Soften Quick Info value text to match the email/phone tone. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-28 / Matter client detail tone / Soften client detail value text to match the email/phone tone in the client box. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-28 / Matter WIP alignment / Exclude billed/on-bill activities so WIP matches Clio, while keeping total hours across all activities. (~ server/routes/matter-metrics.js)
2026-01-27 / Inline workbench clarity pass / Add summary strip, increase padding, and space sections for a clearer, more purposeful inline workbench. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-27 / Toast label clipping fix / Increase toast title/message line-height and padding to prevent cropped labels. (~ src/components/feedback/ToastProvider.tsx)
2026-01-27 / Clio token retry hardening / Retry Clio calls on 401 and fall back when open_date fields are rejected during matter audit. (~ server/routes/matter-metrics.js, ~ server/routes/matter-audit.js)
2026-01-26 / Matters metrics pending handling / Resolve Clio IDs via instructions DB and return pending status when matters are not yet created, avoiding hard errors for placeholders. (~ server/routes/matter-metrics.js, ~ src/tabs/matters/Matters.tsx, ~ src/tabs/matters/MatterOverview.tsx)
2026-01-27 / Matters client details linkage / Normalise InstructionRef variants and canonicalise missing HLX prefix so pipeline client details reliably show. (~ src/utils/matterNormalization.ts, ~ src/tabs/matters/MatterOverview.tsx)
2026-01-27 / Matters request clarity / Add placeholder hint and label Request ID when the record is a MatterRequest without an Instruction link. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-27 / Matter request patching / Store matter request id, capture Clio display number, and patch placeholder matter rows after instruction sync completes. (~ server/routes/matterRequests.js, ~ src/tabs/instructions/MatterOpening/processingActions.ts)
2026-01-27 / Matter sync audit mode / Add Clio sync audit endpoint and UI toggle for new matters, showing mismatch cues for key fields. (+ server/routes/matter-audit.js, ~ server/index.js, ~ server/server.js, ~ src/tabs/matters/Matters.tsx, ~ src/tabs/matters/MatterOverview.tsx)
2026-01-27 / Matter id backfill script / Add one-off backfill script to repair new-space placeholder MatterRequest IDs using Instructions.MatterId and optional Clio display numbers. (+ scripts/backfill-new-matter-ids.js)
2026-01-27 / Matter header alignment / Prefer workbench display number + client name in the header and show real matter id with separate request id when present. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-27 / Matter opening modal labels / Add line-height and padding to prevent confirmation modal titles clipping. (~ src/tabs/instructions/MatterOpening/IdentityConfirmationCard.tsx, ~ src/tabs/instructions/MatterOpening/ConflictConfirmationCard.tsx)
2026-01-26 / Matters metrics loading / Add per-matter metrics routes (WIP + client funds), parallel client fetches with toasts, and per-card loading skeletons. (~ server/routes/matter-metrics.js, ~ server/index.js, ~ src/tabs/matters/Matters.tsx, ~ src/tabs/matters/MatterOverview.tsx)
2026-01-26 / Matters details expansion / Add instruction, source/referrer, value, opponent solicitor, method, rating, and original status fields to Matter Details. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-26 / Matters client copy chips / Remove client avatar and add copy chips for email/phone in the client sidebar. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-26 / Matters details + team merge / Merge Team into Matter Details and switch detail rows to a two-column grid layout. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-26 / Matters client sidebar enrichment / Clean up contact layout, add personal + company details from pipeline data, and switch avatar for company clients. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-26 / Matters data source chip / Add legacy/all/new-only toggle state so admins can isolate new matters. (~ src/tabs/matters/Matters.tsx)
2026-01-26 / Matters detail tabs in banner / Move matter detail Pivot tabs into the sticky banner row alongside Back (Enquiries-style). (~ src/tabs/matters/Matters.tsx, ~ src/tabs/matters/MatterOverview.tsx)
2026-01-26 / Matters detail skeleton + entry / Add a quick skeleton placeholder and subtle entry animation on matter click-through to avoid blank/void loading states. (~ src/tabs/matters/Matters.tsx, ~ src/tabs/matters/MatterOverview.tsx)
2026-01-26 / Matters actions column / Add call+email buttons to table rows (no unlock/edit/delete yet). (~ src/tabs/matters/MatterTableView.tsx)
2026-01-26 / Rate change admin gating / Make Clio->SQL sync and CCL Date write operations admin-only (UI + server-side initials gate). (~ src/tabs/home/RateChangeModal.tsx, ~ server/routes/rate-changes.js, ~ server/routes/ccl-date.js)
2026-01-26 / Matters detail brand pass / Flatten Matter detail surfaces (smaller radii, calmer hover), sharpen skeletons, and add localhost-only wiring hint for backend metrics. (~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/matters/Matters.tsx)
2026-01-26 / Matters pipeline groundwork / Add an Origin & Pipeline section in matter detail with instruction/prospect linkage and placeholder pipeline status chips. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-26 / Matters workbench mirror / Embed read-only InlineWorkbench in matter detail with derived pipeline payload (pending real pipeline feed). (~ src/tabs/matters/MatterOverview.tsx)
2026-01-26 / Matters pipeline consolidation / Remove separate Origin & Pipeline panel and rename workbench section to Origin & Pipeline. (~ src/tabs/matters/MatterOverview.tsx)
2026-01-25 / Matters table timeline alignment / Add timeline header icon and shift row icon to respect the timeline gutter. (~ src/tabs/matters/MatterTableView.tsx)
2026-01-23 / Enquiries pipeline resize / Re-measure pipeline columns on tab focus/visibility to fix Teams embedded view. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-23 / Pitch costs wording / Restore original costs paragraph with explicit role rates in pitch scenario. (~ src/tabs/enquiries/pitch-builder/scenarios.ts)
2026-01-23 / Pitch amount sync guard / Limit auto-sync to estimate/budget phrasing so rates are not overwritten. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-23 / VAT toggle emphasis / Strengthen No VAT (international) styling with an info-blue emphasis. (~ src/tabs/enquiries/pitch-builder/DealCapture.tsx)
2026-01-23 / Prospect notes header actions / Align notes actions with the Notes label in the section header. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-23 / Prospect notes whiteboard / Remove duplicate notes header and add a resizable temporary whiteboard panel with session-only copy. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-23 / Enquiries table name copy feedback / Swap name copy icons to success ticks with animated feedback in main + child rows. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-23 / Prospect header contact copy feedback / Swap email/phone copy icons to animated ticks with success styling when copied. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-23 / Pitch builder header actions / Fix copy fallback and refine copy/preview button states with press/hover feedback. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-23 / Pitch builder header actions / Move copy/preview into the email body title bar and redesign button states. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-23 / Pitch builder preview toggle / Move preview toggle into the email body title bar to avoid overlaying content. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-23 / Pitch builder focus border / Restore focus border on the email body container around the header/tools. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-23 / Pitch builder editor shell / Remove inner editor box styling for the email body text area. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-23 / Pitch builder body shell / Remove the outer pitch-step-card shell around the email body area. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-22 / Pitch builder scenario neutrality / Flatten scenario card corners and soften selection emphasis. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-22 / Prospect header animation guard / Prevent repeated entry animations in the Prospect & Enquiry header. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-22 / Pitch builder scenario tone / Inline pitch history text in step 1 and neutralise scenario card base styling. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-22 / Prospect header entry cascade / Add subtle content-reveal cascade on the Prospect & Enquiry header for smoother entry. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-22 / Pitch builder step 1 header / Show template step header on entry and move pitch history banner into step 1. (~ src/tabs/enquiries/PitchBuilder.tsx, ~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx, ~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx)
2026-01-22 / Prospect header skeletons / Add shimmer + cascade loading skeletons to the Prospect & Enquiry header sections. (~ src/tabs/enquiries/components/ProspectHeader.tsx, ~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx)
2026-01-22 / Custom tabs active style / Remove selected tab pane background so active state is underline-only. (~ src/app/styles/CustomTabs.css)
2026-01-22 / Pitch builder header banner / Flatten Prospect & Enquiry header into a banner with side breathing room and top/bottom separation. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-22 / Pitch builder quality polish / Sharpen step/card corners and add smoother transitions for the pitch builder flow. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-22 / Pitch builder steps containment / Contain wizard steps in compact cards for clearer, more professional grouping. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-22 / Pitch context banner tone / Switch Pitch Builder context banner to an informational blue style (less warning). (~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx)
2026-01-22 / Custom tabs active colour / Force highlight blue for active navigation tabs in light mode. (~ src/app/styles/CustomTabs.css)
2026-01-22 / Enquiries sub-tab accent colour / Force highlight blue for Overview/Pitch Builder tab accents in dark mode as well. (~ src/app/styles/CustomTabs.css)
2026-01-22 / Enquiries table open pitch builder / Table-view row click now opens the Pitch builder instead of landing on the overview/timeline by default. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-22 / Pitch builder sync feedback / Add single-flight amount sync with origin token and deduped toast feedback. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx)
2026-01-22 / Pitch builder amount live-sync / Simplified amount sync into a deterministic effect, added sync helper + tests to update the email body on every amount change. (~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx, ~ src/tabs/enquiries/pitch-builder/__tests__/syncAmountIntoBody.test.ts)
2026-01-22 / Dev dashboard health checks upgrade / Replace 3 hardcoded checks with a route registry + observed GET routes from Ops; add reachability semantics, last-checked timestamps, and optional auto-ping interval. (~ src/components/AdminDashboard.tsx)
2026-01-22 / Changelog modal readability / Rename “Release Notes” UI to “Changelog”, group entries by date, include descriptions, add search + collapsible days, and flag that curated Release Notes are planned. (~ src/components/ReleaseNotesModal.tsx, ~ src/components/UserBubble.tsx)
2026-01-22 / Ideas tab simplified / Removed over-detailed “requirements scaffolds”; keep ideas as lightweight flags with tags + short notes. (~ src/components/ReleaseNotesModal.tsx)
2026-01-22 / Financial forms: show submission errors / Financial form submit now surfaces API/network errors (and missing initials) in the UI instead of failing silently; button label shows “Submitting…”. (~ src/tabs/forms/FormDetails.tsx, ~ src/CustomForms/BespokeForms.tsx, ~ server/routes/financialTask.js)
2026-01-22 / Financial forms: Asana refresh resilience / Improve Asana token refresh to use form-encoded body, return structured errors with safe upstream details, and retry transient 5xx/429 so intermittent failures don’t look like “nothing happened”. (~ server/routes/financialTask.js)
2026-01-22 / Dev dashboard redesign / Rework Dev Dashboard into a purpose-built dev tooling portal: integrated Inspector section (embedded, no nested modal), real endpoint health checks, and upgraded Overview/Diagnostics. (~ src/components/AdminDashboard.tsx, ~ src/components/DataInspector.tsx)
2026-01-22 / Asana chip icon / Use Asana SVG icon for the Asana Integration chip in the user bubble. (~ src/components/UserBubble.tsx)
2026-01-22 / Dev dashboard consolidation / Rename Admin Dashboard to Dev Dashboard; remove separate Application Inspector menu entry and expose it from within the Dev Dashboard; drop prompt-based gating that could block opening in Teams. (~ src/components/UserBubble.tsx, ~ src/components/AdminDashboard.tsx)
2026-01-22 / Release notes modal / Add admin-only Release Notes modal (Release notes + Ideas tabs) opened from user bubble; serve changelog via backend endpoint instead of CRA dev proxy; remove dev-only session changes UI. (~ src/components/ReleaseNotesModal.tsx, ~ src/components/UserBubble.tsx, ~ src/app/styles/CustomTabs.tsx, ~ server/routes/release-notes.js, ~ server/index.js, ~ src/tabs/home/Home.tsx, ~ src/tabs/home/QuickActionsBar.tsx, ~ src/setupProxy.js)
2026-01-22 / Top files CSV export / Add script to export top 20 Commercial/Property matters (last 12 months) by opening value and by invoiced (net, Service-only by default; optional includeDisbursements) into 4 CSV files. (~ scripts/exportTopValueFiles.mjs, ~ package.json)
2026-01-21 / Enquiries instruction chip dates / Expand instruction date/time field fallbacks so claimed/all views show date+time instead of Inst. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-20 / Enquiries header/row alignment + carousel / Unify table header+row grid spacing and enforce minimum pipeline chip widths so the carousel triggers (no squishing); reset header carousel offset on tab/view switch. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-20 / Fix enquiries POC chip squish / Adjusted POC and claim chip min widths and centering styles in [src/tabs/enquiries/Enquiries.tsx](src/tabs/enquiries/Enquiries.tsx)
2026-01-20 / POC column alignment / Add box styling to Unclaimed POC header; center POC cell content (claim prompt, initials stack, legacy placeholder) under header without breaking internal 3-element alignment. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-20 / Unclaimed claim button fix / Treat team@helix-law.com and other inbox values as unclaimed; show subtle claim prompt instead of "Team" text; use isUnclaimedPoc helper consistently. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Unclaimed area filtering removed / Claimable (Unclaimed) tab now shows all enquiries regardless of user's profile Area of Work - users can still optionally filter by area using toggles. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Matter detail Clio-style redesign / Complete rewrite of MatterOverview with dark mode support, tabbed navigation, metric cards, team display, and client sidebar matching Clio Manage layout. (~ src/tabs/matters/MatterOverview.tsx, ~ src/tabs/matters/Matters.tsx)
2026-01-19 / Matters scope filters / Skip role filter for admin All scope so Mine/All counts diverge correctly. (~ src/tabs/matters/Matters.tsx)
2026-01-19 / Matters scope counts / Align Mine/All counts with admin detection so scope badges update correctly. (~ src/tabs/matters/Matters.tsx)
2026-01-19 / Matters table default / Make table view the only Matters view and default on entry. (~ src/tabs/matters/Matters.tsx)
2026-01-19 / Clients column sizing / Match Clients column widths to the Enquiries grid for consistent spacing. (~ src/tabs/instructions/InstructionTableView.tsx)
2026-01-19 / Clients column order / Reorder Clients table columns to match Enquiries (date, name, ID/value, AOW, pipeline). (~ src/tabs/instructions/InstructionTableView.tsx)
2026-01-19 / Clients actions gating / Hide the edit action until Actions is enabled. (~ src/tabs/instructions/InstructionTableView.tsx)
2026-01-19 / Clients day separators / Replace banner-style day headers with subtle separator lines to match Enquiries. (~ src/tabs/instructions/InstructionTableView.tsx)
2026-01-19 / Clients header hover layout / Shift client name on hover and reveal email in group headers to match Enquiries spacing. (~ src/tabs/instructions/InstructionTableView.tsx)
2026-01-19 / Clients pipeline connector alignment / Tighten instruction pipeline connectors so lines touch chip borders cleanly. (~ src/tabs/instructions/InstructionTableView.tsx)
2026-01-19 / Clients table hover details / Align Clients table detail reveal with Enquiries by showing email/value on row hover. (~ src/tabs/instructions/InstructionTableView.tsx)
2026-01-19 / Instructions search debounce / Debounce Clients/Instructions search input in the FilterBanner to keep typing responsive in large tabs. (~ src/components/filter/FilterBanner.tsx, ~ src/tabs/instructions/Instructions.tsx)
2026-01-19 / Enquiries unclaimed visibility / Treat null/empty/unassigned POC values as unclaimed in UI filtering/suppression. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Enquiries unclaimed visibility / Include null/empty POC values in Team Inbox filtering so new unclaimed records surface. (~ server/routes/enquiries-unified.js)
2026-01-19 / Enquiries pulse refresh / Add lightweight pulse endpoint + client polling to detect new enquiries from both sources. (~ server/routes/enquiries-unified.js, ~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Enquiries pipeline carousel fix / Prevent post-pitch chips from wrapping into a second row when the carousel is active. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Enquiries pipeline icons only / Remove status dots so pipeline chips rely on icons and colour. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Enquiries hover shift / Shift ID/name upward on hover and reveal stacked details without changing row height. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Matters timeline line offset / Shift accent line to avoid overlapping the matter icon column. (~ src/tabs/matters/MatterTableView.tsx)
2026-01-19 / Enquiries hover layout / Expand ID/email stacks only on hover so names stay centred at rest. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Matters table parity / Align day separators and group hover cues with the Enquiries table styling. (~ src/tabs/matters/MatterTableView.tsx)
2026-01-19 / Enquiries timeline accents / Increase timeline line prominence at rest and on hover for clearer AOW cues. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Enquiries row-hover details / Smooth row-hover reveal for email/value with subtle transitions. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Edit enquiry modal prompts clarity / Restyle access/error/success prompts to match InlineWorkbench status banners for clearer guidance. (~ src/tabs/enquiries/EditEnquiryModal.tsx)
2026-01-19 / Edit enquiry modal redesign / Refresh modal styling, spacing, and input treatments to match the new dark card layout. (~ src/tabs/enquiries/EditEnquiryModal.tsx)
2026-01-19 / Enquiries timeline line AOW colour / Colour the left timeline line per Area of Work. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Enquiries hover details / Hide email/value until day group hover to reduce table noise. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Enquiries day separators softened / Replace banner separators with subtle fading lines and extra whitespace. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Enquiries table layout simplified / Move prospect to the first column and rebalance ID/AOW/Date order for clarity. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Matters table headers sortable / Add header sorting with date grouping only on Opened. (~ src/tabs/matters/MatterTableView.tsx)
2026-01-19 / Matters legacy data restored / Use unified matters fetch in local dev so legacy/all records are included. (~ src/index.tsx)
2026-01-19 / Matters table aligned to prospects/clients / Match Matters table container + header styling to the Prospects/Clients tables. (~ src/tabs/matters/MatterTableView.tsx)
2026-01-19 / Matters source toggle removed / Show all sources by default and drop legacy/new toggle. (~ src/tabs/matters/Matters.tsx)
2026-01-19 / Matters filter icons + order / Make Mine/All first and add iconed Open/Archived + Responsible/Originating toggles. (~ src/tabs/matters/Matters.tsx)
2026-01-19 / Admin filter cues / Add subtle admin-only rings for Matters dataset toggle and Enquiries Triaged filter. (~ src/tabs/matters/Matters.tsx, ~ src/tabs/enquiries/Enquiries.tsx)
2026-01-19 / Matters initials matching / Match solicitor initials to full names so matters role detection doesn’t drop all records. (~ src/utils/matterNormalization.ts)
2026-01-19 / Conversion metric animation redo / Replace conversion metric count-ups with one-time animated values to stop retriggers on first entry/toggle. (~ src/components/modern/EnquiryMetricsV2.tsx)
2026-01-19 / Home metric animation redo / Replace the home metric count-up with a one-time animated number to stop repeat retriggers on first entry. (~ src/tabs/home/MetricCard.tsx)
2026-01-19 / Home time metrics load timeout / Add a 12s WIP fetch timeout and clear loading state if the home-wip request stalls, preventing infinite loading on first entry. (~ src/tabs/home/Home.tsx)
2026-01-18 / Timeline pitch fallback from enrichment / When no pitches found by enquiry ID, fall back to email-based enrichment data so deals show in workbench. (~ src/tabs/enquiries/EnquiryTimeline.tsx, ~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries payment chip shows pending color / Payment chip now shows orange/blue for pending payments instead of neutral grey. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries eager enrichment prefetch / Fire parallel micro-batches on initial load so hover data is ready before user even scrolls. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries enrichment prioritise speed / Increase batch size, remove debounce, and prefetch farther ahead for faster pipeline updates. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries pipeline pulse unified / Use a single smooth pulse animation for pitch/ID cue dots to keep timing consistent. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries payment icon uses GBP / Replace money stack icon with CurrencyPound in payment pipeline stages to keep the cue visible. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries pipeline hover cleanup / Auto-hide stuck pipeline hover tooltip on mouse move off chips, scroll, or window blur. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries pipeline placeholder shows instruction / Align loading placeholder pipeline icons with actual stages so Inst appears while processing. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries pipeline uses ACID for workbench / Resolve inline workbench lookup by ACID/prospect ID so enquiry pipeline reflects instruction-linked stages. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Prospect overview selection prefers instruction / Resolve selected overview item by InstructionRef/DealId/ProspectId to align deal clicks with instruction-linked workbench data. (~ src/tabs/instructions/Instructions.tsx)
2026-01-17 / Tech tickets Asana auth + ledger refresh / Use Key Vault + team table Asana credentials for tech tickets and redesign the ledger rows with clearer status chips, readable text, and edit/delete actions. (~ server/routes/techTickets.js, ~ src/CustomForms/shared/TechTicketsLedger.tsx)
2026-01-17 / Tech tickets Asana fixes / Remove workspace ID from task creation and store submitter initials to avoid SQL truncation. (~ server/routes/techTickets.js)
2026-01-17 / Annual leave day selection date compare / Use date-only comparisons for selectable days to prevent time-of-day blocking and zero-day counts. (~ src/CustomForms/AnnualLeaveModal.tsx)
2026-01-17 / Annual leave modal fallback fetch / Modal now self-fetches leave data when Home props are empty to avoid blank history. (~ src/CustomForms/AnnualLeaveModal.tsx)
2026-01-17 / Annual leave timestamps / Added request/approval/booking timestamps with schema migration and history display. (~ server/routes/attendance.js, ~ database/migrations/013_annual_leave_timestamps.sql, ~ src/CustomForms/AnnualLeaveModal.tsx, ~ src/tabs/home/Home.tsx, ~ src/app/functionality/types.ts)
2026-01-17 / Annual leave bulk update / Added multi-select and bulk status/days updates for leave history in the modal. (~ src/CustomForms/AnnualLeaveModal.tsx)
2026-01-17 / Annual leave modal loading skeletons / Show loading skeletons and guard empty states while annual leave data loads. (~ src/CustomForms/AnnualLeaveModal.tsx, ~ src/tabs/home/Home.tsx)
2026-01-17 / Annual leave modal edit refresh / Admin edits now refresh viewed employee data without closing the modal. (~ src/CustomForms/AnnualLeaveModal.tsx)
2026-01-17 / Annual leave modal scroll + ledger cleanup / Removed nested scrollbars and simplified the leave history header controls. (~ src/CustomForms/AnnualLeaveModal.tsx)
2026-01-17 / Annual leave Outlook calendar sync / Create Outlook calendar entries when leave is booked, store event id, and delete on record removal. (~ server/routes/attendance.js, ~ database/migrations/012_annual_leave_outlook_entry_id.sql)
2026-01-17 / Annual leave modal next-year stats swap / Stats card now swaps to a distinct next-fiscal-year layout with clear signposting when the selection is entirely next year. (~ src/CustomForms/AnnualLeaveModal.tsx)
2026-01-17 / Enquiries pipeline hover positioning / Tooltip shows below chip without jolt (removed scaling, animation, centering). (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Enquiries rating chip + modal descriptions / Rating action chip now reflects Good/Neutral/Poor visuals and the rate modal shows full descriptive text. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Enquiries actions column / Moved call/email/rate into the right actions column (no hover overlay) and show edit/delete only when Actions is enabled. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Enquiries table phone hidden / Removed phone display from child enquiry rows to keep pipeline columns aligned. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Grouped prospect count badge / Moved enquiry count into the chevron badge for grouped prospects (no extra chip). (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Clear filters resets search / Clearing all filters now resets the debounced search term so results return immediately. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Grouped prospects clarity / Grouped prospect banner and child rows now label enquiries explicitly (count chip, Prospect label, and per-enquiry index) to avoid confusion. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Timeline chip cleanup / Inline workbench in enquiry timeline now hides Enquiry/Pitch chips and shows Instructed as green when stage is initialised (without tick). (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Passcode link copy fallback / Clipboard copy now falls back to execCommand when Clipboard API is blocked (Teams/webview), fixing “copy link” after generation. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-15 / Enquiry default tab honours pitch enrichment / Selecting an enquiry now opens Timeline when pitch data or pitch ID is present, avoiding Pitch Builder for already-pitched enquiries. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-15 / Timeline deals unified / Timeline now treats all pitch records as deals and signposts whether each was created via pitch email or link enablement. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Timeline deal content signposting / Link-enabled deals now show a clear “no email content” callout and hide the forward-email action. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Timeline doc-request pitch styling / Doc request (workspace) entries now render with a pitch-style icon/chip and distinct colour to match deal items. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Timeline loading skeletons / Added shimmer skeletons for processing sources and initial timeline load to match Home page loading states. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Timeline cache revalidation / Session cache now revalidates in the background so newly generated deals appear without hard refresh. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Link-only deal rendering / Manual link deals now show a checkout link block (no email content) in the timeline. (~ src/tabs/enquiries/EnquiryTimeline.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx)
2026-01-15 / Link-only deal flagging / Manual link generation now flags Status=CHECKOUT_LINK (and DealKind if available). (~ src/tabs/enquiries/PitchBuilder.tsx, ~ server/routes/dealCapture.js, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Pitch Builder draft restore guard + timeline cache bust / Draft values (including service description) only restore when resume is enabled; pitches fetch now busts cache so newly captured deals appear immediately. (~ src/tabs/enquiries/PitchBuilder.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Deal capture de-dupe removed / Removed recent-duplicate detection so every capture creates a new deal/passcode and timeline entry. (~ server/routes/dealCapture.js)
2026-01-15 / Pitch Builder link activation lock / Added activation mode (pitch vs manual) and lockout for scenario/editor when manual activation is selected; updated manual activation helper copy and required field markers. (~ src/tabs/enquiries/components/ProspectHeader.tsx, ~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx, ~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-15 / Pitch Builder notes + prompt layout / Moved enquiry notes into the ProspectHeader as a full-width second row and redesigned the pre-scenario pitch-context prompt as an InlineWorkbench-style banner. (~ src/tabs/enquiries/components/ProspectHeader.tsx, ~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx)
2026-01-15 / Deal details input focus hardening / Switched the Deal details Service description + Amount fields to uncontrolled refs with safe prop sync, preventing focus loss while typing under re-render pressure. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-15 / Enable Link input fix + Link Enabled timeline event / Fixed service description input losing focus on each keystroke (was caused by parent state update triggering component re-render). Added 'link-enabled' as a distinct timeline event type for deals captured without sending a pitch email - shows with purple link icon and "Link Enabled" label in both card and ledger views. (~ src/tabs/enquiries/components/ProspectHeader.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Pitch Builder flattened + Timeline ledger mode / Removed card-based context panel from Pitch Builder header - replaced with minimal inline hints (unconverted pitch warning, notes toggle) so scenario selection appears immediately after the prospect header. Added toggleable "ledger mode" to Enquiry Timeline that renders a clean Clio-style table instead of nested cards with animations. Toggle persists in localStorage. (~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Pitch Builder layout flattening / Reduced pre-scenario clutter by collapsing pitch context + notes into a single compact panel, and moved extracted-section option blocks below the main composer so scenario selection appears sooner. (~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx)
2026-01-15 / Prospect contact actions / Standardised contact display under the client name (email + phone inline with subtle separator, tap-to-email/call and one-click copy) in InlineWorkbench. In Pitch Builder Prospect & Enquiry header, keep contact on the right under the “Contact” subheading with the same actions/copy. (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-15 / Pitch Builder passcode link gating / Passcode now displays as an instruction link that stays masked/uncopyable until the user confirms Amount + Service Description and triggers Deal capture (same flow as after pitching). (~ src/tabs/enquiries/components/ProspectHeader.tsx, ~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx)
2026-01-15 / Pitch history context + Timeline endpoint fix / Pitch Builder header banner now warns when there are previous unconverted pitches (no “saved draft” wording). Enquiry Timeline no longer calls missing `/api/instruction-data` and instead derives lightweight pitch status directly from `/api/pitches`. (~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-12 / Prospects: pipeline column icon-only / Pipeline header now shows labels only; pipeline cells render icon-only states (neutral when absent, coloured when present) and the claim prompt chip supports icon-only mode in the grid. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-12 / Payments: deal capture DB connection-string parsing fix / Support Data Source/Database variants (not just Server/Initial Catalog) so production doesn’t silently connect to the wrong DB and fail with “Invalid object name 'Deals'”. Mark missing-Deals-table as recoverable to avoid hard-failing email flows. (~ server/routes/dealCapture.js)
2026-01-12 / Console noise + missing endpoints fixes / Initialise Fluent UI icons before first render (stops “icon not registered” warnings); fix doc-workspace pending-actions URL to avoid `/api/api` double prefix; mount CallRail route in prod entrypoint; downgrade doc-workspace blob auth failures to 200 empty payload to avoid 500 spam. (~ src/index.tsx, ~ src/tabs/home/Home.tsx, ~ server/server.js, ~ server/routes/doc-workspace.js)
2026-01-11 / Enquiries: pipeline header alignment polish / Reserve a fixed gutter column (used for Clear Filters) across pipeline header + rows so headings stay perfectly aligned with chips even when the clear button appears. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: pipeline header de-dup / Remove the separate pipeline headings row; the filter row now serves as the header so labels aren’t duplicated. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: pipeline filter chip consistency / Standardise tri-state filter indicators: ✓ for Has, ✕ for No (removes mixed dot/tick behaviour). (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: POC filter chip consistency / Replace the POC filter active dot with the same ✓ indicator used for other active filters. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: Claimed tab claim filter cleanup / Hide redundant Claim tri-state stage filter in Claimed tab (claim is guaranteed); keep the person/POC filter only; ignore any persisted claimed-stage filter while in Claimed. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: prefetch instruction data / Allow instruction data fetch when Prospects tab is active (for InlineWorkbench expansion), gated to users with Clients access; fixes “only notes” expansions unless Clients tab visited first. (~ src/app/App.tsx)
2026-01-11 / Enquiries: stacked date/time/ago / Enquiries table date column now renders as 3-line stack (weekday, date + optional time, and “x days ago”) with full timestamp preserved in tooltip. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: pipeline + table readability / Removed Value column and stacked Value under ID to free space for Pipeline; added post-pitch stages; improved date cell readability. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: fixed pipeline columns / Converted the pipeline header + row indicators into a fixed 8-column grid (Teams, Claim, Pitch, Inst, ID, £, Risk, Matter) so headings align and the table doesn’t shift. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Prospects: context chips not faded / When `enableContextStageChips` is enabled, Enquiry/Pitch/Instructed chips use the same status palette as the main workbench tabs (no greyed/faded styling) and connector lines reflect prior stage status. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-11 / Prospects: context chips show data / Clicking Enquiry now opens a lightweight context panel in the workbench Details view; Pitch uses a full-width Details-layout card showing pitch fields (amount/service/passcode etc); Instructed focuses the standard Details landing view. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-11 / Prospects: enable pipeline context chips / InlineWorkbench now allows Enquiry/Pitch/Instructed chips to be clickable when rendered in Prospects (Enquiry navigates back to Prospects; Pitch/Instructed focus Details). (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/*)
2026-01-11 / Enquiries cards: InlineWorkbench expansion / Card view expansions now show InlineWorkbench (claimed/unclaimed/grouped) and linkage is more resilient (wrapper prospectId + deal-only records). (~ src/tabs/enquiries/Enquiries.tsx, ~ src/tabs/enquiries/ClaimedEnquiryCard.tsx, ~ src/tabs/enquiries/NewUnclaimedEnquiryCard.tsx, ~ src/tabs/enquiries/GroupedEnquiryCard.tsx, ~ src/tabs/enquiries/EnquiryLineItem.tsx, ~ src/tabs/enquiries/UnclaimedEnquiries.tsx)
2026-01-11 / Prospects: InlineWorkbench duplication / Show the existing Instructions InlineWorkbench under expanded Prospects (enquiries) table rows when linked instruction data exists; rows are expandable even when there are no notes. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-12 / Demo mode: instructions table demo row / When demo mode is enabled (UserBubble), Clients/Instructions table prepends a synthetic demo client/instruction row for screenshots and walkthroughs. (+ src/app/App.tsx, + src/tabs/instructions/Instructions.tsx)
2026-01-12 / Payments: deal capture SQL hardening + Redis log spam throttle / Schema-qualify Deals-related tables (dbo.*) to avoid default-schema issues and include dbName in failure logs; add cooldown + rate-limited logging for noisy Redis socket-close errors. (~ server/routes/dealCapture.js, ~ server/utils/redisClient.js)
2026-01-12 / ID verification: start verification modal clarity / Replaced notification controls with a clear summary of what checks run and confirmation that no client email is sent from Helix Hub; avoids leaving the user in the dark after clicking Start Verification. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-12 / Demo mode: ID verification simulation / Demo instruction now simulates EID processing → completion and updates the same pipeline/workbench UI states without performing any provider calls. (~ src/tabs/instructions/Instructions.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-10 / Reporting: WIP current week DB fallback / Fixed Management Dashboard not showing current week WIP when Clio unavailable. When wipClioCurrentWeek fails (401/token issues), stream now properly signals error status (instead of empty data) so frontend merge logic falls back to wipDbCurrentWeek dataset. Also added user credential fallback (lz/jw/ac) to reporting.js when clio-pbi token unavailable. (~ server/routes/reporting-stream.js, ~ server/routes/reporting.js)
2026-01-08 / ReportingHome + ManagementDashboard UX polish / Applied InlineWorkbench design patterns across reporting screens: added shimmer/pulse/slideIn/scaleIn animations, uppercase 9px section labels with letter-spacing, processing modal overlay that shows during data refresh, wired isFetching state to processing modal display, borderRadius: 0 throughout, fadeInUp entrance animations for sections, skeleton shimmer utility class in CSS. Dashboard now shows lightweight processing modal during refresh operations with spinner and progress bar. (~ src/tabs/Reporting/ReportingHome.tsx, ~ src/tabs/Reporting/ManagementDashboard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)
2026-01-09 / Reporting: totals explainer + disbursements toggle / Added a Disbursements include/exclude toggle (affects current + previous period Collected) and a bottom click-to-explain callout quantifying KPI vs table total deltas and explaining scope differences (all data vs visible members). (~ src/tabs/Reporting/ManagementDashboard.tsx)
2026-01-09 / Senior Partner role support / Treat “Senior Partner” as partner-class in reporting role filters and matter opening supervising partner selection; add Senior Partner role option where roles are selectable and ensure Partner selection still includes Senior Partner members. (~ src/tabs/Reporting/ManagementDashboard.tsx, ~ src/tabs/Reporting/MattersReport.tsx, ~ src/tabs/Reporting/EnquiriesReport.tsx, ~ src/tabs/Reporting/AnnualLeaveReport.tsx, ~ src/tabs/instructions/NewMatters.tsx, ~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx, ~ src/tabs/instructions/DocumentEditorPage.tsx, ~ src/tabs/home/WeeklyAttendanceView.tsx)
2026-01-07 / Home time metrics load delay / Fixed ~5–10s delay in metrics appearing on Home load. Root cause: parallel fetch effect triggered 3x due to unstable deps (email/initials derived from userData), first 2 runs discarded as stale. LZ/Luke/localhost users had no Clio ID → home-wip returned zeros → triggered slow reporting fallback. Solution: removed email/initials from effect deps (derived from userData anyway), added Alex fallback logic to parallel fetch (matches handleRefreshTimeMetrics pattern), only trigger reporting fallback when truly needed (data exists but all zeros). Metrics now land immediately using lightweight endpoint, no unnecessary fallback. (~ src/tabs/home/Home.tsx)
2026-01-07 / To Do skeleton load / To Do now starts with skeleton chips and only shows the empty "All caught up" state after actions settle, avoiding the green empty-state flash before cards appear. (~ src/tabs/home/ImmediateActionsBar.tsx, ~ src/tabs/home/Home.tsx)
2026-01-07 / Annual leave approval To Do chip subtitle / Fix annual leave parallel-fetch mapping to preserve `person`/leave fields so “Approve Annual Leave” shows initials/names again. (~ src/tabs/home/Home.tsx)
2026-01-08 / Annual leave local+demo parity / In local data mode, derive annual leave approvers from team `AOW` (production routing). In demo mode, show a single “Approve Annual Leave (Demo)” To Do card instead of live approvals. (~ src/tabs/home/Home.tsx)
2026-01-11 / Annual leave approvals: construction routing fix / Stop treating AC as a broad-visibility approver; approvals now follow per-request `approvers` so construction requests show for JW + LZ only, and non-construction for AC + LZ. Also harden construction detection (AOW contains 'construction' or 'cs') in local-mode derivation and backend determineApprovers. (~ src/tabs/home/Home.tsx, ~ api/src/functions/getAnnualLeave.ts)
2026-01-11 / Demo mode: annual leave test cards / Remove the separate “Annual Leave Test Cards” feature toggle and make annual leave demo/test To Do cards controlled solely by the Demo Mode toggle. (~ src/components/UserBubble.tsx, ~ src/tabs/home/Home.tsx)
2026-01-08 / Attendance confirm modal crash / Repair TSX corruption in attendance confirm components and harden Week_Start normalisation + null-safe guards to prevent ErrorBoundary crash on open. (~ src/tabs/home/AttendanceConfirmPanel.tsx, ~ src/tabs/home/PersonalAttendanceConfirm.tsx)
2026-01-08 / Demo mode To Dos / Demo mode now forces demo To Do cards (Approve Annual Leave + Book Requested Leave + Confirm Attendance) and avoids writing live attendance during demos. Demo mode persists as a user-bubble toggle via localStorage. (~ src/app/App.tsx, ~ src/components/UserBubble.tsx, ~ src/tabs/home/Home.tsx, ~ src/tabs/home/PersonalAttendanceConfirm.tsx)
2026-01-08 / Metrics previous-period toggle + header status chip / Add a Current/Previous toggle in the Time Metrics header (applies to both Time + Conversion cards). Make the “Syncing Clio…” badge morph into an “Updated” badge in the same spot after refresh completes; label deltas as “vs previous” and prevent the initial count-up animation from re-running when viewing previous. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-01-08 / Clarify “Previous” meaning / For “Time Today”, Previous now means same weekday last week, with an explicit secondary “Yesterday” line when available. Week-to-date comparisons align to last week-to-date. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/tabs/home/Home.tsx)
2026-01-08 / Home metrics delta tooltips / Remove modal/sidepane explainer and card-click breakdowns. Add subtle hover info bubbles next to delta indicators (Current view only), hide deltas when viewing Previous, and rename card titles in Previous view for clarity. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-01-08 / Home metrics details modal / Make Time + Conversion metric cards subtly clickable and open a Workbench-style modal explaining what each metric includes (period, comparator, optional AOW breakdown). (+ src/components/modern/MetricDetailsModal.tsx, ~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-01-07 / Fix financial forms / Registered `/api/financial-task` on legacy server entrypoint (+ server/server.js)
2026-01-07 / Home time metrics dropping to 0 / Don't abort fetch controller on effect cleanup (was killing requests in React Strict Mode before they completed); treat `/api/home-wip` `{ error }` as failure; extend stale cache TTL; retry once on Clio 401 after clearing token cache (+ src/tabs/home/Home.tsx, server/routes/home-wip.js)
# Changelog
 2026-01-06 / Rate change modal: bulk pressure test outstanding matters / Added `scripts/bulkPressureTestRateChangeOutstanding.mjs` to bulk sync outstanding (pending) matters via `/api/rate-changes/sync-matters`. Hardened the bulk sync endpoint with 429 backoff + light throttling to avoid Clio rate limits. (~ server/routes/rate-changes.js, + scripts/bulkPressureTestRateChangeOutstanding.mjs)

 2026-01-12 / Cleaned up Data Flow workbench copy to match current architecture (simplified UI → /api → Functions/Express → DBs/integrations) and removed outdated “Instructions vs Enquiries” narrative.
 2026-01-06 / Rate change modal: hide new-rate matters / Exclude matters opened in the rate-change year from the main notification list (opened on/after 1 Jan 2026), while keeping them available under the Migrate tab via a separate dataset fetch. (~ server/routes/rate-changes.js, ~ src/tabs/home/useRateChangeData.ts, ~ src/tabs/home/Home.tsx, ~ src/tabs/home/RateChangeModal.tsx)
- 2026-01-06 / Enquiries realtime stream / Added SSE stream at `/api/enquiries-unified/stream`, broadcast on update/create/delete/cleanup and claim; Enquiries tab subscribes when active with debounced refresh; throttled server cache flush in refreshEnquiries. (server/utils/enquiries-stream.js, server/routes/enquiries-unified.js, server/routes/claimEnquiry.js, server/index.js, src/tabs/enquiries/Enquiries.tsx, src/index.tsx, src/setupProxy.js)

- 2026-01-06 / Enquiries stream debugging logs / Added reason-tagged console logs for team-wide fetch triggers + SSE lifecycle/events to quickly diagnose repeated `/api/enquiries-unified` calls without logging PII. (~ src/tabs/enquiries/Enquiries.tsx)

- 2026-01-07 / Enquiries realtime claim patch / SSE claim events now include `claimedAt`, and the Enquiries UI applies an immediate local patch (POC + optional claim time) so claimed/unclaimed filters and counts update instantly; keeps a slower backstop refresh to reconcile. (~ server/routes/claimEnquiry.js, ~ src/tabs/enquiries/Enquiries.tsx)

- 2026-01-07 / Enquiries realtime external claims / While SSE clients are connected, Hub now polls `TeamsBotActivityTracking.UpdatedAt` and broadcasts claim/unclaim changes as SSE events, so the Enquiries UI responds in realtime even when claims originate outside Hub routes (e.g. platform/Teams bot). (~ server/utils/enquiries-stream.js, ~ src/tabs/enquiries/Enquiries.tsx)

- 2026-01-07 / Enquiries realtime watcher hardening / Deduped external-claim broadcasts per enquiryId and switched the polling watermark compare to `UpdatedAt >= since` to avoid edge-case misses; increased batch size. (~ server/utils/enquiries-stream.js)

- 2026-01-07 / Local dev startup stabilisation / Auto-resets corrupted Azurite state on boot; avoids `/api/matters-unified` cold-start stalls in local dev; treats doc-workspace blob auth failures as empty results. (~ scripts/startAzurite.mjs, ~ package.json, ~ src/index.tsx, ~ server/routes/doc-workspace.js)

- 2026-01-07 / Home metrics stability / Avoid deprecated `/api/getAllMatters` 410s in local dev and harden WIP metrics fetch against abort/race (dedupe, cancel, retry once). Also cleaned up a few new lint warnings introduced during the change. (~ src/index.tsx, ~ src/tabs/home/Home.tsx)

- 2026-01-07 / Dead code cleanup (round 1) / Removed a handful of clearly-unused imports/consts flagged by ESLint (safe, no behaviour changes). Added roadmap item for broader cleanup. (~ src/tabs/home/*, ~ .github/instructions/ROADMAP.md)

- 2026-01-07 / Dead code cleanup (round 2) / Removed additional clearly-unused imports/vars in Home tab components (safe, no behaviour changes). (~ src/tabs/home/ActionSection.tsx, ~ src/tabs/home/AttendanceCompact.tsx, ~ src/tabs/home/EnhancedAttendanceNew.tsx, ~ src/tabs/home/HomePanel.tsx, ~ src/tabs/home/PersonalAttendanceConfirm.tsx)

- 2026-01-07 / Home page enquiry metrics standalone route / Created `/api/home-enquiries` endpoint that returns aggregated enquiry counts (today/week/month + prev periods + matters opened) via server-side SQL instead of client-side filtering. Queries both legacy and instructions DBs, 60s Redis cache with stale fallback. Home now fetches this lightweight endpoint independently of the heavy enquiries-unified payload. Added separate `isLoadingEnquiryMetrics` prop for skeleton state. (+ server/routes/home-enquiries.js, ~ server/server.js, ~ src/tabs/home/Home.tsx, ~ src/components/modern/TimeMetricsV2.tsx)

- 2026-01-06 / ChunkLoadError auto-recovery / Added a one-time reload fallback when CRA code-split chunks fail to load (common after dev server restarts with stale chunk URLs). (~ src/index.tsx)

- 2026-01-06 / Unified matters stall diagnostics / Added server timing logs + response timeout for `/api/matters-unified` and client-side pending/timeout logging for the unified matters fetch. (~ server/routes/mattersUnified.js, ~ src/index.tsx)

- 2026-01-06 / Update Alex + Jonathan signatures / Set title to “Senior Partner” for JW + AC, and add an extra “Alex” line above “Alex Cook” in AC signature (+ v2 + txt/rtf variants)
 2026-01-06 / Rate change modal: sync open/close dates / Updated rate-change Clio→SQL sync endpoints to also persist matter Open Date + Close Date (so modal sorting/filtering isn't reliant on stale legacy SQL dates). (~ server/routes/rate-changes.js, ~ src/tabs/home/RateChangeModal.tsx)
 2026-01-06 / Matter Opening: Workbench-structure + opponent entry / Replaced the bespoke ID verification tile block in PoidSelectionStep with IdentityConfirmationCard (Workbench-style layout incl. document-provided + meta row). Also allow entering opponent/solicitor details before confirming no-conflict (Continue remains disabled until confirmed). (~ src/tabs/instructions/MatterOpening/PoidSelectionStep.tsx, ~ src/tabs/instructions/MatterOpening/OpponentDetailsStep.tsx)
 2026-01-06 / Matter Opening: Client summary clarity / Reworked client personal details banner into structured Contact/Address/Personal tiles (no more raw “dump”); updated conflict context tiles so populated Matter/Opponent/Solicitor read as active/selected rather than faded. (~ src/tabs/instructions/MatterOpening/PoidSelectionStep.tsx, ~ src/tabs/instructions/MatterOpening/ConflictConfirmationCard.tsx)
 2026-01-06 / Matter Opening: Fix POID selection regression / Restored PoidSelectionStep selection-context logic after JSX was mistakenly inserted into a useMemo, breaking compilation. Structured Contact/Address/Personal tiles now render in the banner scope (where selectedPoid exists). (~ src/tabs/instructions/MatterOpening/PoidSelectionStep.tsx)
 2026-01-06 / Matter Opening: ID & Conflict confirmation cards / Created two new InlineWorkbench-style components for Matter Opening flow: IdentityConfirmationCard (rich ID verification display with status banners, tiles for ID/PEP/Address, confirmation toggle with override modal) and ConflictConfirmationCard (conflict check display with client/matter/opponent context tiles, checklist modal for Clio search confirmation). Replaced simple ModernMultiSelect conflict picker in OpponentDetailsStep with the enhanced ConflictConfirmationCard. Added clientDisplayName useMemo to FlatMatterOpening and passed clientName + matterDescription props through. (+ src/tabs/instructions/MatterOpening/IdentityConfirmationCard.tsx, + src/tabs/instructions/MatterOpening/ConflictConfirmationCard.tsx, + src/tabs/instructions/MatterOpening/components.ts, ~ src/tabs/instructions/MatterOpening/OpponentDetailsStep.tsx, ~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx)
 2026-01-06 / Inline workbench: Manual ID approval indicator / EID section now clearly distinguishes between automatic "Pass" and manual "Approved" status. When ID was manually approved despite underlying check issues (e.g. Address = Review), displays "ID Approved" banner with explanation, "Manually Approved" badge on EID header, and shows "Approved" in Overall tile while preserving original individual check results. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Global Toast System / Created centralised ToastProvider context with useToast hook for app-wide toast notifications. Supports success/error/warning/info/loading states with automatic dismissal, dark mode, and action buttons. Integrated into App.tsx and migrated InlineWorkbench + Instructions.tsx from local toast state to global system. (+ src/components/feedback/ToastProvider.tsx, ~ src/app/App.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/instructions/Instructions.tsx)
 2026-01-05 / Inline workbench / Approve and Request docs actions now open proper modals with clear prompts: Approve modal explains what confirmation means; Request docs modal shows email preview/template, explains fee earner drafts then sends, and notes that "Docs received" status is manual until systematic tracking is built. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Simplified ID layout: Individual clients show one card (details + address); Company clients show two side-by-side cards — Individual (details + address) | Company (details + registered address). Each card is self-contained. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Restructured company client ID view: added prominent "COMPANY CLIENT" banner with company name + number, header now shows individual name with "Director / Individual" label. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Removed redundant "View Details" action from the ID Verified banner now that EID details are inline/expanded by default. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Company client ID section now shows the individual/director details the EID check is run against (with a clear confirmation prompt when missing) instead of only company entity context. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Individual checked panel now wraps long values and shows postcode within the address line (no separate postcode field). (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / EID results now render as compact cards with status pills, and expanded details include a workflow state strip + recommended action guidance (restoring the best parts of the old review modal inline). (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Moved Business Details into the Company Address card so Personal sits side-by-side with Company Address+Business Details at the top. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Company Address card now shows Business Details above the address fields; Document Provided now uses a passport vs driving-licence selector button layout with the non-selected option disabled. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Added a Show raw record toggle in expanded EID details to view the stored raw verification payload inline (pretty-printed when JSON). (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Prevent delayed placeholder EID failure text like “Check failed or requires review (N/A)” from appearing after verification details load. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Fixed Company Address “No./Street” row alignment by matching grid columns to other address rows and trimming house number display. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Document Provided buttons are now taller with icons and embedded values (no extra detail panel below), and the Recommended action box has been removed (workflow chips retained). (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / EID meta rows: removed duplicate Corr reference, renamed “Tiller ID” to “Corr”, and left-aligned meta labels while keeping value column start fixed. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Clarified workflow chips to “EID status” (Pending / Needs review / Verified) and stopped using docsRequested/docsReceived so uploaded documents don’t incorrectly drive the state yet. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / ID verification now expands inline inside EID Results with per-check dates + fail breakdown; Request docs is internal-only (draft to fee earner), and duplicate summary lines removed. (+ src/tabs/instructions/InlineWorkbench.tsx, src/services/verificationAPI.ts)
2026-01-05 / Inline workbench / Combined ID Document + EID Results into a single full-width ID Verification box for clearer scanning. (+ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-05 / Inline workbench / EID expanded details now surface provider + reference IDs (when available), and the ID Verification header includes a status pill for clearer scanning. (+ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-05 / Inline workbench / EID details are expanded by default and checked dates are date-only (no 00:00). (+ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-05 / Inline workbench / Hide placeholder EID failure reasons (e.g. N/A) so “Fail” only appears when there’s a real issue. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-05 / Inline workbench / EID details now show provider correlation ID (Tiller ID) instead of repeating email, and Approve/Request docs require confirmation. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-05 / Inline workbench / EID tiles now use a simple status icon and no longer repeat per-tile checked dates (single checked date is enough). (~ src/tabs/instructions/InlineWorkbench.tsx)

- 2026-01-05 / Home demo-mode default / Demo mode no longer persists across reloads; clears stale localStorage so Home doesn't show demo data unless explicitly enabled. (~ src/app/App.tsx)

- 2026-01-05 / Instructions: ID review in tray / ID verification Review/View Details now opens the existing review UI inside the inline workbench tray (no legacy modal), preserving approve/request/draft actions. (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/components/modals/IDVerificationReviewModal.tsx)

- 2026-01-05 / InlineWorkbench identity cards: data-per-source + Teams fallback / Redesigned avatar section to show key data fields per source (SQL: name/email/phone; AC: contact ID + status; Teams: tracking/enquiry ID + status). Added ProspectId fallback for Teams link resolution so instructions linked to enquiries can resolve Teams cards even without direct tracking IDs. All three tiles now always visible with reduced opacity when not linked. (~ src/tabs/instructions/InlineWorkbench.tsx)

- 2026-01-05 / Reporting LogMonitor production fix / Fixed SSE log streaming reliability by making CORS origin checks request-aware (allow same-origin behind proxies) and flushing SSE headers/writes for /api/logs/stream. (~ server/index.js, ~ server/routes/logs-stream.js)

- 2026-01-05 / Reports visual refresh / Aligned Reporting surfaces with the newer Helix dark styling: horizontal gradients + brand borders on overview + cards, theme-aware report card text, and removed off-brand sky-blue accents in the shared glass container. (~ src/tabs/Reporting/ReportingHome.tsx, ~ src/tabs/Reporting/ReportCard.tsx, ~ src/tabs/Reporting/components/ReportingSectionCard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)

- 2026-01-05 / Instructions workbench: AC badge opens wrong contact / Centralised ActiveCampaign contact ID resolution and fixed precedence to prefer instruction-level ACID/acid over deal-level ProspectId when both exist. Added Jest coverage for the resolver. (+ src/utils/resolveActiveCampaignContactId.ts, + src/utils/__tests__/resolveActiveCampaignContactId.test.ts, ~ src/tabs/instructions/InlineWorkbench.tsx)

- 2026-01-05 / Tech tickets: problem submit 400 + ledger dark mode / Fixed Tech Problem form payload to match /api/tech-tickets/problem contract (system/summary/expectedVsActual/urgency) and corrected Tech Tickets ledger row text colour in dark mode. (~ src/CustomForms/TechProblemForm.tsx, ~ src/CustomForms/shared/TechTicketsLedger.tsx)

- 2026-01-05 / Test stability: Jest open handle / Unref'd the delayed SQL health-check startup timer so it doesn't keep Node/Jest alive after tests complete. (~ server/utils/db.js)

- 2026-01-04 / Session-start: submodule check messaging / Clarified session-start output to explicitly state submodule checks are read-only. (~ scripts/session-start.mjs)

- 2026-01-04 / Instructions tab backtrack links: AC & Teams origin / Added subtle origin indicators on the avatar (AC + T). AC deep-links to the ActiveCampaign contact; Teams resolves a deep link to the original Teams card via /api/teams-activity-tracking when an enquiryId/record id is available, with safe fallback to Teams web. Positioned as small overlay badges to cue provenance without clutter. (~ src/tabs/instructions/InlineWorkbench.tsx)

- 2026-01-04 / Instructions tab redesign: comprehensive client overview / Transformed identity tab into full "Instructions" client workspace. Added prominent header with person/company avatar, primary name/company name & number, and quick contact details (email/phone/ref). Below: key details grid (DOB, Nationality, City, Postcode), full address card with copy, then ID verification section (passport/license only, removed false "national ID"), EID results, and business details. Space now shows complete instruction/client picture—not just ID verification, but full checkpoint for all client details and verification status. (~ src/tabs/instructions/InlineWorkbench.tsx)

- 2026-01-04 / Workbench visual clarity: ID documents & payments / Enhanced ID document section to visually show which document was used (passport/license/national ID) with green highlight and indicator dot, grayed-out alternatives, and properly formatted date of birth (no timestamp). Similarly added payment method selector showing card vs bank transfer with visual status indicators. Space now speaks for itself—clearly shows situation, position, and alternatives. (~ src/tabs/instructions/InlineWorkbench.tsx)

- 2026-01-04 / Inline workbench per instruction row / Moved workbench from page-level global component to inline expansion within each instruction row. Created InlineWorkbench.tsx component with tabbed sections (ID, PAY, DOCS, RISK, MATTER). Click row to toggle workbench. Includes header with instruction ref, notes/description, and all pipeline action buttons. Removed page-level workbench visibility triggers from onRowClick. (+ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/instructions/InstructionTableView.tsx, ~ src/tabs/instructions/Instructions.tsx)

- 2026-01-04 / Instructions table ref selector not opening / Replaced inline absolute dropdown with Fluent UI Callout anchored to the reference chip (avoids overflow clipping) and keyed view-mode state by a stable selector key (email/ref fallback). (~ src/tabs/instructions/InstructionTableView.tsx)

- 2026-01-04 / Instructions table ref cue + linking / Added an explicit multi-ref count badge and a stacked secondary ref line to visually link matter + instruction in the same chip area (and removed debug console spam). (~ src/tabs/instructions/InstructionTableView.tsx)

- 2026-01-04 / Instructions table chip compactness / Reverted ref chip to single-line height; replaced badge with subtle dot cue; show matter↔instruction linkage only inside the open selector. (~ src/tabs/instructions/InstructionTableView.tsx)

- 2026-01-04 / Instructions table chip overlap / Constrained ref chip to its fixed-width cell (clip overflow) so it doesn't overlap the pipeline connector line. (~ src/tabs/instructions/InstructionTableView.tsx)

- 2026-01-02 / Workbench UI consistency redesign / Redesigned Matter Opening Workbench (ID/PAY/DOCS/RISK/MATTER tabs) for better consistency with app design patterns. Simplified header styling, removed complex gradients/shadows, aligned tab design with app conventions, improved color consistency using established theme system. Cleaner visual hierarchy, consistent spacing, and reduced visual noise while maintaining full functionality. (~ src/tabs/instructions/Instructions.tsx)

- 2026-01-02 / Enquiries ID column shows instruction reference / Added instruction reference display beneath enquiry ID when a pitch/deal exists with an InstructionRef. Matches Instructions table pattern (ID + Reference stacked). Updated backend SQL to include InstructionRef, added field to pitchEntry object and TypeScript interface. (~ server/routes/enquiryEnrichment.js, src/app/functionality/enquiryEnrichment.ts, src/tabs/enquiries/Enquiries.tsx)

- 2026-01-02 / Pitch builder caret jumps to start while typing / Fixed body sync effect to treat focus within editor children (e.g. placeholder spans) as focused, preventing innerHTML rewrites during typing. (~ src/tabs/enquiries/PitchBuilder.tsx)
- 2026-01-06 / Financial forms failing with attachments / Increased Express JSON body limit (base64 uploads) and fixed Payment Requests >£50k field key mismatch. (~ server/index.js, server/routes/financialTask.js)
- 2026-01-06 / Financial forms traceability / Added structured trace logs for /api/financial-task and a JSON error middleware (incl. payload-too-large) for clearer Azure Log Stream debugging. (~ server/index.js, server/routes/financialTask.js)
- 2026-01-06 / Edge Tools hygiene: signatures + nested interactive + CSS prefixes / Added rel="noopener noreferrer" to signature links (bulk script + sendEmail safety-net), removed button-like role/tabIndex from InstructionCard wrapper to avoid nested interactive controls, and reordered -webkit CSS properties before unprefixed equivalents. (+ scripts/fix-signature-noopener.mjs, ~ src/assets/signatures/**, ~ server/routes/sendEmail.js, ~ src/tabs/instructions/InstructionCard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)

- 2026-01-01 / Annual leave UX polish & space booking system / Enhanced annual leave delete modal contrast for dark mode (pure white text). Fully tested half-day leave functionality via terminal with database schema updates (half_day_start/half_day_end columns). **Major**: Space booking system fully operational - fixed bookSpace.js imports, added attendanceQuery pattern, tested Boardroom/Soundproof Pod bookings with Clio integration. Added DELETE endpoint + UI delete functionality with confirmation dialogs. Cleaned availability UI to only show dates with bookings. Added booking refresh after creation. (~ src/CustomForms/AnnualLeaveForm.tsx, BookSpaceForm.tsx, server/routes/bookSpace.js, server/server.js, src/tabs/home/Home.tsx, + scripts/createBookingTables.mjs, deleteTestBookings.mjs)

- 2026-01-01 / Instructions day folding not applying / Fixed local/static server to prefer serving latest CRA output from build/ so UI code changes (e.g., day folding/hover) show up after rebuild. (~ server/index.js, server/server.js)

- 2025-12-31 / Pitch builder production refinements / Cleaned up pitch builder for production: standardized terminology (Scope of Work, Quote Amount), simplified labels (removed colons, reduced verbosity), cleaner VAT toggle ("No VAT (international)"), improved error display, consolidated confirmation messages. Enhanced UI with refined borders (8px radius), softer shadows, smoother transitions (cubic-bezier), subtle focus glows, better card hover states. Professional polish throughout. (~ src/tabs/enquiries/pitch-builder/DealCapture.tsx, PaymentPreview.tsx, EditorAndTemplateBlocks.tsx)

- 2025-12-30 / Migrate decoupled-functions to Express / Ported 5 functions to direct SQL in Express routes (matterRequests, opponents, ccl, pitches). Deleted ALL remaining decoupled function folders (15 total). decoupled-functions/ now empty except scaffolding. No more dependency on instructions-vnet-functions Azure Function App. (~ server/routes/matterRequests.js, server/routes/opponents.js, server/routes/ccl.js, server/routes/pitches.js, - decoupled-functions/*/)

- 2025-12-30 / Dead code removal: decoupled-functions / Deleted 8 unused Azure Functions: fetchEnquiryEmails, fetchEnquiriesData, recordRiskAssessment, dealCapture, importInstructionData, deleteTestMatters, insertEnquiry, sendEmail. Also removed dead routes: enquiries.js, enquiryEmails.js, EnquiryEmails.tsx. (- decoupled-functions/*, server/routes/enquiries.js, server/routes/enquiryEmails.js, src/tabs/enquiries/EnquiryEmails.tsx)

- 2025-12-30 / Foundation cleanup / Archived one-off scripts, fixed stale file references in instruction docs, added doc maintenance rule to copilot-instructions. (+ scripts/archive/, .github/copilot-instructions.md, .github/instructions/*.md)

- 2025-12-30 / Agent infrastructure / Built context sync system for autonomous agents. Scripts auto-generate REALTIME_CONTEXT.md with branch state, submodule status, server ports. Session start protocol established. (+ scripts/sync-context.mjs, scripts/update-submodules.mjs, scripts/validate-instructions.mjs, scripts/session-start.mjs, .github/instructions/REALTIME_CONTEXT.md, .github/copilot-instructions.md)

- 2025-12-30 / 2025 Rate Update / Updated all fee earner rates in both databases (helix-core-data, instructions). Alex Cook + Jonathan Waters → Senior Partner £475. All roles updated to new structure. (+ scripts/updateRates2025.mjs, scripts/updateRatesInstructions.mjs, database/migrations/010_2025_rate_update.md, .github/instructions/TEAM_DATA_REFERENCE.md)

- 2025-12-30 / Instruction files foundation / Added TEAM_DATA_REFERENCE.md, WORKSPACE_OPTIMIZATION.md. Updated copilot-instructions.md to match typefxce foundation pattern. (+ .github/instructions/*, .github/copilot-instructions.md)

- 2026-01-08 / Conversion metrics reloading / Stabilised conversion metric cards by removing refresh-based remounting and using a short refresh pulse animation (src/components/modern/EnquiryMetricsV2.tsx)

- 2026-01-08 / Conversion metrics breakdown inspect / Home now stores `/api/home-enquiries` `breakdown` payload and passes it into Conversion Metrics; enquiry cards show a subtle inspect cue and open a BespokePanel modal with top AOW segments (today/week/month). (~ server/routes/home-enquiries.js, ~ src/tabs/home/Home.tsx, ~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
