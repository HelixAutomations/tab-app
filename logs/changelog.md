2026-01-18 / Timeline pitch fallback from enrichment / When no pitches found by enquiry ID, fall back to email-based enrichment data so deals show in workbench. (~ src/tabs/enquiries/EnquiryTimeline.tsx, ~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries payment chip shows pending color / Payment chip now shows orange/blue for pending payments instead of neutral grey. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries eager enrichment prefetch / Fire parallel micro-batches on initial load so hover data is ready before user even scrolls. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries enrichment prioritise speed / Increase batch size, remove debounce, and prefetch farther ahead for faster pipeline updates. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries pipeline pulse unified / Use a single smooth pulse animation for pitch/ID cue dots to keep timing consistent. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries payment icon uses GBP / Replace money stack icon with CurrencyPound in payment pipeline stages to keep the cue visible. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries pipeline hover cleanup / Auto-hide stuck pipeline hover tooltip on mouse move off chips, scroll, or window blur. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries pipeline placeholder shows instruction / Align loading placeholder pipeline icons with actual stages so Inst appears while processing. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Enquiries pipeline uses ACID for workbench / Resolve inline workbench lookup by ACID/prospect ID so enquiry pipeline reflects instruction-linked stages. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-18 / Prospect overview selection prefers instruction / Resolve selected overview item by InstructionRef/DealId/ProspectId to align deal clicks with instruction-linked workbench data. (~ src/tabs/instructions/Instructions.tsx)
2026-01-17 / Tech tickets Asana auth + ledger refresh / Use Key Vault + team table Asana credentials for tech tickets and redesign the ledger rows with clearer status chips, readable text, and edit/delete actions. (~ server/routes/techTickets.js, ~ src/CustomForms/shared/TechTicketsLedger.tsx)
2026-01-17 / Tech tickets Asana fixes / Remove workspace ID from task creation and store submitter initials to avoid SQL truncation. (~ server/routes/techTickets.js)
2026-01-17 / Annual leave day selection date compare / Use date-only comparisons for selectable days to prevent time-of-day blocking and zero-day counts. (~ src/CustomForms/AnnualLeaveModal.tsx)
2026-01-17 / Annual leave modal fallback fetch / Modal now self-fetches leave data when Home props are empty to avoid blank history. (~ src/CustomForms/AnnualLeaveModal.tsx)
2026-01-17 / Annual leave timestamps / Added request/approval/booking timestamps with schema migration and history display. (~ server/routes/attendance.js, ~ database/migrations/013_annual_leave_timestamps.sql, ~ src/CustomForms/AnnualLeaveModal.tsx, ~ src/tabs/home/Home.tsx, ~ src/app/functionality/types.ts)
2026-01-17 / Annual leave bulk update / Added multi-select and bulk status/days updates for leave history in the modal. (~ src/CustomForms/AnnualLeaveModal.tsx)
2026-01-17 / Annual leave modal loading skeletons / Show loading skeletons and guard empty states while annual leave data loads. (~ src/CustomForms/AnnualLeaveModal.tsx, ~ src/tabs/home/Home.tsx)
2026-01-17 / Annual leave modal edit refresh / Admin edits now refresh viewed employee data without closing the modal. (~ src/CustomForms/AnnualLeaveModal.tsx)
2026-01-17 / Annual leave modal scroll + ledger cleanup / Removed nested scrollbars and simplified the leave history header controls. (~ src/CustomForms/AnnualLeaveModal.tsx)
2026-01-17 / Annual leave Outlook calendar sync / Create Outlook calendar entries when leave is booked, store event id, and delete on record removal. (~ server/routes/attendance.js, ~ database/migrations/012_annual_leave_outlook_entry_id.sql)
2026-01-17 / Annual leave modal next-year stats swap / Stats card now swaps to a distinct next-fiscal-year layout with clear signposting when the selection is entirely next year. (~ src/CustomForms/AnnualLeaveModal.tsx)
2026-01-17 / Enquiries pipeline hover positioning / Tooltip shows below chip without jolt (removed scaling, animation, centering). (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Enquiries rating chip + modal descriptions / Rating action chip now reflects Good/Neutral/Poor visuals and the rate modal shows full descriptive text. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Enquiries actions column / Moved call/email/rate into the right actions column (no hover overlay) and show edit/delete only when Actions is enabled. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Enquiries table phone hidden / Removed phone display from child enquiry rows to keep pipeline columns aligned. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Grouped prospect count badge / Moved enquiry count into the chevron badge for grouped prospects (no extra chip). (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Clear filters resets search / Clearing all filters now resets the debounced search term so results return immediately. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Grouped prospects clarity / Grouped prospect banner and child rows now label enquiries explicitly (count chip, Prospect label, and per-enquiry index) to avoid confusion. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-16 / Timeline chip cleanup / Inline workbench in enquiry timeline now hides Enquiry/Pitch chips and shows Instructed as green when stage is initialised (without tick). (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Passcode link copy fallback / Clipboard copy now falls back to execCommand when Clipboard API is blocked (Teams/webview), fixing “copy link” after generation. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-15 / Enquiry default tab honours pitch enrichment / Selecting an enquiry now opens Timeline when pitch data or pitch ID is present, avoiding Pitch Builder for already-pitched enquiries. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-15 / Timeline deals unified / Timeline now treats all pitch records as deals and signposts whether each was created via pitch email or link enablement. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Timeline deal content signposting / Link-enabled deals now show a clear “no email content” callout and hide the forward-email action. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Timeline doc-request pitch styling / Doc request (workspace) entries now render with a pitch-style icon/chip and distinct colour to match deal items. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Timeline loading skeletons / Added shimmer skeletons for processing sources and initial timeline load to match Home page loading states. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Timeline cache revalidation / Session cache now revalidates in the background so newly generated deals appear without hard refresh. (~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Link-only deal rendering / Manual link deals now show a checkout link block (no email content) in the timeline. (~ src/tabs/enquiries/EnquiryTimeline.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx)
2026-01-15 / Link-only deal flagging / Manual link generation now flags Status=CHECKOUT_LINK (and DealKind if available). (~ src/tabs/enquiries/PitchBuilder.tsx, ~ server/routes/dealCapture.js, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Pitch Builder draft restore guard + timeline cache bust / Draft values (including service description) only restore when resume is enabled; pitches fetch now busts cache so newly captured deals appear immediately. (~ src/tabs/enquiries/PitchBuilder.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Deal capture de-dupe removed / Removed recent-duplicate detection so every capture creates a new deal/passcode and timeline entry. (~ server/routes/dealCapture.js)
2026-01-15 / Pitch Builder link activation lock / Added activation mode (pitch vs manual) and lockout for scenario/editor when manual activation is selected; updated manual activation helper copy and required field markers. (~ src/tabs/enquiries/components/ProspectHeader.tsx, ~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx, ~ src/tabs/enquiries/pitch-builder/EditorAndTemplateBlocks.tsx)
2026-01-15 / Pitch Builder notes + prompt layout / Moved enquiry notes into the ProspectHeader as a full-width second row and redesigned the pre-scenario pitch-context prompt as an InlineWorkbench-style banner. (~ src/tabs/enquiries/components/ProspectHeader.tsx, ~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx)
2026-01-15 / Deal details input focus hardening / Switched the Deal details Service description + Amount fields to uncontrolled refs with safe prop sync, preventing focus loss while typing under re-render pressure. (~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-15 / Enable Link input fix + Link Enabled timeline event / Fixed service description input losing focus on each keystroke (was caused by parent state update triggering component re-render). Added 'link-enabled' as a distinct timeline event type for deals captured without sending a pitch email - shows with purple link icon and "Link Enabled" label in both card and ledger views. (~ src/tabs/enquiries/components/ProspectHeader.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Pitch Builder flattened + Timeline ledger mode / Removed card-based context panel from Pitch Builder header - replaced with minimal inline hints (unconverted pitch warning, notes toggle) so scenario selection appears immediately after the prospect header. Added toggleable "ledger mode" to Enquiry Timeline that renders a clean Clio-style table instead of nested cards with animations. Toggle persists in localStorage. (~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-15 / Pitch Builder layout flattening / Reduced pre-scenario clutter by collapsing pitch context + notes into a single compact panel, and moved extracted-section option blocks below the main composer so scenario selection appears sooner. (~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx)
2026-01-15 / Prospect contact actions / Standardised contact display under the client name (email + phone inline with subtle separator, tap-to-email/call and one-click copy) in InlineWorkbench. In Pitch Builder Prospect & Enquiry header, keep contact on the right under the “Contact” subheading with the same actions/copy. (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/components/ProspectHeader.tsx)
2026-01-15 / Pitch Builder passcode link gating / Passcode now displays as an instruction link that stays masked/uncopyable until the user confirms Amount + Service Description and triggers Deal capture (same flow as after pitching). (~ src/tabs/enquiries/components/ProspectHeader.tsx, ~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx)
2026-01-15 / Pitch history context + Timeline endpoint fix / Pitch Builder header banner now warns when there are previous unconverted pitches (no “saved draft” wording). Enquiry Timeline no longer calls missing `/api/instruction-data` and instead derives lightweight pitch status directly from `/api/pitches`. (~ src/tabs/enquiries/pitch-builder/VerificationSummary.tsx, ~ src/tabs/enquiries/PitchBuilder.tsx, ~ src/tabs/enquiries/EnquiryTimeline.tsx)
2026-01-12 / Prospects: pipeline column icon-only / Pipeline header now shows labels only; pipeline cells render icon-only states (neutral when absent, coloured when present) and the claim prompt chip supports icon-only mode in the grid. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-12 / Payments: deal capture DB connection-string parsing fix / Support Data Source/Database variants (not just Server/Initial Catalog) so production doesn’t silently connect to the wrong DB and fail with “Invalid object name 'Deals'”. Mark missing-Deals-table as recoverable to avoid hard-failing email flows. (~ server/routes/dealCapture.js)
2026-01-12 / Console noise + missing endpoints fixes / Initialise Fluent UI icons before first render (stops “icon not registered” warnings); fix doc-workspace pending-actions URL to avoid `/api/api` double prefix; mount CallRail route in prod entrypoint; downgrade doc-workspace blob auth failures to 200 empty payload to avoid 500 spam. (~ src/index.tsx, ~ src/tabs/home/Home.tsx, ~ server/server.js, ~ server/routes/doc-workspace.js)
2026-01-11 / Enquiries: pipeline header alignment polish / Reserve a fixed gutter column (used for Clear Filters) across pipeline header + rows so headings stay perfectly aligned with chips even when the clear button appears. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: pipeline header de-dup / Remove the separate pipeline headings row; the filter row now serves as the header so labels aren’t duplicated. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: pipeline filter chip consistency / Standardise tri-state filter indicators: ✓ for Has, ✕ for No (removes mixed dot/tick behaviour). (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: POC filter chip consistency / Replace the POC filter active dot with the same ✓ indicator used for other active filters. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: Claimed tab claim filter cleanup / Hide redundant Claim tri-state stage filter in Claimed tab (claim is guaranteed); keep the person/POC filter only; ignore any persisted claimed-stage filter while in Claimed. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: prefetch instruction data / Allow instruction data fetch when Prospects tab is active (for InlineWorkbench expansion), gated to users with Clients access; fixes “only notes” expansions unless Clients tab visited first. (~ src/app/App.tsx)
2026-01-11 / Enquiries: stacked date/time/ago / Enquiries table date column now renders as 3-line stack (weekday, date + optional time, and “x days ago”) with full timestamp preserved in tooltip. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: pipeline + table readability / Removed Value column and stacked Value under ID to free space for Pipeline; added post-pitch stages; improved date cell readability. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Enquiries: fixed pipeline columns / Converted the pipeline header + row indicators into a fixed 8-column grid (Teams, Claim, Pitch, Inst, ID, £, Risk, Matter) so headings align and the table doesn’t shift. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-11 / Prospects: context chips not faded / When `enableContextStageChips` is enabled, Enquiry/Pitch/Instructed chips use the same status palette as the main workbench tabs (no greyed/faded styling) and connector lines reflect prior stage status. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-11 / Prospects: context chips show data / Clicking Enquiry now opens a lightweight context panel in the workbench Details view; Pitch uses a full-width Details-layout card showing pitch fields (amount/service/passcode etc); Instructed focuses the standard Details landing view. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-11 / Prospects: enable pipeline context chips / InlineWorkbench now allows Enquiry/Pitch/Instructed chips to be clickable when rendered in Prospects (Enquiry navigates back to Prospects; Pitch/Instructed focus Details). (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/enquiries/*)
2026-01-11 / Enquiries cards: InlineWorkbench expansion / Card view expansions now show InlineWorkbench (claimed/unclaimed/grouped) and linkage is more resilient (wrapper prospectId + deal-only records). (~ src/tabs/enquiries/Enquiries.tsx, ~ src/tabs/enquiries/ClaimedEnquiryCard.tsx, ~ src/tabs/enquiries/NewUnclaimedEnquiryCard.tsx, ~ src/tabs/enquiries/GroupedEnquiryCard.tsx, ~ src/tabs/enquiries/EnquiryLineItem.tsx, ~ src/tabs/enquiries/UnclaimedEnquiries.tsx)
2026-01-11 / Prospects: InlineWorkbench duplication / Show the existing Instructions InlineWorkbench under expanded Prospects (enquiries) table rows when linked instruction data exists; rows are expandable even when there are no notes. (~ src/tabs/enquiries/Enquiries.tsx)
2026-01-12 / Demo mode: instructions table demo row / When demo mode is enabled (UserBubble), Clients/Instructions table prepends a synthetic demo client/instruction row for screenshots and walkthroughs. (+ src/app/App.tsx, + src/tabs/instructions/Instructions.tsx)
2026-01-12 / Payments: deal capture SQL hardening + Redis log spam throttle / Schema-qualify Deals-related tables (dbo.*) to avoid default-schema issues and include dbName in failure logs; add cooldown + rate-limited logging for noisy Redis socket-close errors. (~ server/routes/dealCapture.js, ~ server/utils/redisClient.js)
2026-01-12 / ID verification: start verification modal clarity / Replaced notification controls with a clear summary of what checks run and confirmation that no client email is sent from Helix Hub; avoids leaving the user in the dark after clicking Start Verification. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-12 / Demo mode: ID verification simulation / Demo instruction now simulates EID processing → completion and updates the same pipeline/workbench UI states without performing any provider calls. (~ src/tabs/instructions/Instructions.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-10 / Reporting: WIP current week DB fallback / Fixed Management Dashboard not showing current week WIP when Clio unavailable. When wipClioCurrentWeek fails (401/token issues), stream now properly signals error status (instead of empty data) so frontend merge logic falls back to wipDbCurrentWeek dataset. Also added user credential fallback (lz/jw/ac) to reporting.js when clio-pbi token unavailable. (~ server/routes/reporting-stream.js, ~ server/routes/reporting.js)
2026-01-08 / ReportingHome + ManagementDashboard UX polish / Applied InlineWorkbench design patterns across reporting screens: added shimmer/pulse/slideIn/scaleIn animations, uppercase 9px section labels with letter-spacing, processing modal overlay that shows during data refresh, wired isFetching state to processing modal display, borderRadius: 0 throughout, fadeInUp entrance animations for sections, skeleton shimmer utility class in CSS. Dashboard now shows lightweight processing modal during refresh operations with spinner and progress bar. (~ src/tabs/Reporting/ReportingHome.tsx, ~ src/tabs/Reporting/ManagementDashboard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)
2026-01-09 / Reporting: totals explainer + disbursements toggle / Added a Disbursements include/exclude toggle (affects current + previous period Collected) and a bottom click-to-explain callout quantifying KPI vs table total deltas and explaining scope differences (all data vs visible members). (~ src/tabs/Reporting/ManagementDashboard.tsx)
2026-01-09 / Senior Partner role support / Treat “Senior Partner” as partner-class in reporting role filters and matter opening supervising partner selection; add Senior Partner role option where roles are selectable and ensure Partner selection still includes Senior Partner members. (~ src/tabs/Reporting/ManagementDashboard.tsx, ~ src/tabs/Reporting/MattersReport.tsx, ~ src/tabs/Reporting/EnquiriesReport.tsx, ~ src/tabs/Reporting/AnnualLeaveReport.tsx, ~ src/tabs/instructions/NewMatters.tsx, ~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx, ~ src/tabs/instructions/DocumentEditorPage.tsx, ~ src/tabs/home/WeeklyAttendanceView.tsx)
2026-01-07 / Home time metrics load delay / Fixed ~5–10s delay in metrics appearing on Home load. Root cause: parallel fetch effect triggered 3x due to unstable deps (email/initials derived from userData), first 2 runs discarded as stale. LZ/Luke/localhost users had no Clio ID → home-wip returned zeros → triggered slow reporting fallback. Solution: removed email/initials from effect deps (derived from userData anyway), added Alex fallback logic to parallel fetch (matches handleRefreshTimeMetrics pattern), only trigger reporting fallback when truly needed (data exists but all zeros). Metrics now land immediately using lightweight endpoint, no unnecessary fallback. (~ src/tabs/home/Home.tsx)
2026-01-07 / To Do skeleton load / To Do now starts with skeleton chips and only shows the empty "All caught up" state after actions settle, avoiding the green empty-state flash before cards appear. (~ src/tabs/home/ImmediateActionsBar.tsx, ~ src/tabs/home/Home.tsx)
2026-01-07 / Annual leave approval To Do chip subtitle / Fix annual leave parallel-fetch mapping to preserve `person`/leave fields so “Approve Annual Leave” shows initials/names again. (~ src/tabs/home/Home.tsx)
2026-01-08 / Annual leave local+demo parity / In local data mode, derive annual leave approvers from team `AOW` (production routing). In demo mode, show a single “Approve Annual Leave (Demo)” To Do card instead of live approvals. (~ src/tabs/home/Home.tsx)
2026-01-11 / Annual leave approvals: construction routing fix / Stop treating AC as a broad-visibility approver; approvals now follow per-request `approvers` so construction requests show for JW + LZ only, and non-construction for AC + LZ. Also harden construction detection (AOW contains 'construction' or 'cs') in local-mode derivation and backend determineApprovers. (~ src/tabs/home/Home.tsx, ~ api/src/functions/getAnnualLeave.ts)
2026-01-11 / Demo mode: annual leave test cards / Remove the separate “Annual Leave Test Cards” feature toggle and make annual leave demo/test To Do cards controlled solely by the Demo Mode toggle. (~ src/components/UserBubble.tsx, ~ src/tabs/home/Home.tsx)
2026-01-08 / Attendance confirm modal crash / Repair TSX corruption in attendance confirm components and harden Week_Start normalisation + null-safe guards to prevent ErrorBoundary crash on open. (~ src/tabs/home/AttendanceConfirmPanel.tsx, ~ src/tabs/home/PersonalAttendanceConfirm.tsx)
2026-01-08 / Demo mode To Dos / Demo mode now forces demo To Do cards (Approve Annual Leave + Book Requested Leave + Confirm Attendance) and avoids writing live attendance during demos. Demo mode persists as a user-bubble toggle via localStorage. (~ src/app/App.tsx, ~ src/components/UserBubble.tsx, ~ src/tabs/home/Home.tsx, ~ src/tabs/home/PersonalAttendanceConfirm.tsx)
2026-01-08 / Metrics previous-period toggle + header status chip / Add a Current/Previous toggle in the Time Metrics header (applies to both Time + Conversion cards). Make the “Syncing Clio…” badge morph into an “Updated” badge in the same spot after refresh completes; label deltas as “vs previous” and prevent the initial count-up animation from re-running when viewing previous. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-01-08 / Clarify “Previous” meaning / For “Time Today”, Previous now means same weekday last week, with an explicit secondary “Yesterday” line when available. Week-to-date comparisons align to last week-to-date. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/tabs/home/Home.tsx)
2026-01-08 / Home metrics delta tooltips / Remove modal/sidepane explainer and card-click breakdowns. Add subtle hover info bubbles next to delta indicators (Current view only), hide deltas when viewing Previous, and rename card titles in Previous view for clarity. (~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-01-08 / Home metrics details modal / Make Time + Conversion metric cards subtly clickable and open a Workbench-style modal explaining what each metric includes (period, comparator, optional AOW breakdown). (+ src/components/modern/MetricDetailsModal.tsx, ~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
2026-01-07 / Fix financial forms / Registered `/api/financial-task` on legacy server entrypoint (+ server/server.js)
2026-01-07 / Home time metrics dropping to 0 / Don't abort fetch controller on effect cleanup (was killing requests in React Strict Mode before they completed); treat `/api/home-wip` `{ error }` as failure; extend stale cache TTL; retry once on Clio 401 after clearing token cache (+ src/tabs/home/Home.tsx, server/routes/home-wip.js)
# Changelog
 2026-01-06 / Rate change modal: bulk pressure test outstanding matters / Added `scripts/bulkPressureTestRateChangeOutstanding.mjs` to bulk sync outstanding (pending) matters via `/api/rate-changes/sync-matters`. Hardened the bulk sync endpoint with 429 backoff + light throttling to avoid Clio rate limits. (~ server/routes/rate-changes.js, + scripts/bulkPressureTestRateChangeOutstanding.mjs)

- 2026-01-11 / Annual leave booking modal / Shifted non-status UI accents from orange to neutral highlight blue; status chip now carries state colour (pending=orange, ready=green).
- 2026-01-11 / Annual leave request modal / Refresh annual leave data immediately after approvals/edits; normalise `all_data` and clear bespoke panel content on close so reopening shows updated history without app refresh. (~ src/tabs/home/Home.tsx)
- 2026-01-11 / Annual leave real-time hardening / Force-refresh annual leave reads immediately after approve/edit flows and add stronger server-side cache invalidation (delete daily key + namespace) so processed items can't reappear from stale cached data. (~ src/tabs/home/Home.tsx, ~ server/routes/attendance.js)
- 2026-01-11 / Annual leave realtime (cross-user) / Add SSE stream for annual leave changes; broadcast on create/update/admin-update/delete; Home subscribes and force-refreshes so approvals animate/update for other users without refresh. (+ server/utils/annual-leave-stream.js, ~ server/routes/attendance.js, ~ src/tabs/home/Home.tsx)
- 2026-01-11 / Attendance realtime (cross-user) / Add SSE stream for attendance confirmations; broadcast on updateAttendance; support `forceRefresh=true` on getAttendance; Home subscribes and refreshes so team attendance updates for everyone without manual reload. (+ server/utils/attendance-stream.js, ~ server/routes/attendance.js, ~ server/index.js, ~ src/tabs/home/Home.tsx)
- 2026-01-11 / Future bookings realtime (cross-user) / Add SSE stream for future bookings changes; broadcast on booking create/delete; support `forceRefresh=true` on future bookings reads; Home subscribes and refreshes so bookings update across users without refresh. (+ server/utils/future-bookings-stream.js, ~ server/routes/futureBookings.js, ~ server/routes/bookSpace.js, ~ server/index.js, ~ src/tabs/home/Home.tsx)
- 2026-01-11 / Attendance edit UX / Stop per-click attendance updates in edit mode (stage locally; save once) and switch day/week edit popovers to Fluent UI Callout so menus stay on-screen. (~ src/tabs/home/WeeklyAttendanceView.tsx)
- 2026-01-11 / Roadmap: client matters transition / Added an explicit roadmap item for moving the Instructions/Clients workspace into the Enquiries/Prospect space and renaming to Client Matters (retiring the separate Matters tab). (~ .github/instructions/ROADMAP.md)
 2026-01-06 / Rate change modal: hide new-rate matters / Exclude matters opened in the rate-change year from the main notification list (opened on/after 1 Jan 2026), while keeping them available under the Migrate tab via a separate dataset fetch. (~ server/routes/rate-changes.js, ~ src/tabs/home/useRateChangeData.ts, ~ src/tabs/home/Home.tsx, ~ src/tabs/home/RateChangeModal.tsx)
- 2026-01-06 / Enquiries realtime stream / Added SSE stream at `/api/enquiries-unified/stream`, broadcast on update/create/delete/cleanup and claim; Enquiries tab subscribes when active with debounced refresh; throttled server cache flush in refreshEnquiries. (server/utils/enquiries-stream.js, server/routes/enquiries-unified.js, server/routes/claimEnquiry.js, server/index.js, src/tabs/enquiries/Enquiries.tsx, src/index.tsx, src/setupProxy.js)

- 2026-01-06 / Enquiries stream debugging logs / Added reason-tagged console logs for team-wide fetch triggers + SSE lifecycle/events to quickly diagnose repeated `/api/enquiries-unified` calls without logging PII. (~ src/tabs/enquiries/Enquiries.tsx)

- 2026-01-07 / Enquiries realtime claim patch / SSE claim events now include `claimedAt`, and the Enquiries UI applies an immediate local patch (POC + optional claim time) so claimed/unclaimed filters and counts update instantly; keeps a slower backstop refresh to reconcile. (~ server/routes/claimEnquiry.js, ~ src/tabs/enquiries/Enquiries.tsx)

- 2026-01-07 / Enquiries realtime external claims / While SSE clients are connected, Hub now polls `TeamsBotActivityTracking.UpdatedAt` and broadcasts claim/unclaim changes as SSE events, so the Enquiries UI responds in realtime even when claims originate outside Hub routes (e.g. platform/Teams bot). (~ server/utils/enquiries-stream.js, ~ src/tabs/enquiries/Enquiries.tsx)

- 2026-01-07 / Enquiries realtime watcher hardening / Deduped external-claim broadcasts per enquiryId and switched the polling watermark compare to `UpdatedAt >= since` to avoid edge-case misses; increased batch size. (~ server/utils/enquiries-stream.js)

- 2026-01-07 / Local dev startup stabilisation / Auto-resets corrupted Azurite state on boot; avoids `/api/matters-unified` cold-start stalls in local dev; treats doc-workspace blob auth failures as empty results. (~ scripts/startAzurite.mjs, ~ package.json, ~ src/index.tsx, ~ server/routes/doc-workspace.js)

- 2026-01-07 / Home metrics stability / Avoid deprecated `/api/getAllMatters` 410s in local dev and harden WIP metrics fetch against abort/race (dedupe, cancel, retry once). Also cleaned up a few new lint warnings introduced during the change. (~ src/index.tsx, ~ src/tabs/home/Home.tsx)

- 2026-01-07 / Dead code cleanup (round 1) / Removed a handful of clearly-unused imports/consts flagged by ESLint (safe, no behaviour changes). Added roadmap item for broader cleanup. (~ src/tabs/home/*, ~ .github/instructions/ROADMAP.md)

- 2026-01-07 / Dead code cleanup (round 2) / Removed additional clearly-unused imports/vars in Home tab components (safe, no behaviour changes). (~ src/tabs/home/ActionSection.tsx, ~ src/tabs/home/AttendanceCompact.tsx, ~ src/tabs/home/EnhancedAttendanceNew.tsx, ~ src/tabs/home/HomePanel.tsx, ~ src/tabs/home/PersonalAttendanceConfirm.tsx)

- 2026-01-07 / Home page enquiry metrics standalone route / Created `/api/home-enquiries` endpoint that returns aggregated enquiry counts (today/week/month + prev periods + matters opened) via server-side SQL instead of client-side filtering. Queries both legacy and instructions DBs, 60s Redis cache with stale fallback. Home now fetches this lightweight endpoint independently of the heavy enquiries-unified payload. Added separate `isLoadingEnquiryMetrics` prop for skeleton state. (+ server/routes/home-enquiries.js, ~ server/server.js, ~ src/tabs/home/Home.tsx, ~ src/components/modern/TimeMetricsV2.tsx)

- 2026-01-06 / ChunkLoadError auto-recovery / Added a one-time reload fallback when CRA code-split chunks fail to load (common after dev server restarts with stale chunk URLs). (~ src/index.tsx)

- 2026-01-06 / Unified matters stall diagnostics / Added server timing logs + response timeout for `/api/matters-unified` and client-side pending/timeout logging for the unified matters fetch. (~ server/routes/mattersUnified.js, ~ src/index.tsx)

- 2026-01-06 / Update Alex + Jonathan signatures / Set title to “Senior Partner” for JW + AC, and add an extra “Alex” line above “Alex Cook” in AC signature (+ v2 + txt/rtf variants)
 2026-01-06 / Rate change modal: sync open/close dates / Updated rate-change Clio→SQL sync endpoints to also persist matter Open Date + Close Date (so modal sorting/filtering isn't reliant on stale legacy SQL dates). (~ server/routes/rate-changes.js, ~ src/tabs/home/RateChangeModal.tsx)
 2026-01-06 / Matter Opening: Workbench-structure + opponent entry / Replaced the bespoke ID verification tile block in PoidSelectionStep with IdentityConfirmationCard (Workbench-style layout incl. document-provided + meta row). Also allow entering opponent/solicitor details before confirming no-conflict (Continue remains disabled until confirmed). (~ src/tabs/instructions/MatterOpening/PoidSelectionStep.tsx, ~ src/tabs/instructions/MatterOpening/OpponentDetailsStep.tsx)
 2026-01-06 / Matter Opening: Client summary clarity / Reworked client personal details banner into structured Contact/Address/Personal tiles (no more raw “dump”); updated conflict context tiles so populated Matter/Opponent/Solicitor read as active/selected rather than faded. (~ src/tabs/instructions/MatterOpening/PoidSelectionStep.tsx, ~ src/tabs/instructions/MatterOpening/ConflictConfirmationCard.tsx)
 2026-01-06 / Matter Opening: Fix POID selection regression / Restored PoidSelectionStep selection-context logic after JSX was mistakenly inserted into a useMemo, breaking compilation. Structured Contact/Address/Personal tiles now render in the banner scope (where selectedPoid exists). (~ src/tabs/instructions/MatterOpening/PoidSelectionStep.tsx)
 2026-01-06 / Matter Opening: ID & Conflict confirmation cards / Created two new InlineWorkbench-style components for Matter Opening flow: IdentityConfirmationCard (rich ID verification display with status banners, tiles for ID/PEP/Address, confirmation toggle with override modal) and ConflictConfirmationCard (conflict check display with client/matter/opponent context tiles, checklist modal for Clio search confirmation). Replaced simple ModernMultiSelect conflict picker in OpponentDetailsStep with the enhanced ConflictConfirmationCard. Added clientDisplayName useMemo to FlatMatterOpening and passed clientName + matterDescription props through. (+ src/tabs/instructions/MatterOpening/IdentityConfirmationCard.tsx, + src/tabs/instructions/MatterOpening/ConflictConfirmationCard.tsx, + src/tabs/instructions/MatterOpening/components.ts, ~ src/tabs/instructions/MatterOpening/OpponentDetailsStep.tsx, ~ src/tabs/instructions/MatterOpening/FlatMatterOpening.tsx)
 2026-01-06 / Inline workbench: Manual ID approval indicator / EID section now clearly distinguishes between automatic "Pass" and manual "Approved" status. When ID was manually approved despite underlying check issues (e.g. Address = Review), displays "ID Approved" banner with explanation, "Manually Approved" badge on EID header, and shows "Approved" in Overall tile while preserving original individual check results. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Global Toast System / Created centralised ToastProvider context with useToast hook for app-wide toast notifications. Supports success/error/warning/info/loading states with automatic dismissal, dark mode, and action buttons. Integrated into App.tsx and migrated InlineWorkbench + Instructions.tsx from local toast state to global system. (+ src/components/feedback/ToastProvider.tsx, ~ src/app/App.tsx, ~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/instructions/Instructions.tsx)
 2026-01-05 / Inline workbench / Approve and Request docs actions now open proper modals with clear prompts: Approve modal explains what confirmation means; Request docs modal shows email preview/template, explains fee earner drafts then sends, and notes that "Docs received" status is manual until systematic tracking is built. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Simplified ID layout: Individual clients show one card (details + address); Company clients show two side-by-side cards — Individual (details + address) | Company (details + registered address). Each card is self-contained. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Restructured company client ID view: added prominent "COMPANY CLIENT" banner with company name + number, header now shows individual name with "Director / Individual" label. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Removed redundant "View Details" action from the ID Verified banner now that EID details are inline/expanded by default. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Company client ID section now shows the individual/director details the EID check is run against (with a clear confirmation prompt when missing) instead of only company entity context. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Individual checked panel now wraps long values and shows postcode within the address line (no separate postcode field). (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / EID results now render as compact cards with status pills, and expanded details include a workflow state strip + recommended action guidance (restoring the best parts of the old review modal inline). (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Moved Business Details into the Company Address card so Personal sits side-by-side with Company Address+Business Details at the top. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Company Address card now shows Business Details above the address fields; Document Provided now uses a passport vs driving-licence selector button layout with the non-selected option disabled. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Added a Show raw record toggle in expanded EID details to view the stored raw verification payload inline (pretty-printed when JSON). (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Prevent delayed placeholder EID failure text like “Check failed or requires review (N/A)” from appearing after verification details load. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Fixed Company Address “No./Street” row alignment by matching grid columns to other address rows and trimming house number display. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Document Provided buttons are now taller with icons and embedded values (no extra detail panel below), and the Recommended action box has been removed (workflow chips retained). (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / EID meta rows: removed duplicate Corr reference, renamed “Tiller ID” to “Corr”, and left-aligned meta labels while keeping value column start fixed. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / Clarified workflow chips to “EID status” (Pending / Needs review / Verified) and stopped using docsRequested/docsReceived so uploaded documents don’t incorrectly drive the state yet. (~ src/tabs/instructions/InlineWorkbench.tsx)
 2026-01-05 / Inline workbench / ID verification now expands inline inside EID Results with per-check dates + fail breakdown; Request docs is internal-only (draft to fee earner), and duplicate summary lines removed. (+ src/tabs/instructions/InlineWorkbench.tsx, src/services/verificationAPI.ts)
2026-01-05 / Inline workbench / Combined ID Document + EID Results into a single full-width ID Verification box for clearer scanning. (+ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-05 / Inline workbench / EID expanded details now surface provider + reference IDs (when available), and the ID Verification header includes a status pill for clearer scanning. (+ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-05 / Inline workbench / EID details are expanded by default and checked dates are date-only (no 00:00). (+ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-05 / Inline workbench / Hide placeholder EID failure reasons (e.g. N/A) so “Fail” only appears when there’s a real issue. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-05 / Inline workbench / EID details now show provider correlation ID (Tiller ID) instead of repeating email, and Approve/Request docs require confirmation. (~ src/tabs/instructions/InlineWorkbench.tsx)
2026-01-05 / Inline workbench / EID tiles now use a simple status icon and no longer repeat per-tile checked dates (single checked date is enough). (~ src/tabs/instructions/InlineWorkbench.tsx)

- 2026-01-05 / Home demo-mode default / Demo mode no longer persists across reloads; clears stale localStorage so Home doesn't show demo data unless explicitly enabled. (~ src/app/App.tsx)

- 2026-01-05 / Instructions: ID review in tray / ID verification Review/View Details now opens the existing review UI inside the inline workbench tray (no legacy modal), preserving approve/request/draft actions. (~ src/tabs/instructions/InlineWorkbench.tsx, ~ src/components/modals/IDVerificationReviewModal.tsx)

- 2026-01-05 / InlineWorkbench identity cards: data-per-source + Teams fallback / Redesigned avatar section to show key data fields per source (SQL: name/email/phone; AC: contact ID + status; Teams: tracking/enquiry ID + status). Added ProspectId fallback for Teams link resolution so instructions linked to enquiries can resolve Teams cards even without direct tracking IDs. All three tiles now always visible with reduced opacity when not linked. (~ src/tabs/instructions/InlineWorkbench.tsx)

- 2026-01-05 / Reporting LogMonitor production fix / Fixed SSE log streaming reliability by making CORS origin checks request-aware (allow same-origin behind proxies) and flushing SSE headers/writes for /api/logs/stream. (~ server/index.js, ~ server/routes/logs-stream.js)

- 2026-01-05 / Reports visual refresh / Aligned Reporting surfaces with the newer Helix dark styling: horizontal gradients + brand borders on overview + cards, theme-aware report card text, and removed off-brand sky-blue accents in the shared glass container. (~ src/tabs/Reporting/ReportingHome.tsx, ~ src/tabs/Reporting/ReportCard.tsx, ~ src/tabs/Reporting/components/ReportingSectionCard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)

- 2026-01-05 / Instructions workbench: AC badge opens wrong contact / Centralised ActiveCampaign contact ID resolution and fixed precedence to prefer instruction-level ACID/acid over deal-level ProspectId when both exist. Added Jest coverage for the resolver. (+ src/utils/resolveActiveCampaignContactId.ts, + src/utils/__tests__/resolveActiveCampaignContactId.test.ts, ~ src/tabs/instructions/InlineWorkbench.tsx)

- 2026-01-05 / Tech tickets: problem submit 400 + ledger dark mode / Fixed Tech Problem form payload to match /api/tech-tickets/problem contract (system/summary/expectedVsActual/urgency) and corrected Tech Tickets ledger row text colour in dark mode. (~ src/CustomForms/TechProblemForm.tsx, ~ src/CustomForms/shared/TechTicketsLedger.tsx)

- 2026-01-05 / Test stability: Jest open handle / Unref'd the delayed SQL health-check startup timer so it doesn't keep Node/Jest alive after tests complete. (~ server/utils/db.js)

- 2026-01-04 / Session-start: submodule check messaging / Clarified session-start output to explicitly state submodule checks are read-only. (~ scripts/session-start.mjs)

- 2026-01-04 / Instructions tab backtrack links: AC & Teams origin / Added subtle origin indicators on the avatar (AC + T). AC deep-links to the ActiveCampaign contact; Teams resolves a deep link to the original Teams card via /api/teams-activity-tracking when an enquiryId/record id is available, with safe fallback to Teams web. Positioned as small overlay badges to cue provenance without clutter. (~ src/tabs/instructions/InlineWorkbench.tsx)

- 2026-01-04 / Instructions tab redesign: comprehensive client overview / Transformed identity tab into full "Instructions" client workspace. Added prominent header with person/company avatar, primary name/company name & number, and quick contact details (email/phone/ref). Below: key details grid (DOB, Nationality, City, Postcode), full address card with copy, then ID verification section (passport/license only, removed false "national ID"), EID results, and business details. Space now shows complete instruction/client picture—not just ID verification, but full checkpoint for all client details and verification status. (~ src/tabs/instructions/InlineWorkbench.tsx)

- 2026-01-04 / Workbench visual clarity: ID documents & payments / Enhanced ID document section to visually show which document was used (passport/license/national ID) with green highlight and indicator dot, grayed-out alternatives, and properly formatted date of birth (no timestamp). Similarly added payment method selector showing card vs bank transfer with visual status indicators. Space now speaks for itself—clearly shows situation, position, and alternatives. (~ src/tabs/instructions/InlineWorkbench.tsx)

- 2026-01-04 / Inline workbench per instruction row / Moved workbench from page-level global component to inline expansion within each instruction row. Created InlineWorkbench.tsx component with tabbed sections (ID, PAY, DOCS, RISK, MATTER). Click row to toggle workbench. Includes header with instruction ref, notes/description, and all pipeline action buttons. Removed page-level workbench visibility triggers from onRowClick. (+ src/tabs/instructions/InlineWorkbench.tsx, ~ src/tabs/instructions/InstructionTableView.tsx, ~ src/tabs/instructions/Instructions.tsx)

- 2026-01-04 / Instructions table ref selector not opening / Replaced inline absolute dropdown with Fluent UI Callout anchored to the reference chip (avoids overflow clipping) and keyed view-mode state by a stable selector key (email/ref fallback). (~ src/tabs/instructions/InstructionTableView.tsx)

- 2026-01-04 / Instructions table ref cue + linking / Added an explicit multi-ref count badge and a stacked secondary ref line to visually link matter + instruction in the same chip area (and removed debug console spam). (~ src/tabs/instructions/InstructionTableView.tsx)

- 2026-01-04 / Instructions table chip compactness / Reverted ref chip to single-line height; replaced badge with subtle dot cue; show matter↔instruction linkage only inside the open selector. (~ src/tabs/instructions/InstructionTableView.tsx)

- 2026-01-04 / Instructions table chip overlap / Constrained ref chip to its fixed-width cell (clip overflow) so it doesn't overlap the pipeline connector line. (~ src/tabs/instructions/InstructionTableView.tsx)

- 2026-01-02 / Workbench UI consistency redesign / Redesigned Matter Opening Workbench (ID/PAY/DOCS/RISK/MATTER tabs) for better consistency with app design patterns. Simplified header styling, removed complex gradients/shadows, aligned tab design with app conventions, improved color consistency using established theme system. Cleaner visual hierarchy, consistent spacing, and reduced visual noise while maintaining full functionality. (~ src/tabs/instructions/Instructions.tsx)

- 2026-01-02 / Enquiries ID column shows instruction reference / Added instruction reference display beneath enquiry ID when a pitch/deal exists with an InstructionRef. Matches Instructions table pattern (ID + Reference stacked). Updated backend SQL to include InstructionRef, added field to pitchEntry object and TypeScript interface. (~ server/routes/enquiryEnrichment.js, src/app/functionality/enquiryEnrichment.ts, src/tabs/enquiries/Enquiries.tsx)

- 2026-01-02 / Pitch builder caret jumps to start while typing / Fixed body sync effect to treat focus within editor children (e.g. placeholder spans) as focused, preventing innerHTML rewrites during typing. (~ src/tabs/enquiries/PitchBuilder.tsx)
- 2026-01-06 / Financial forms failing with attachments / Increased Express JSON body limit (base64 uploads) and fixed Payment Requests >£50k field key mismatch. (~ server/index.js, server/routes/financialTask.js)
- 2026-01-06 / Financial forms traceability / Added structured trace logs for /api/financial-task and a JSON error middleware (incl. payload-too-large) for clearer Azure Log Stream debugging. (~ server/index.js, server/routes/financialTask.js)
- 2026-01-06 / Edge Tools hygiene: signatures + nested interactive + CSS prefixes / Added rel="noopener noreferrer" to signature links (bulk script + sendEmail safety-net), removed button-like role/tabIndex from InstructionCard wrapper to avoid nested interactive controls, and reordered -webkit CSS properties before unprefixed equivalents. (+ scripts/fix-signature-noopener.mjs, ~ src/assets/signatures/**, ~ server/routes/sendEmail.js, ~ src/tabs/instructions/InstructionCard.tsx, ~ src/tabs/Reporting/ManagementDashboard.css)

- 2026-01-01 / Annual leave UX polish & space booking system / Enhanced annual leave delete modal contrast for dark mode (pure white text). Fully tested half-day leave functionality via terminal with database schema updates (half_day_start/half_day_end columns). **Major**: Space booking system fully operational - fixed bookSpace.js imports, added attendanceQuery pattern, tested Boardroom/Soundproof Pod bookings with Clio integration. Added DELETE endpoint + UI delete functionality with confirmation dialogs. Cleaned availability UI to only show dates with bookings. Added booking refresh after creation. (~ src/CustomForms/AnnualLeaveForm.tsx, BookSpaceForm.tsx, server/routes/bookSpace.js, server/server.js, src/tabs/home/Home.tsx, + scripts/createBookingTables.mjs, deleteTestBookings.mjs)

- 2026-01-01 / Instructions day folding not applying / Fixed local/static server to prefer serving latest CRA output from build/ so UI code changes (e.g., day folding/hover) show up after rebuild. (~ server/index.js, server/server.js)

- 2025-12-31 / Pitch builder production refinements / Cleaned up pitch builder for production: standardized terminology (Scope of Work, Quote Amount), simplified labels (removed colons, reduced verbosity), cleaner VAT toggle ("No VAT (international)"), improved error display, consolidated confirmation messages. Enhanced UI with refined borders (8px radius), softer shadows, smoother transitions (cubic-bezier), subtle focus glows, better card hover states. Professional polish throughout. (~ src/tabs/enquiries/pitch-builder/DealCapture.tsx, PaymentPreview.tsx, EditorAndTemplateBlocks.tsx)

- 2025-12-30 / Migrate decoupled-functions to Express / Ported 5 functions to direct SQL in Express routes (matterRequests, opponents, ccl, pitches). Deleted ALL remaining decoupled function folders (15 total). decoupled-functions/ now empty except scaffolding. No more dependency on instructions-vnet-functions Azure Function App. (~ server/routes/matterRequests.js, server/routes/opponents.js, server/routes/ccl.js, server/routes/pitches.js, - decoupled-functions/*/)

- 2025-12-30 / Dead code removal: decoupled-functions / Deleted 8 unused Azure Functions: fetchEnquiryEmails, fetchEnquiriesData, recordRiskAssessment, dealCapture, importInstructionData, deleteTestMatters, insertEnquiry, sendEmail. Also removed dead routes: enquiries.js, enquiryEmails.js, EnquiryEmails.tsx. (- decoupled-functions/*, server/routes/enquiries.js, server/routes/enquiryEmails.js, src/tabs/enquiries/EnquiryEmails.tsx)

- 2025-12-30 / Foundation cleanup / Archived one-off scripts, fixed stale file references in instruction docs, added doc maintenance rule to copilot-instructions. (+ scripts/archive/, .github/copilot-instructions.md, .github/instructions/*.md)

- 2025-12-30 / Agent infrastructure / Built context sync system for autonomous agents. Scripts auto-generate REALTIME_CONTEXT.md with branch state, submodule status, server ports. Session start protocol established. (+ scripts/sync-context.mjs, scripts/update-submodules.mjs, scripts/validate-instructions.mjs, scripts/session-start.mjs, .github/instructions/REALTIME_CONTEXT.md, .github/copilot-instructions.md)

- 2025-12-30 / 2025 Rate Update / Updated all fee earner rates in both databases (helix-core-data, instructions). Alex Cook + Jonathan Waters → Senior Partner £475. All roles updated to new structure. (+ scripts/updateRates2025.mjs, scripts/updateRatesInstructions.mjs, database/migrations/010_2025_rate_update.md, .github/instructions/TEAM_DATA_REFERENCE.md)

- 2025-12-30 / Instruction files foundation / Added TEAM_DATA_REFERENCE.md, WORKSPACE_OPTIMIZATION.md. Updated copilot-instructions.md to match typefxce foundation pattern. (+ .github/instructions/*, .github/copilot-instructions.md)

- 2026-01-08 / Conversion metrics reloading / Stabilised conversion metric cards by removing refresh-based remounting and using a short refresh pulse animation (src/components/modern/EnquiryMetricsV2.tsx)

- 2026-01-08 / Conversion metrics breakdown inspect / Home now stores `/api/home-enquiries` `breakdown` payload and passes it into Conversion Metrics; enquiry cards show a subtle inspect cue and open a BespokePanel modal with top AOW segments (today/week/month). (~ server/routes/home-enquiries.js, ~ src/tabs/home/Home.tsx, ~ src/components/modern/TimeMetricsV2.tsx, ~ src/components/modern/EnquiryMetricsV2.tsx)
